<div id="customToast" class="custom-toast">
  <div class="toast-content">
    <p id="toastMessage"></p>
  </div>
</div>
<nav
  class="navbar navbar-expand-lg d-flex align-items-center w-100"
  *ngIf="displayHeader"
>
  <div class="container-fluid">
    <div class="d-flex align-items-center">
      <!-- Logo Section -->
      <div
        class="sidebar-logo d-flex justify-content-start align-items-center me-4"
      >
        <img
          class="cherry-logo"
          src="../../../assets/Images/Emily Logo-1.png"
          [routerLink]="
            currentRoute.includes('landlord') ? ['/landlord'] : ['/campaigns']
          "
        />
      </div>
    </div>

    <!-- Navigation Items -->
    <div
      class="collapse navbar-collapse"
      [ngClass]="{ show: isNavbarOpen }"
      id="navbarNav"
    >
      <ul class="navbar-nav mb-2 mb-lg-0">
        <!-- <li class="nav-item" *ngIf="!currentRoute.includes('landlord')">
          <a
            [routerLink]="['/summary']"
            routerLinkActive="active-route"
            class="nav-link"
            title="Tenants"
          >
            <img
              class="img-icn"
              src="../../../assets/Images/Icons/Tenant.svg"
            />
            <span>Tenants</span>
          </a>
        </li>
        <li class="nav-item" *ngIf="!currentRoute.includes('landlord')">
          <a
            [routerLink]="['/campaigns']"
            routerLinkActive="active-route"
            class="nav-link"
            title="Campaigns"
          >
            <img
              class="img-icn"
              src="../../../assets/Images/Icons/Campains.svg"
            />
            <span>Campaigns</span>
          </a>
        </li> -->

        <!-- <li class="nav-item" *ngIf="!currentRoute.includes('landlord')">
          <a
            class="nav-link"
            [routerLink]="['/Kanban']"
            routerLinkActive="active-route"
            title="Cadence"
          >
            <img
              class="img-icn"
              src="../../../assets/Images/Icons/Cadence.svg"
            />
            <span>Cadence</span>
          </a>
        </li> -->
        <!-- <li class="nav-item">
          <a
            class="nav-link"
            [routerLink]="['/overview']"
            routerLinkActive="active-route"
            title="Overview"
          >
            <img
              src="../../../../assets/icons/svgs/settings.svg"
              alt="Overview"
              class="img-icn"
            />
            <span class="nav-text">Configurations</span>
          </a>
        </li> -->
        <li class="nav-item" *ngIf="!currentRoute.includes('landlord')">
          <a
            [routerLink]="['/campaigns']"
            routerLinkActive="active-route"
            class="nav-link"
            title="Campaigns"
          >
            <img
              class="img-icn"
              src="../../../assets/Images/Icons/task-square.svg"
            />
            <span class="nav-text">Campaigns</span>
          </a>
        </li>
        <li class="nav-item">
          <a
            class="nav-link"
            [routerLink]="['/summary']"
            routerLinkActive="active-route"
            title="Tenants"
          >
            <img
              src="assets/Images/SVG/tenants.svg"
              alt="Tenants"
              class="img-icn"
            />
            <span class="nav-text">Tenants</span>
          </a>
        </li>

        <!-- <li class="nav-item">
          <a
            class="nav-link"
            [routerLink]="['/organizations']"
            routerLinkActive="active-route"
            title="Contacts"
          >
            <img
              src="assets/Images/SVG/contacts.svg"
              alt="Contacts"
              class="img-icn"
            />
            <span class="nav-text">Organizations</span>
          </a>
        </li> -->

        <li class="nav-item">
          <a
            class="nav-link"
            [routerLink]="['/shoppingcenters']"
            routerLinkActive="active-route"
            title="shoppingCenters"
          >
            <img
              src="assets/Images/SVG/properties.svg"
              alt="Properties"
              class="img-icn"
            />

            <span class="nav-text">Sites</span>
          </a>
        </li>

        <li class="nav-item" *ngIf="currentRoute.includes('landlord')">
          <a
            class="nav-link"
            [routerLink]="['/landlord']"
            routerLinkActive="active-route"
            title="Cadence"
          >
            <img
              class="img-icn"
              src="../../../assets/Images/Icons/Cadence.svg"
            />
            <span>Contacts</span>
          </a>
        </li>
      </ul>
    </div>

    <!-- Right Section (Notifications and User Profile) -->
    <div
      class="d-flex align-items-center justify-content-end avatar-notifcations ms-auto"
    >
      <a href="" class="messages-icon">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="25"
          viewBox="0 0 24 25"
          fill="none"
        >
          <path
            d="M9.98999 23.28C9.38999 23.28 8.81999 22.98 8.42999 22.45L7.23001 20.85C7.23001 20.86 7.18 20.83 7.16 20.83H6.79001C3.37001 20.83 1.25 19.9 1.25 15.29V11.29C1.25 7.08001 3.82001 5.98001 5.98001 5.79001C6.22001 5.76001 6.50001 5.75 6.79001 5.75H13.19C16.81 5.75 18.73 7.67001 18.73 11.29V15.29C18.73 15.58 18.72 15.86 18.68 16.13C18.5 18.26 17.4 20.83 13.19 20.83H12.79L11.55 22.45C11.16 22.98 10.59 23.28 9.98999 23.28ZM6.79001 7.25C6.56001 7.25 6.34 7.26 6.13 7.28C3.81 7.48 2.75 8.75001 2.75 11.29V15.29C2.75 18.72 3.81001 19.33 6.79001 19.33H7.19C7.64 19.33 8.14999 19.58 8.42999 19.94L9.63 21.55C9.85001 21.85 10.13 21.85 10.35 21.55L11.55 19.95C11.84 19.56 12.3 19.33 12.79 19.33H13.19C15.73 19.33 17 18.26 17.19 15.98C17.22 15.74 17.23 15.52 17.23 15.29V11.29C17.23 8.50001 15.98 7.25 13.19 7.25H6.79001Z"
            fill="#777199"
          />
          <path
            d="M9.99023 14.6904C9.43023 14.6904 8.99023 14.2404 8.99023 13.6904C8.99023 13.1404 9.44023 12.6904 9.99023 12.6904C10.5402 12.6904 10.9902 13.1404 10.9902 13.6904C10.9902 14.2404 10.5502 14.6904 9.99023 14.6904Z"
            fill="#777199"
          />
          <path
            d="M13.1899 14.6904C12.6299 14.6904 12.1899 14.2404 12.1899 13.6904C12.1899 13.1404 12.6399 12.6904 13.1899 12.6904C13.7399 12.6904 14.1899 13.1404 14.1899 13.6904C14.1899 14.2404 13.7399 14.6904 13.1899 14.6904Z"
            fill="#777199"
          />
          <path
            d="M6.7998 14.6904C6.2398 14.6904 5.7998 14.2404 5.7998 13.6904C5.7998 13.1404 6.2498 12.6904 6.7998 12.6904C7.3498 12.6904 7.7998 13.1404 7.7998 13.6904C7.7998 14.2404 7.3498 14.6904 6.7998 14.6904Z"
            fill="#777199"
          />
          <path
            d="M17.9401 16.79C17.7401 16.79 17.5401 16.71 17.4001 16.56C17.2401 16.4 17.1701 16.17 17.2001 15.95C17.2301 15.74 17.2401 15.52 17.2401 15.29V11.29C17.2401 8.50001 15.9901 7.25 13.2001 7.25H6.80012C6.57012 7.25 6.35015 7.26 6.14015 7.28C5.92015 7.31 5.69013 7.22999 5.53013 7.07999C5.37013 6.91999 5.28012 6.70001 5.30012 6.48001C5.48012 4.32001 6.59012 1.75 10.8001 1.75H17.2001C20.8201 1.75 22.7401 3.67001 22.7401 7.29001V11.29C22.7401 15.5 20.1701 16.6 18.0101 16.79C17.9801 16.79 17.9601 16.79 17.9401 16.79ZM6.92015 5.75H13.1901C16.8101 5.75 18.7301 7.67001 18.7301 11.29V15.16C20.4301 14.74 21.2301 13.49 21.2301 11.29V7.29001C21.2301 4.50001 19.9801 3.25 17.1901 3.25H10.7901C8.59014 3.25 7.35015 4.05 6.92015 5.75Z"
            fill="#777199"
          />
        </svg>
      </a>
      <a
        *ngIf="showlink"
        href="https://share.zight.com/re/01962ee5-bbf3-7088-8aa5-30e50bc772f9"
        target="_blank"
      >
        <i class="fa-solid fa-record-vinyl" style="font-size: 25px"></i>
      </a>

      <div
        class="d-none d-lg-block"
        *ngIf="!isSmallScreen && !currentRoute.includes('landlord')"
      >
        <app-notifications></app-notifications>
      </div>

      <div class="dropdown">
        <div
          class="avatar-container"
          role="button"
          id="userDropdown"
          data-bs-toggle="dropdown"
          aria-expanded="false"
        >
          <img
            *ngIf="userAvatar"
            [src]="userAvatar"
            alt="User Avatar"
            class="rounded-circle avatar-img"
          />
          <div
            *ngIf="!userAvatar"
            class="avatar-placeholder rounded-circle d-flex align-items-center justify-content-center"
          >
            <i class="fa-solid fa-user"></i>
          </div>
        </div>
        <ul
          class="dropdown-menu dropdown-menu-end"
          aria-labelledby="userDropdown"
        >
          <li>
            <a
              class="dropdown-item"
              href="#"
              (click)="switchView(); $event.preventDefault()"
            >
              Switch to
              {{ currentRoute.includes("landlord") ? "campaigns" : "Landlord" }}
            </a>
          </li>
          <li>
            <a class="dropdown-item" [routerLink]="['/NewPassword']">
              Change Password
            </a>
          </li>

          <li>
            <a class="dropdown-item" [routerLink]="['/settings']"> Settings </a>
          </li>
          <li>
            <a class="dropdown-item" (click)="openAddAIKey()"> Add AI Key </a>
          </li>

          <li><hr class="dropdown-divider" /></li>
          <li>
            <a
              class="dropdown-item d-flex justify-content-between"
              href="#"
              (click)="logout(); $event.preventDefault()"
            >
              Logout
              <i
                class="fa-solid fa-arrow-right-from-bracket action-icon position-relative mx-2"
              ></i>
            </a>
          </li>
        </ul>
      </div>
      <!-- Toggle button for mobile -->
      <!-- <button
        class="navbar-toggler d-lg-none"
        type="button" 
        (click)="toggleNavbar($event)"
      >
        <i
          class="fa-solid"
          [ngClass]="isNavbarOpen ? 'fa-times' : 'fa-bars'"
        ></i>
      </button> -->
    </div>
  </div>
</nav>

<ng-template #addAIKeyTypes let-modal>
  <div class="fancy-modal-header">
    <h5 class="fancy-title">Add AI Key</h5>
    <button type="button" class="btn-close fancy-close" (click)="modal.dismiss()"></button>
  </div>
  <div class="fancy-modal-body">
    <form>
      <div class="mb-4">
        <label for="aiKey" class="form-label text-muted small mb-2">AI Key</label>
        <input type="text" 
               class="form-control fancy-input" 
               id="aiKey" 
               name="aiKey" 
               placeholder="Enter your AI Key" 
               [(ngModel)]="AIKey" />
      </div>
    </form>
  </div>
  <div class="fancy-modal-footer">
    <button type="button" 
            class="fancy-btn secondary-btn" 
            (click)="modal.dismiss()">
      Close
    </button>
    <button type="button" 
            class="fancy-btn primary-btn" 
            (click)="SetGPTAPIKey()">
      <span class="btn-spinner" *ngIf="isSaving"></span>
      Save changes
    </button>
  </div>
</ng-template>