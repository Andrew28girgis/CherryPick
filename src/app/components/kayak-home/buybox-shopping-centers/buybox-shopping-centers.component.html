<p-toast />
<div class="container-fluid">
  <div class="row mb-3 container_border">
    <div class="col-6 col-md-4 pt-2">
      <div class="checkbox-section-select pb-2">
        <label for="stateFilter" class="pb-2">Filter by State</label>
        <select class="form-select form-select-lg" aria-label="Large select example" id="stateFilter"
          [(ngModel)]="selectedState" (change)="onStateChange($event)">
          <option value="" selected>All States</option>
          <option *ngFor="let state of StateCodes" [value]="state">
            {{ state }}
          </option>
        </select>
      </div>
    </div>
    <div class="col-6 col-md-4 pt-2">
      <div class="checkbox-section-select pb-2">
        <label for="cityFilter" class="pb-2">Filter by City</label>
        <select class="form-select form-select-lg" aria-label="Large select example" id="cityFilter"
          [(ngModel)]="selectedCity" (change)="onCityChange()" [disabled]="!filteredCities.length">
          <option value="">All Cities</option>
          <option *ngFor="let city of filteredCities" [value]="city">
            {{ city }}
          </option>
        </select>
      </div>
    </div>
    <div class="col-6 col-md-4 pt-2 d-flex justify-content-end align-items-center">
      <button class="Bind__button" (click)="triggerBindAction()">Manage</button>
    </div>
  </div>

  <!-- Table Section -->
  <div class="pt-2" *ngIf="filteredBuyBoxPlacesAndShoppingCenter && filteredBuyBoxPlacesAndShoppingCenter.length">
    <table class="w-100">
      <thead>
        <tr>
          <th class="width-th-thead" style="width: 20%;">Center Name</th>
          <th class="width-th-thead" style="width: 50%;">Center Address</th>
          <th class="width-th-thead" style="width: 20%;">Available Units</th>
          <th class="width-th-thead" style="width: 10%;text-align: center">Action</th>
        </tr>
      </thead>
      <tbody>
        <ng-container *ngFor="let item of filteredBuyBoxPlacesAndShoppingCenter">
          <tr>
            <td class="width-th-tbody" style="width: 25%;">{{ item.CenterName }}</td>
            <td class="width-th-tbody" style="width: 45%;" (click)="openMapViewPlace(MapViewPlace, item)">
              {{ item.CenterAddress }}, {{ item.CenterCity }},
              {{ item.CenterState }}
            </td>
            <td class="width-th-tbody" style="width: 20%;cursor: pointer;" data-bs-toggle="modal"
              [attr.data-bs-target]="'#staticBackdrop'+item.id" (click)="toggleShortcuts(item.id , 'close')">
              {{ item.MarketSurveyShoppingCenters[0].Place.length }}</td>
            <td class="width-th-tbody " style="width: 10%;text-align: center;position: relative;">
              <button class="ellipsis_icon" (click)="toggleShortcuts(item.id)">
                <i class="fa-solid fa-ellipsis"></i>
              </button>
              <!-- <button class="ellipsis_icontrash"
                (click)="openDeleteShoppingCenterModal(deleteShoppingCenterModal,item.id)">
                <i class="fa-regular fa-trash-can"></i>
              </button> -->
              <div class="shortcuts_icon" *ngIf="selectedId === item.id">
                <ul>
                  <li data-bs-toggle="modal" [attr.data-bs-target]="'#staticBackdrop'+item.id"
                    (click)="toggleShortcuts(item.id , 'close')">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path
                        d="M6.70001 18.75H4.15002C2.31002 18.75 1.25 17.69 1.25 15.85V4.15002C1.25 2.31002 2.31002 1.25 4.15002 1.25H8.45001C10.29 1.25 11.35 2.31002 11.35 4.15002V6C11.35 6.41 11.01 6.75 10.6 6.75C10.19 6.75 9.84998 6.41 9.84998 6V4.15002C9.84998 3.13002 9.47001 2.75 8.45001 2.75H4.15002C3.13002 2.75 2.75 3.13002 2.75 4.15002V15.85C2.75 16.87 3.13002 17.25 4.15002 17.25H6.70001C7.11001 17.25 7.45001 17.59 7.45001 18C7.45001 18.41 7.11001 18.75 6.70001 18.75Z"
                        fill="#707791" />
                      <path
                        d="M14.9602 22.75H9.12018C7.11018 22.75 5.9502 21.59 5.9502 19.58V8.41998C5.9502 6.40998 7.11018 5.25 9.12018 5.25H14.9602C16.9702 5.25 18.1202 6.40998 18.1202 8.41998V19.58C18.1202 21.59 16.9702 22.75 14.9602 22.75ZM9.12018 6.75C7.92018 6.75 7.4502 7.21998 7.4502 8.41998V19.58C7.4502 20.78 7.92018 21.25 9.12018 21.25H14.9602C16.1502 21.25 16.6202 20.78 16.6202 19.58V8.41998C16.6202 7.21998 16.1502 6.75 14.9602 6.75H9.12018Z"
                        fill="#707791" />
                      <path
                        d="M19.8503 18.75H17.3704C16.9604 18.75 16.6204 18.41 16.6204 18C16.6204 17.59 16.9604 17.25 17.3704 17.25H19.8503C20.8703 17.25 21.2504 16.87 21.2504 15.85V4.15002C21.2504 3.13002 20.8703 2.75 19.8503 2.75H15.5504C14.5304 2.75 14.1504 3.13002 14.1504 4.15002V6C14.1504 6.41 13.8104 6.75 13.4004 6.75C12.9904 6.75 12.6504 6.41 12.6504 6V4.15002C12.6504 2.31002 13.7104 1.25 15.5504 1.25H19.8503C21.6903 1.25 22.7504 2.31002 22.7504 4.15002V15.85C22.7504 17.69 21.6903 18.75 19.8503 18.75Z"
                        fill="#707791" />
                      <path
                        d="M14 11.75H10C9.59 11.75 9.25 11.41 9.25 11C9.25 10.59 9.59 10.25 10 10.25H14C14.41 10.25 14.75 10.59 14.75 11C14.75 11.41 14.41 11.75 14 11.75Z"
                        fill="#707791" />
                      <path
                        d="M14 14.75H10C9.59 14.75 9.25 14.41 9.25 14C9.25 13.59 9.59 13.25 10 13.25H14C14.41 13.25 14.75 13.59 14.75 14C14.75 14.41 14.41 14.75 14 14.75Z"
                        fill="#707791" />
                      <path
                        d="M12 22.75C11.59 22.75 11.25 22.41 11.25 22V19C11.25 18.59 11.59 18.25 12 18.25C12.41 18.25 12.75 18.59 12.75 19V22C12.75 22.41 12.41 22.75 12 22.75Z"
                        fill="#707791" />
                    </svg>
                    View Places
                  </li>
                  <li>
                    <a class="target" *ngIf="item.DocsLink" href="{{ item.DocsLink }}" target="_blank">
                      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <g id="vuesax/outline/document">
                          <g id="document">
                            <path id="Vector"
                              d="M15 22.75H9C3.57 22.75 1.25 20.43 1.25 15V9C1.25 3.57 3.57 1.25 9 1.25H14C14.41 1.25 14.75 1.59 14.75 2C14.75 2.41 14.41 2.75 14 2.75H9C4.39 2.75 2.75 4.39 2.75 9V15C2.75 19.61 4.39 21.25 9 21.25H15C19.61 21.25 21.25 19.61 21.25 15V10C21.25 9.59 21.59 9.25 22 9.25C22.41 9.25 22.75 9.59 22.75 10V15C22.75 20.43 20.43 22.75 15 22.75Z"
                              fill="#707791" />
                            <path id="Vector_2"
                              d="M22 10.75H18C14.58 10.75 13.25 9.41999 13.25 5.99999V1.99999C13.25 1.69999 13.43 1.41999 13.71 1.30999C13.99 1.18999 14.31 1.25999 14.53 1.46999L22.53 9.46999C22.74 9.67999 22.81 10.01 22.69 10.29C22.57 10.57 22.3 10.75 22 10.75ZM14.75 3.80999V5.99999C14.75 8.57999 15.42 9.24999 18 9.24999H20.19L14.75 3.80999Z"
                              fill="#707791" />
                          </g>
                        </g>
                      </svg>
                      View PDF
                    </a>
                  </li>
                  <li>
                    <a class="target" *ngIf="item.MainImage" href="{{ item.MainImage }}" target="_blank">
                      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <g id="vuesax/outline/image">
                          <g id="image">
                            <path id="Vector"
                              d="M18.3599 22.75H5.58987C4.06987 22.75 2.67987 21.98 1.87987 20.68C1.07987 19.38 1.00987 17.8 1.68987 16.43L3.40987 12.98C3.96987 11.86 4.86987 11.16 5.87987 11.05C6.88987 10.94 7.91987 11.44 8.69987 12.41L8.91987 12.69C9.35987 13.23 9.86987 13.52 10.3699 13.47C10.8699 13.43 11.3299 13.07 11.6699 12.46L13.5599 9.04999C14.3399 7.63999 15.3799 6.90999 16.5099 6.95999C17.6299 7.01999 18.5899 7.85999 19.2299 9.33999L22.3599 16.65C22.9399 18 22.7999 19.54 21.9899 20.77C21.1899 22.02 19.8299 22.75 18.3599 22.75ZM6.15987 12.55C6.11987 12.55 6.07987 12.55 6.03987 12.56C5.53987 12.61 5.07987 13.01 4.74987 13.66L3.02987 17.11C2.57987 18 2.62987 19.05 3.14987 19.9C3.66987 20.75 4.58987 21.26 5.58987 21.26H18.3499C19.3299 21.26 20.1999 20.79 20.7399 19.97C21.2799 19.15 21.3699 18.17 20.9799 17.27L17.8499 9.95999C17.4699 9.05999 16.9399 8.50999 16.4299 8.48999C15.9599 8.45999 15.3499 8.95999 14.8699 9.80999L12.9799 13.22C12.3999 14.26 11.4899 14.91 10.4999 15C9.50987 15.08 8.49987 14.6 7.74987 13.66L7.52987 13.38C7.10987 12.83 6.62987 12.55 6.15987 12.55Z"
                              fill="#707791" />
                            <path id="Vector_2"
                              d="M6.96973 8.75C4.90973 8.75 3.21973 7.07 3.21973 5C3.21973 2.93 4.89973 1.25 6.96973 1.25C9.03973 1.25 10.7197 2.93 10.7197 5C10.7197 7.07 9.03973 8.75 6.96973 8.75ZM6.96973 2.75C5.72973 2.75 4.71973 3.76 4.71973 5C4.71973 6.24 5.72973 7.25 6.96973 7.25C8.20973 7.25 9.21973 6.24 9.21973 5C9.21973 3.76 8.20973 2.75 6.96973 2.75Z"
                              fill="#707791" />
                          </g>
                        </g>
                      </svg>
                      View Image

                    </a>
                  </li>
                  <li>
                    <a class="target" href="javascript:void(0)" *ngIf="item.StreetViewURL"
                      (click)="openShoppingCenterStreetViewModal(shoppingCenterStreetViewModal,item.StreetViewURL)">
                      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <g id="Street View">
                          <path id="Vector"
                            d="M12 3C10.3506 3 9 4.35059 9 6C9 6.83496 9.35742 7.58789 9.91406 8.13281C8.91504 8.80957 8.25 9.96094 8.25 11.25V14.7188L9.75 15.4688V18.75H14.25V15.4688L15.75 14.7188V11.25C15.75 9.96094 15.085 8.80957 14.0859 8.13281C14.6426 7.58789 15 6.83496 15 6C15 4.35059 13.6494 3 12 3ZM12 4.5C12.8379 4.5 13.5 5.16211 13.5 6C13.5 6.83789 12.8379 7.5 12 7.5C11.1621 7.5 10.5 6.83789 10.5 6C10.5 5.16211 11.1621 4.5 12 4.5ZM12 9C13.251 9 14.25 9.99902 14.25 11.25V13.7812L12.75 14.5312V17.25H11.25V14.5312L9.75 13.7812V11.25C9.75 9.99902 10.749 9 12 9ZM6.75 14.1562C4.56152 14.7686 3 15.8057 3 17.25C3 19.7109 7.52637 21 12 21C16.4736 21 21 19.7109 21 17.25C21 15.8057 19.4385 14.7686 17.25 14.1562V15.7266C18.6768 16.1865 19.5 16.7812 19.5 17.25C19.5 18.1465 16.5088 19.5 12 19.5C7.49121 19.5 4.5 18.1465 4.5 17.25C4.5 16.7812 5.32324 16.1865 6.75 15.7266V14.1562Z"
                            fill="#707791" />
                        </g>
                      </svg>
                      Street View
                    </a>
                  </li>
                  <li>
                    <a class="target" href="javascript:void(0)" (click)="openUpdateReasonModal(updateReasonModal, item)"
                      [ngClass]="{'text-blue': item.hasSiteSelectionReason,'text-red': !item.hasSiteSelectionReason}">
                      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <g id="vuesax/outline/edit-2">
                          <g id="edit-2">
                            <path id="Vector"
                              d="M5.53999 19.52C4.92999 19.52 4.35999 19.31 3.94999 18.92C3.42999 18.43 3.17999 17.69 3.26999 16.89L3.63999 13.65C3.70999 13.04 4.07999 12.23 4.50999 11.79L12.72 3.09999C14.77 0.929988 16.91 0.869988 19.08 2.91999C21.25 4.96999 21.31 7.10999 19.26 9.27999L11.05 17.97C10.63 18.42 9.84999 18.84 9.23999 18.94L6.01999 19.49C5.84999 19.5 5.69999 19.52 5.53999 19.52ZM15.93 2.90999C15.16 2.90999 14.49 3.38999 13.81 4.10999L5.59999 12.81C5.39999 13.02 5.16999 13.52 5.12999 13.81L4.75999 17.05C4.71999 17.38 4.79999 17.65 4.97999 17.82C5.15999 17.99 5.42999 18.05 5.75999 18L8.97999 17.45C9.26999 17.4 9.74999 17.14 9.94999 16.93L18.16 8.23999C19.4 6.91999 19.85 5.69999 18.04 3.99999C17.24 3.22999 16.55 2.90999 15.93 2.90999Z"
                              fill="#707791" />
                            <path id="Vector_2"
                              d="M17.3404 10.95C17.3204 10.95 17.2904 10.95 17.2704 10.95C14.1504 10.64 11.6404 8.26997 11.1604 5.16997C11.1004 4.75997 11.3804 4.37997 11.7904 4.30997C12.2004 4.24997 12.5804 4.52997 12.6504 4.93997C13.0304 7.35997 14.9904 9.21997 17.4304 9.45997C17.8404 9.49997 18.1404 9.86997 18.1004 10.28C18.0504 10.66 17.7204 10.95 17.3404 10.95Z"
                              fill="#707791" />
                            <path id="Vector_3"
                              d="M21 22.75H3C2.59 22.75 2.25 22.41 2.25 22C2.25 21.59 2.59 21.25 3 21.25H21C21.41 21.25 21.75 21.59 21.75 22C21.75 22.41 21.41 22.75 21 22.75Z"
                              fill="#707791" />
                          </g>
                        </g>
                      </svg>
                      Update Selection
                    </a>
                  </li>
                  <li style="cursor: pointer;">
                    <a class="target" (click)="openDeleteShoppingCenterModal(deleteShoppingCenterModal,item.id)">
                      <i class="fa-regular fa-trash-can" style="font-size: 18px;margin-top: 3px;width: 24px;"></i>
                      Delete Shopping
                    </a>
                  </li>
                </ul>
                <i class="fa-solid fa-caret-right"></i>
              </div>
              <div class="modal fade" [id]="'staticBackdrop'+item.id" data-bs-backdrop="static" data-bs-keyboard="false"
                tabindex="-1" [attr.aria-labelledby]="'staticBackdropLabel'+item.id" aria-hidden="true">
                <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable position-relative">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h1 class="modal-title fs-5" [id]="'staticBackdropLabel'+item.id">{{ item.CenterName }}</h1>
                      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                      <div class="table-responsive">
                        <table class="table table-sm">
                          <thead>
                            <tr>
                              <th>Building Size SF</th>
                              <th>Secondary Type</th>
                              <th>Action</th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr *ngFor="let place of item.MarketSurveyShoppingCenters[0].Place">
                              <td>{{ place.BuildingSizeSf }}</td>
                              <td>{{ place.SecondaryType }}</td>
                              <td class="d-flex gap-2 position-fixed backgroundT">
                                <button class="ellipsis_iconT" href="javascript:void(0)"
                                  (click)="place.StreetViewURL ? openPlaceStreetViewModal(placeStreetViewModal, place.StreetViewURL) : showAlert('Street View is not available for this location.')">
                                  <i class="fas fa-street-view"></i>
                                </button>
                                <button class="ellipsis_icontrash"
                                  (click)="openDeletePlaceModal(deletePlaceModal, place.Id)">
                                  <i class="fa-regular fa-trash-can"></i>
                                </button>
                                <!-- <div class="shortcuts_iconT" *ngIf="selectedIdT === place.Id">
                                  <ul>
                                    <li data-bs-toggle="modal"
                                      (click)="toggleT(place.Id , 'closed')">
                                      <svg width="24" height="24" viewBox="0 0 24 24" fill="none"
                                        xmlns="http://www.w3.org/2000/svg">
                                        <path
                                          d="M6.70001 18.75H4.15002C2.31002 18.75 1.25 17.69 1.25 15.85V4.15002C1.25 2.31002 2.31002 1.25 4.15002 1.25H8.45001C10.29 1.25 11.35 2.31002 11.35 4.15002V6C11.35 6.41 11.01 6.75 10.6 6.75C10.19 6.75 9.84998 6.41 9.84998 6V4.15002C9.84998 3.13002 9.47001 2.75 8.45001 2.75H4.15002C3.13002 2.75 2.75 3.13002 2.75 4.15002V15.85C2.75 16.87 3.13002 17.25 4.15002 17.25H6.70001C7.11001 17.25 7.45001 17.59 7.45001 18C7.45001 18.41 7.11001 18.75 6.70001 18.75Z"
                                          fill="#707791" />
                                        <path
                                          d="M14.9602 22.75H9.12018C7.11018 22.75 5.9502 21.59 5.9502 19.58V8.41998C5.9502 6.40998 7.11018 5.25 9.12018 5.25H14.9602C16.9702 5.25 18.1202 6.40998 18.1202 8.41998V19.58C18.1202 21.59 16.9702 22.75 14.9602 22.75ZM9.12018 6.75C7.92018 6.75 7.4502 7.21998 7.4502 8.41998V19.58C7.4502 20.78 7.92018 21.25 9.12018 21.25H14.9602C16.1502 21.25 16.6202 20.78 16.6202 19.58V8.41998C16.6202 7.21998 16.1502 6.75 14.9602 6.75H9.12018Z"
                                          fill="#707791" />
                                        <path
                                          d="M19.8503 18.75H17.3704C16.9604 18.75 16.6204 18.41 16.6204 18C16.6204 17.59 16.9604 17.25 17.3704 17.25H19.8503C20.8703 17.25 21.2504 16.87 21.2504 15.85V4.15002C21.2504 3.13002 20.8703 2.75 19.8503 2.75H15.5504C14.5304 2.75 14.1504 3.13002 14.1504 4.15002V6C14.1504 6.41 13.8104 6.75 13.4004 6.75C12.9904 6.75 12.6504 6.41 12.6504 6V4.15002C12.6504 2.31002 13.7104 1.25 15.5504 1.25H19.8503C21.6903 1.25 22.7504 2.31002 22.7504 4.15002V15.85C22.7504 17.69 21.6903 18.75 19.8503 18.75Z"
                                          fill="#707791" />
                                        <path
                                          d="M14 11.75H10C9.59 11.75 9.25 11.41 9.25 11C9.25 10.59 9.59 10.25 10 10.25H14C14.41 10.25 14.75 10.59 14.75 11C14.75 11.41 14.41 11.75 14 11.75Z"
                                          fill="#707791" />
                                        <path
                                          d="M14 14.75H10C9.59 14.75 9.25 14.41 9.25 14C9.25 13.59 9.59 13.25 10 13.25H14C14.41 13.25 14.75 13.59 14.75 14C14.75 14.41 14.41 14.75 14 14.75Z"
                                          fill="#707791" />
                                        <path
                                          d="M12 22.75C11.59 22.75 11.25 22.41 11.25 22V19C11.25 18.59 11.59 18.25 12 18.25C12.41 18.25 12.75 18.59 12.75 19V22C12.75 22.41 12.41 22.75 12 22.75Z"
                                          fill="#707791" />
                                      </svg>
                                      View Places
                                    </li>
                                    <li>
                                      <svg width="24" height="24" viewBox="0 0 24 24" fill="none"
                                        xmlns="http://www.w3.org/2000/svg">
                                        <g id="vuesax/outline/document">
                                          <g id="document">
                                            <path id="Vector"
                                              d="M15 22.75H9C3.57 22.75 1.25 20.43 1.25 15V9C1.25 3.57 3.57 1.25 9 1.25H14C14.41 1.25 14.75 1.59 14.75 2C14.75 2.41 14.41 2.75 14 2.75H9C4.39 2.75 2.75 4.39 2.75 9V15C2.75 19.61 4.39 21.25 9 21.25H15C19.61 21.25 21.25 19.61 21.25 15V10C21.25 9.59 21.59 9.25 22 9.25C22.41 9.25 22.75 9.59 22.75 10V15C22.75 20.43 20.43 22.75 15 22.75Z"
                                              fill="#707791" />
                                            <path id="Vector_2"
                                              d="M22 10.75H18C14.58 10.75 13.25 9.41999 13.25 5.99999V1.99999C13.25 1.69999 13.43 1.41999 13.71 1.30999C13.99 1.18999 14.31 1.25999 14.53 1.46999L22.53 9.46999C22.74 9.67999 22.81 10.01 22.69 10.29C22.57 10.57 22.3 10.75 22 10.75ZM14.75 3.80999V5.99999C14.75 8.57999 15.42 9.24999 18 9.24999H20.19L14.75 3.80999Z"
                                              fill="#707791" />
                                          </g>
                                        </g>
                                      </svg>

                                      View PDF
                                    </li>
                                    <li>
                                      <svg width="24" height="24" viewBox="0 0 24 24" fill="none"
                                        xmlns="http://www.w3.org/2000/svg">
                                        <g id="vuesax/outline/image">
                                          <g id="image">
                                            <path id="Vector"
                                              d="M18.3599 22.75H5.58987C4.06987 22.75 2.67987 21.98 1.87987 20.68C1.07987 19.38 1.00987 17.8 1.68987 16.43L3.40987 12.98C3.96987 11.86 4.86987 11.16 5.87987 11.05C6.88987 10.94 7.91987 11.44 8.69987 12.41L8.91987 12.69C9.35987 13.23 9.86987 13.52 10.3699 13.47C10.8699 13.43 11.3299 13.07 11.6699 12.46L13.5599 9.04999C14.3399 7.63999 15.3799 6.90999 16.5099 6.95999C17.6299 7.01999 18.5899 7.85999 19.2299 9.33999L22.3599 16.65C22.9399 18 22.7999 19.54 21.9899 20.77C21.1899 22.02 19.8299 22.75 18.3599 22.75ZM6.15987 12.55C6.11987 12.55 6.07987 12.55 6.03987 12.56C5.53987 12.61 5.07987 13.01 4.74987 13.66L3.02987 17.11C2.57987 18 2.62987 19.05 3.14987 19.9C3.66987 20.75 4.58987 21.26 5.58987 21.26H18.3499C19.3299 21.26 20.1999 20.79 20.7399 19.97C21.2799 19.15 21.3699 18.17 20.9799 17.27L17.8499 9.95999C17.4699 9.05999 16.9399 8.50999 16.4299 8.48999C15.9599 8.45999 15.3499 8.95999 14.8699 9.80999L12.9799 13.22C12.3999 14.26 11.4899 14.91 10.4999 15C9.50987 15.08 8.49987 14.6 7.74987 13.66L7.52987 13.38C7.10987 12.83 6.62987 12.55 6.15987 12.55Z"
                                              fill="#707791" />
                                            <path id="Vector_2"
                                              d="M6.96973 8.75C4.90973 8.75 3.21973 7.07 3.21973 5C3.21973 2.93 4.89973 1.25 6.96973 1.25C9.03973 1.25 10.7197 2.93 10.7197 5C10.7197 7.07 9.03973 8.75 6.96973 8.75ZM6.96973 2.75C5.72973 2.75 4.71973 3.76 4.71973 5C4.71973 6.24 5.72973 7.25 6.96973 7.25C8.20973 7.25 9.21973 6.24 9.21973 5C9.21973 3.76 8.20973 2.75 6.96973 2.75Z"
                                              fill="#707791" />
                                          </g>
                                        </g>
                                      </svg>
                                      View Image
                                    </li>
                                    <li>
                                      <svg width="24" height="24" viewBox="0 0 24 24" fill="none"
                                        xmlns="http://www.w3.org/2000/svg">
                                        <g id="Street View">
                                          <path id="Vector"
                                            d="M12 3C10.3506 3 9 4.35059 9 6C9 6.83496 9.35742 7.58789 9.91406 8.13281C8.91504 8.80957 8.25 9.96094 8.25 11.25V14.7188L9.75 15.4688V18.75H14.25V15.4688L15.75 14.7188V11.25C15.75 9.96094 15.085 8.80957 14.0859 8.13281C14.6426 7.58789 15 6.83496 15 6C15 4.35059 13.6494 3 12 3ZM12 4.5C12.8379 4.5 13.5 5.16211 13.5 6C13.5 6.83789 12.8379 7.5 12 7.5C11.1621 7.5 10.5 6.83789 10.5 6C10.5 5.16211 11.1621 4.5 12 4.5ZM12 9C13.251 9 14.25 9.99902 14.25 11.25V13.7812L12.75 14.5312V17.25H11.25V14.5312L9.75 13.7812V11.25C9.75 9.99902 10.749 9 12 9ZM6.75 14.1562C4.56152 14.7686 3 15.8057 3 17.25C3 19.7109 7.52637 21 12 21C16.4736 21 21 19.7109 21 17.25C21 15.8057 19.4385 14.7686 17.25 14.1562V15.7266C18.6768 16.1865 19.5 16.7812 19.5 17.25C19.5 18.1465 16.5088 19.5 12 19.5C7.49121 19.5 4.5 18.1465 4.5 17.25C4.5 16.7812 5.32324 16.1865 6.75 15.7266V14.1562Z"
                                            fill="#707791" />
                                        </g>
                                      </svg>
                                      Street View
                                    </li>
                                    <li>
                                      <svg width="24" height="24" viewBox="0 0 24 24" fill="none"
                                        xmlns="http://www.w3.org/2000/svg">
                                        <g id="vuesax/outline/edit-2">
                                          <g id="edit-2">
                                            <path id="Vector"
                                              d="M5.53999 19.52C4.92999 19.52 4.35999 19.31 3.94999 18.92C3.42999 18.43 3.17999 17.69 3.26999 16.89L3.63999 13.65C3.70999 13.04 4.07999 12.23 4.50999 11.79L12.72 3.09999C14.77 0.929988 16.91 0.869988 19.08 2.91999C21.25 4.96999 21.31 7.10999 19.26 9.27999L11.05 17.97C10.63 18.42 9.84999 18.84 9.23999 18.94L6.01999 19.49C5.84999 19.5 5.69999 19.52 5.53999 19.52ZM15.93 2.90999C15.16 2.90999 14.49 3.38999 13.81 4.10999L5.59999 12.81C5.39999 13.02 5.16999 13.52 5.12999 13.81L4.75999 17.05C4.71999 17.38 4.79999 17.65 4.97999 17.82C5.15999 17.99 5.42999 18.05 5.75999 18L8.97999 17.45C9.26999 17.4 9.74999 17.14 9.94999 16.93L18.16 8.23999C19.4 6.91999 19.85 5.69999 18.04 3.99999C17.24 3.22999 16.55 2.90999 15.93 2.90999Z"
                                              fill="#707791" />
                                            <path id="Vector_2"
                                              d="M17.3404 10.95C17.3204 10.95 17.2904 10.95 17.2704 10.95C14.1504 10.64 11.6404 8.26997 11.1604 5.16997C11.1004 4.75997 11.3804 4.37997 11.7904 4.30997C12.2004 4.24997 12.5804 4.52997 12.6504 4.93997C13.0304 7.35997 14.9904 9.21997 17.4304 9.45997C17.8404 9.49997 18.1404 9.86997 18.1004 10.28C18.0504 10.66 17.7204 10.95 17.3404 10.95Z"
                                              fill="#707791" />
                                            <path id="Vector_3"
                                              d="M21 22.75H3C2.59 22.75 2.25 22.41 2.25 22C2.25 21.59 2.59 21.25 3 21.25H21C21.41 21.25 21.75 21.59 21.75 22C21.75 22.41 21.41 22.75 21 22.75Z"
                                              fill="#707791" />
                                          </g>
                                        </g>
                                      </svg>
                                      Update Selection
                                    </li>
                                  </ul>
                                  <i class="fa-solid fa-caret-left"></i>
                               </div> -->
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </td>
          </tr>

          <!-- Expanded Places Row -->
          <tr *ngIf="isExpanded(item.id)">
            <td colspan="7">
              <div class="d-flex justify-content-end mb-2">
                <button class="btn btn-link" (click)="togglePlaces(item.id)">
                  <i class="fas fa-minus"></i> Minimize
                </button>
              </div>
              <div class="table-responsive">
                <table class="table table-sm table-striped">
                  <thead>
                    <tr style="
                        background-color: var(--secondary-color) !important;
                      ">
                      <th>Id</th>
                      <!-- <th>Address</th>
                      <th>City</th>
                      <th>State</th>
                      <th>Zip</th>
                      <th>Type</th> -->
                      <th>Building Size Sf</th>
                      <th>Secondary Type</th>
                      <th>Street View</th>
                      <th>Action</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="
                        let place of item.MarketSurveyShoppingCenters[0].Place
                      ">
                      <td>{{ place.Id }}</td>
                      <!-- <td>{{ place.Address }}</td>
                      <td>{{ place.City }}</td>
                      <td>{{ place.State }}</td>
                      <td>{{ place.Zip }}</td>
                      <td>{{ place.Type }}</td> -->
                      <td>{{ place.BuildingSizeSf }}</td>
                      <td>{{ place.SecondaryType }}</td>
                      <td class="shortcuts">
                        <a href="javascript:void(0)" *ngIf="place.StreetViewURL" (click)="
                            openPlaceStreetViewModal(
                              placeStreetViewModal,
                              place.StreetViewURL
                            )
                          ">
                          <i class="fas fa-street-view" title="Place Street View"></i>
                        </a>
                      </td>
                      <td>
                        <button class="btn btn-danger btn-sm" (click)="
                            openDeletePlaceModal(deletePlaceModal, place.Id)
                          ">
                          <i class="fas fa-trash-alt"></i> Place
                        </button>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </td>
          </tr>
        </ng-container>
      </tbody>
    </table>
  </div>
  <div class="pt-2 d-flex justify-content-center align-items-center" style="height: 50vh;"
    *ngIf="filteredBuyBoxPlacesAndShoppingCenter.length == 0">
    <p style="font-weight: 500;">No data </p>
  </div>

  <ng-template #updateReasonModal let-modal>
    <div class="d-flex justify-content-center align-items-center view-act pt-3">
      <h4>Update Shopping Center Selection Reason</h4>
    </div>
    <div class="modal-body">
      <form>
        <div class="mb-3">
          <textarea class="form-control" style="box-shadow: none;outline: none;" id="siteSelectionReason" rows="15"
            [(ngModel)]="selectedSiteSelectionReason" name="siteSelectionReason"></textarea>
        </div>
      </form>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-secondary" (click)="modal.dismiss()">
        Cancel
      </button>
      <button type="button" class="btn btn-primary" (click)="updateSiteSelectionReason(modal)">
        Save
      </button>
    </div>
  </ng-template>

  <ng-template #shoppingCenterStreetViewModal let-modal>
    <div class="d-flex justify-content-center align-items-center view-act pt-3">
      <h4>Shopping Center Street View</h4>
    </div>
    <div class="modal-body">
      <!-- Ensure the ID matches what is queried in the TypeScript -->
      <div id="street-view-modal" style="height: 500px; width: 100%"></div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-secondary" (click)="modal.dismiss()">Close</button>
    </div>
  </ng-template>
  <!-- Place Street View Modal -->
  <ng-template #placeStreetViewModal let-modal>
    <div class="d-flex justify-content-between align-items-center view-act pt-3">
      <h4 style="padding-inline: 20px;">Place Street View</h4>
      <button type="button" class="btn-close p-3" (click)="modal.dismiss()">
      </button>
    </div>
    <div class="modal-body" id="place-street-view-modal" style="height: 500px; width: 100%">
      <!-- Place Street View iframe will be injected here -->
    </div>
  </ng-template>
  <!-- delete-shopping-center-modal -->
  <ng-template #deleteShoppingCenterModal let-modal>
    <div class="modal-body-general p-4 rounded" style="
        background-color: #f8f9fa;
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      ">
      <h2 class="text-center mb-4" style="font-size: 1.5rem; font-weight: bold; color: var(--app-color)">
        Delete Shopping Center
      </h2>
      <p class="text-center" style="font-size: 1rem; color: #6c757d">
        Are you sure you want to delete this Shopping Center?
      </p>

      <div class="d-flex justify-content-end mt-4">
        <button type="button" class="btn btn-secondary me-2 px-4 py-2" (click)="modal.dismiss('Cancel click')"
          style="border-radius: 4px">
          Cancel
        </button>
        <button type="button" class="btn btn-danger px-4 py-2" (click)="confirmDeleteShoppingCenter(modal)"
          style="border-radius: 4px">
          Delete
        </button>
      </div>
    </div>
  </ng-template>
  <!-- delete-place-modal -->
  <ng-template #deletePlaceModal let-modal>
    <div class="modal-body-general p-4 rounded" style="
        background-color: #f8f9fa;
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      ">
      <h2 class="text-center mb-4" style="font-size: 1.5rem; font-weight: bold; color: var(--app-color)">
        Delete Place
      </h2>
      <p class="text-center" style="font-size: 1rem; color: #6c757d">
        Are you sure you want to delete this Place?
      </p>

      <div class="d-flex justify-content-end mt-4">
        <button type="button" class="btn btn-secondary me-2 px-4 py-2" (click)="modal.dismiss('Cancel click')"
          style="border-radius: 4px">
          Cancel
        </button>
        <button type="button" class="btn btn-danger px-4 py-2" (click)="confirmDeletePlace(modal)"
          style="border-radius: 4px">
          Delete
        </button>
      </div>
    </div>
  </ng-template>
  <ng-template #nearestRetailsModal let-modal>
    <div class="d-flex justify-content-center align-items-center view-act">
      <h4>Relation Branches</h4>
    </div>
    <div class="modal-body" style="overflow-y: auto; max-height: 80vh">
      <table class="table table-striped">
        <thead>
          <tr>
            <th>Relation Name</th>
            <th>Name</th>
            <th>Distance (miles)</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let retail of nearestRetails">
            <td>{{ retail.name }}</td>
            <td>{{ retail.name1 }}</td>
            <td>{{ retail.distance }}</td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-secondary" (click)="modal.close()">
        Close
      </button>
    </div>
  </ng-template>

  <ng-template #MapViewPlace let-modal>
    <div id="mappopup" style="height: 700px" *ngIf="mapViewOnePlacex"></div>
  </ng-template>
</div>
