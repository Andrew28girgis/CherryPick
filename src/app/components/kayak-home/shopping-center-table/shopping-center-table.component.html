<ngx-spinner type="ball-scale-multiple"></ngx-spinner>

<div class="row mb-3 d-sm-flex d-none">
  <div
    class="col-6 col-md-6 pt-2 d-flex justify-content-strat align-items-cente"
  >
    <div class="custom-icon-container">
      <div
        class="icon-option"
        *ngFor="let option of dropdowmOptions"
        (click)="selectOption(option)"
        [class.selected]="
          selectedOption === option.status || selectedOption === option
        "
        [ngClass]="{
          'hide-on-mobile': option.text === 'Side List View'
        }"
      >
        <img [src]="option.icon" [alt]="option.text" class="icon-image" />
        <span class="icon-text hide-on-mobile">{{ option.text }}</span>
      </div>
    </div>
  </div>
</div>
<ng-container *ngIf="currentView == 5">
  @if (shoppingCenters.length > 0) {
  <div class="indicators-container">
    <div
      class="scroll-indicator up-indicator d-none d-sm-flex"
      (click)="scrollUp()"
      #upIndicator
    >
      <i class="fas fa-chevron-up"></i>
    </div>
    <div
      class="scroll-indicator down-indicator d-none d-sm-flex"
      (click)="scrollDown()"
      #downIndicator
    >
      <i class="fas fa-chevron-down"></i>
    </div>
  </div>
  }
  <div class="scroll-container" #scrollContainer>
    <div class="card" *ngFor="let shopping of shoppingCenters; let i = index">
      <div
        class="social-card mb-0 mb-sm-5 Res"
        [style.backgroundImage]="
          'url(' +
          (shopping.MainImage || 'assets/Images/skeltonImage.png') +
          ')'
        "
      >
        <div class="card-header">
          <div class="header-info Res d-sm-flex d-none">
            <h3 class="center-name">
              {{ shopping.CenterName | titlecase }}
            </h3>
            <div
              (click)="openMapViewPlace(MapViewPlace, shopping)"
              style="width: fit-content"
            >
              <p
                class="center-address"
                style="cursor: pointer; width: fit-content"
              >
                {{ shopping.CenterAddress }},
                {{ shopping.CenterCity | titlecase }},
                {{ shopping.CenterState }}
              </p>
            </div>

            <div>
              <p
                style="color: white; font-size: 1rem"
                [innerHTML]="getShoppingCenterUnitSize(shopping)"
              ></p>
            </div>
            <div class="row">
              <ng-container
                *ngFor="let item of shopping.ShoppingCenter?.BuyBoxPlaces"
              >
                <div
                  style="
                    color: white;
                    font-weight: bold;
                    padding: 0;
                    display: flex;
                    align-items: center;
                    font-size: 1rem;
                  "
                >
                  <span> {{ getNeareastCategoryName(item.CategoryId) }}: </span>

                  <img
                    class="logo"
                    src="https://api.cherrypick.com/api/Organization/GetOrgImag?orgId={{
                      item.RelationOrganizationId
                    }}"
                    [title]="item.RelationOrganizationName"
                    alt=""
                  />

                  <span> {{ item.RelationOrganizationName }}</span>
                </div>
              </ng-container>
            </div>
          </div>

          <div class="header-info Res d-sm-none d-flex">
            <div class="info-header">
              <!-- Expanded Info, shown when showMore is true -->

              <!-- Initial Display -->
              <h3 class="center-name">{{ shopping.CenterName | titlecase }}</h3>
              <p style="color: #fff">{{ shopping.CenterAddress }}</p>
              <p class="center-address">
                {{ shopping.CenterCity | titlecase }},
                {{ shopping.CenterState }}
              </p>
              <p
                style="color: #fff"
                [innerHTML]="getShoppingCenterUnitSize(shopping)"
              ></p>

              <!-- See More Button -->
              <p
                (click)="openDetails(shoppingDetails, shopping)"
                class="see-more-btn"
              >
                {{ showMore[i] ? "Show Less" : "See More" }}
              </p>
            </div>
          </div>
        </div>
        <div class="card-image Res">
          <img
            class="Res"
            [src]="
              shopping.MainImage && shopping.MainImage !== ''
                ? shopping.MainImage
                : 'assets/Images/skeltonImage.png'
            "
            [alt]="shopping.CenterName"
          />
        </div>

        <div class="card-footer">
          <div class="reaction-buttons">
            <button
              class="action-btn like-btn"
              [class.liked]="isLiked(shopping)"
              (click)="addLike(shopping, 1)"
              [disabled]="isLikeInProgress"
            >
              <svg
                class="iconResponsive"
                width="33"
                height="32"
                viewBox="0 0 33 32"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M11.6867 24.6533V11.1067C11.6867 10.5733 11.8467 10.0533 12.14 9.61334L15.78 4.20001C16.3533 3.33334 17.78 2.72001 18.9933 3.17334C20.3 3.61334 21.1667 5.08001 20.8867 6.38667L20.1933 10.7467C20.14 11.1467 20.2467 11.5067 20.4733 11.7867C20.7 12.04 21.0333 12.2 21.3933 12.2H26.8733C27.9267 12.2 28.8333 12.6267 29.3667 13.3733C29.8733 14.0933 29.9667 15.0267 29.6333 15.9733L26.3533 25.96C25.94 27.6133 24.14 28.96 22.3533 28.96H17.1533C16.26 28.96 15.0067 28.6533 14.4333 28.08L12.7267 26.76C12.0733 26.2667 11.6867 25.48 11.6867 24.6533Z"
                  fill="white"
                />
                <path
                  d="M7.44666 8.50671H6.07332C4.00666 8.50671 3.16666 9.30671 3.16666 11.28V24.6934C3.16666 26.6667 4.00666 27.4667 6.07332 27.4667H7.44666C9.51332 27.4667 10.3533 26.6667 10.3533 24.6934V11.28C10.3533 9.30671 9.51332 8.50671 7.44666 8.50671Z"
                  fill="white"
                />
              </svg>

              <span class="d-block d-sm-block">
                {{
                  shopping.ShoppingCenter.Reactions
                    ? shopping.ShoppingCenter.Reactions.length
                    : 0
                }}
              </span>

              <!-- <span class="reactionMobile">
                  {{ getPrimaryReaction(shopping) }}
                </span> -->
            </button>
          </div>
          <button
            class="action-btn comment-btn"
            (click)="toggleComments(shopping, $event)"
          >
            <svg
              width="33"
              height="32"
              viewBox="0 0 33 32"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M25.1267 22.44L25.6467 26.6533C25.78 27.76 24.5933 28.5333 23.6467 27.96L19.0333 25.2133C18.7133 25.0266 18.6333 24.6266 18.8067 24.3066C19.4733 23.08 19.8333 21.6933 19.8333 20.3066C19.8333 15.4266 15.6467 11.4533 10.5 11.4533C9.44668 11.4533 8.42001 11.6133 7.46001 11.9333C6.96668 12.0933 6.48668 11.64 6.60668 11.1333C7.82001 6.27996 12.4867 2.66663 18.06 2.66663C24.5667 2.66663 29.8333 7.58663 29.8333 13.6533C29.8333 17.2533 27.98 20.44 25.1267 22.44Z"
                fill="white"
              />
              <path
                d="M17.8333 20.3067C17.8333 21.8934 17.2467 23.36 16.26 24.52C14.94 26.12 12.8467 27.1467 10.5 27.1467L7.01999 29.2134C6.43332 29.5734 5.68666 29.08 5.76666 28.4L6.09999 25.7734C4.31332 24.5334 3.16666 22.5467 3.16666 20.3067C3.16666 17.96 4.41999 15.8934 6.33999 14.6667C7.52666 13.8934 8.95332 13.4534 10.5 13.4534C14.5533 13.4534 17.8333 16.52 17.8333 20.3067Z"
                fill="white"
              />
            </svg>

            <span class="reactionMobile">
              {{
                shopping.ShoppingCenter.Comments
                  ? shopping.ShoppingCenter.Comments.length
                  : 0
              }}
            </span>
          </button>
          <button
            class="action-btn share-btn"
            (click)="openContactsModal(contactsModal)"
          >
            <svg
              width="33"
              height="32"
              viewBox="0 0 33 32"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M22.02 3.94672L9.98 7.94672C1.88667 10.6534 1.88667 15.0667 9.98 17.7601L13.5533 18.9467L14.74 22.5201C17.4333 30.6134 21.86 30.6134 24.5533 22.5201L28.5667 10.4934C30.3533 5.09339 27.42 2.14672 22.02 3.94672ZM22.4467 11.1201L17.38 16.2134C17.18 16.4134 16.9267 16.5067 16.6733 16.5067C16.42 16.5067 16.1667 16.4134 15.9667 16.2134C15.58 15.8267 15.58 15.1867 15.9667 14.8001L21.0333 9.70672C21.42 9.32006 22.06 9.32006 22.4467 9.70672C22.8333 10.0934 22.8333 10.7334 22.4467 11.1201Z"
                fill="white"
              />
            </svg>

            <span class="share"> Share </span>
          </button>
          <div style="position: relative" #shortcutsContainer>
            <button
              style="
                background: #fff;
                border-radius: 20px;
                color: var(--Colors-Primary-500, #001f3f);
              "
              class="ellipsis_icont"
              (click)="toggleShortcutsCard(shopping.Id)"
            >
              <i class="fa-solid fa-ellipsis"></i>
            </button>
            <div
              class="shortcuts_iconCard"
              style="bottom: 0% !important ; top: auto !important"
              *ngIf="selectedIdCard === shopping.Id"
            >
              <ul>
                <li style="cursor: pointer">
                  <a
                    class="target"
                    [href]="
                      '/emily/' +
                      BuyBoxId +
                      '/' +
                      shopping.ShoppingCenter.ManagerOrganization[0].ID +
                      '/' +
                      shopping.Id
                    "
                    target="_blank"
                  >
                    <i
                      class="fa-regular fa-envelope"
                      style="font-size: 18px; margin-top: 3px; width: 24px"
                    ></i>
                    Emily
                  </a>
                </li>
                <li>
                  <a class="target" (click)="openGallery(shopping.Id)">
                    <i
                      class="fa-solid fa-images"
                      style="font-size: 18px; margin-top: 3px; width: 24px"
                    ></i>
                    View Gallery
                  </a>

                  <div
                    class="w-100 d-flex justify-content-end"
                    *ngIf="placeImage && placeImage.length > 0"
                  ></div>
                </li>

                <!-- <li>
                      <a
                        class="target"
                        (click)="toggleShortcuts(shopping.Id, 'close')"
                      >
                        <svg
                          xmlns="http://www.w3.org/2000/svg"
                          width="24"
                          height="24"
                          viewBox="0 0 24 24"
                          fill="none"
                          stroke="currentColor"
                          stroke-width="2"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          class="lucide lucide-copy"
                        >
                          <rect
                            width="14"
                            height="14"
                            x="8"
                            y="8"
                            rx="2"
                            ry="2"
                          />
                          <path
                            d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"
                          />
                        </svg>
                        Copy Link
                      </a>
                    </li> -->
                <li (click)="toggleShortcuts(shopping.Id, 'close')">
                  <a
                    class="target"
                    [routerLink]="[
                      '/landing',
                      shopping?.ShoppingCenter?.Places
                        ? shopping.ShoppingCenter.Places[0].Id
                        : 0,
                      shopping.Id,
                      BuyBoxId
                    ]"
                    ><svg
                      width="24"
                      height="24"
                      viewBox="0 0 24 24"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        d="M6.70001 18.75H4.15002C2.31002 18.75 1.25 17.69 1.25 15.85V4.15002C1.25 2.31002 2.31002 1.25 4.15002 1.25H8.45001C10.29 1.25 11.35 2.31002 11.35 4.15002V6C11.35 6.41 11.01 6.75 10.6 6.75C10.19 6.75 9.84998 6.41 9.84998 6V4.15002C9.84998 3.13002 9.47001 2.75 8.45001 2.75H4.15002C3.13002 2.75 2.75 3.13002 2.75 4.15002V15.85C2.75 16.87 3.13002 17.25 4.15002 17.25H6.70001C7.11001 17.25 7.45001 17.59 7.45001 18C7.45001 18.41 7.11001 18.75 6.70001 18.75Z"
                        fill="#707791"
                      />
                      <path
                        d="M14.9602 22.75H9.12018C7.11018 22.75 5.9502 21.59 5.9502 19.58V8.41998C5.9502 6.40998 7.11018 5.25 9.12018 5.25H14.9602C16.9702 5.25 18.1202 6.40998 18.1202 8.41998V19.58C18.1202 21.59 16.9702 22.75 14.9602 22.75ZM9.12018 6.75C7.92018 6.75 7.4502 7.21998 7.4502 8.41998V19.58C7.4502 20.78 7.92018 21.25 9.12018 21.25H14.9602C16.1502 21.25 16.6202 20.78 16.6202 19.58V8.41998C16.6202 7.21998 16.1502 6.75 14.9602 6.75H9.12018Z"
                        fill="#707791"
                      />
                      <path
                        d="M19.8503 18.75H17.3704C16.9604 18.75 16.6204 18.41 16.6204 18C16.6204 17.59 16.9604 17.25 17.3704 17.25H19.8503C20.8703 17.25 21.2504 16.87 21.2504 15.85V4.15002C21.2504 3.13002 20.8703 2.75 19.8503 2.75H15.5504C14.5304 2.75 14.1504 3.13002 14.1504 4.15002V6C14.1504 6.41 13.8104 6.75 13.4004 6.75C12.9904 6.75 12.6504 6.41 12.6504 6V4.15002C12.6504 2.31002 13.7104 1.25 15.5504 1.25H19.8503C21.6903 1.25 22.7504 2.31002 22.7504 4.15002V15.85C22.7504 17.69 21.6903 18.75 19.8503 18.75Z"
                        fill="#707791"
                      />
                      <path
                        d="M14 11.75H10C9.59 11.75 9.25 11.41 9.25 11C9.25 10.59 9.59 10.25 10 10.25H14C14.41 10.25 14.75 10.59 14.75 11C14.75 11.41 14.41 11.75 14 11.75Z"
                        fill="#707791"
                      />
                      <path
                        d="M14 14.75H10C9.59 14.75 9.25 14.41 9.25 14C9.25 13.59 9.59 13.25 10 13.25H14C14.41 13.25 14.75 13.59 14.75 14C14.75 14.41 14.41 14.75 14 14.75Z"
                        fill="#707791"
                      />
                      <path
                        d="M12 22.75C11.59 22.75 11.25 22.41 11.25 22V19C11.25 18.59 11.59 18.25 12 18.25C12.41 18.25 12.75 18.59 12.75 19V22C12.75 22.41 12.41 22.75 12 22.75Z"
                        fill="#707791"
                      />
                    </svg>
                    View Details
                  </a>
                </li>
                <li (click)="toggleShortcuts(shopping.Id, 'close')">
                  <a
                    class="target"
                    (click)="openMapViewPlace(MapViewPlace, shopping)"
                  >
                    <i
                      class="fa-solid fa-map-location-dot"
                      style="font-size: 18px; margin-top: 3px; width: 24px"
                    ></i>
                    View location
                  </a>
                </li>
                <li (click)="toggleShortcuts(shopping.Id, 'close')">
                  <a
                    class="target"
                    (click)="openStreetViewPlace(StreetViewPlace, shopping)"
                  >
                    <svg
                      width="24"
                      height="24"
                      viewBox="0 0 24 24"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <g id="Street View">
                        <path
                          id="Vector"
                          d="M12 3C10.3506 3 9 4.35059 9 6C9 6.83496 9.35742 7.58789 9.91406 8.13281C8.91504 8.80957 8.25 9.96094 8.25 11.25V14.7188L9.75 15.4688V18.75H14.25V15.4688L15.75 14.7188V11.25C15.75 9.96094 15.085 8.80957 14.0859 8.13281C14.6426 7.58789 15 6.83496 15 6C15 4.35059 13.6494 3 12 3ZM12 4.5C12.8379 4.5 13.5 5.16211 13.5 6C13.5 6.83789 12.8379 7.5 12 7.5C11.1621 7.5 10.5 6.83789 10.5 6C10.5 5.16211 11.1621 4.5 12 4.5ZM12 9C13.251 9 14.25 9.99902 14.25 11.25V13.7812L12.75 14.5312V17.25H11.25V14.5312L9.75 13.7812V11.25C9.75 9.99902 10.749 9 12 9ZM6.75 14.1562C4.56152 14.7686 3 15.8057 3 17.25C3 19.7109 7.52637 21 12 21C16.4736 21 21 19.7109 21 17.25C21 15.8057 19.4385 14.7686 17.25 14.1562V15.7266C18.6768 16.1865 19.5 16.7812 19.5 17.25C19.5 18.1465 16.5088 19.5 12 19.5C7.49121 19.5 4.5 18.1465 4.5 17.25C4.5 16.7812 5.32324 16.1865 6.75 15.7266V14.1562Z"
                          fill="#707791"
                        />
                      </g>
                    </svg>
                    Street View
                  </a>
                </li>
                <li
                  style="cursor: pointer"
                  (click)="toggleShortcuts(shopping.Id, 'close')"
                >
                  <a
                    class="target"
                    (click)="
                      openDeleteShoppingCenterModal(
                        deleteSingleShoppingCenterModal,
                        shopping.Id
                      )
                    "
                  >
                    <i
                      class="fa-regular fa-trash-can"
                      style="font-size: 18px; margin-top: 3px; width: 24px"
                    ></i>
                    Remove Shopping
                  </a>
                </li>
              </ul>
              <i class="fa-solid fa-caret-right" style="top: 86%"></i>
            </div>
          </div>
        </div>
        <div
          class="comments-section"
          *ngIf="showComments[shopping.Id]"
          #commentsContainer
          (click)="$event.stopPropagation()"
        >
          <div #inputField class="comment-input">
            <input
              type="text"
              placeholder="Write a comment..."
              [(ngModel)]="newComments[shopping.MarketSurveyId]"
              (ngModelChange)="trimComment($event, shopping.MarketSurveyId)"
            />
            <button
              class="post-comment-btn"
              (click)="addComment(shopping, shopping.MarketSurveyId)"
            >
              Comment
            </button>
          </div>

          <ul #commentsList class="comment-list">
            <ng-container
              *ngFor="
                let comment of sortCommentsByDate(
                  shopping.ShoppingCenter.Comments
                )
              "
            >
              <li>
                <div class="comment-content d-flex justify-content-between">
                  <p>{{ comment.Comment }}</p>
                  <p>{{ comment.CommentDate | date }}</p>
                  <!-- <button
                          class="reply-btn"
                          (click)="toggleReply(shopping.MarketSurveyId, comment.id)"
                        >
                          Reply
                        </button> -->
                </div>

                <!-- <div
                        class="reply-input"
                        *ngIf="replyingTo[shopping.MarketSurveyId] === comment.id"
                      >
                        <input
                          type="text"
                          placeholder="Write a reply..."
                          [(ngModel)]="newReplies[comment.id]"
                        />
                        <button
                          class="post-reply-btn"
                          (click)="addReply(shopping.MarketSurveyId, comment.id)"
                        >
                          Reply
                        </button>
                      </div> -->

                <!-- <ul
                        class="reply-list"
                        *ngIf="comment.replies && comment.replies.length > 0"
                      >
                        <li *ngFor="let reply of comment.replies">
                          <div class="comment-content">
                            <strong>{{ reply.user }}</strong>
                            <p>{{ reply.text }}</p>
                          </div>
                        </li>
                      </ul> -->
              </li>
            </ng-container>
          </ul>
        </div>
      </div>
    </div>
  </div>
  <div class="row d-sm-none fixed-bottom-mobile">
    <div class="col-12 d-flex justify-content-around align-items-center">
      <div class="custom-icon-container">
        <p routerLink="/summary" class="d-flex d-sm-none Home-icon">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="#7A8591"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="lucide lucide-house"
          >
            <path d="M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8" />
            <path
              d="M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"
            />
          </svg>
        </p>
        <div
          class="icon-option"
          *ngFor="let option of dropdowmOptions"
          (click)="selectOption(option)"
          [class.selected]="
            selectedOption === option.status || selectedOption === option
          "
          [ngClass]="{
            'hide-on-mobile': option.text === 'Side List View'
          }"
        >
          <img [src]="option.icon" [alt]="option.text" class="icon-image" />
        </div>
      </div>
    </div>
  </div>
</ng-container>
<div class="row whitee">
  <ng-container *ngIf="currentView == 4">
    <div class="container p-2">
      <div
        class="mtopp"
        *ngIf="
          showShoppingCenters && shoppingCenters && shoppingCenters.length > 0
        "
      >
        <table class="procpect-table">
          <thead class="procpect-table-head">
            <tr>
              <th>Name</th>
              <th>Address</th>
              <th>City</th>
              <th>State</th>

              <th *ngIf="placesRepresentative != false">Leased by</th>
              <th>Unit Size & Lease Price</th>
              <th>
                <ng-container
                  *ngFor="
                    let item of shoppingCenters[0].ShoppingCenter.BuyBoxPlaces;
                    let i = index
                  "
                >
                  {{ getNeareastCategoryName(item.CategoryId) }}
                </ng-container>
              </th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody class="procpect-table-body">
            <ng-container *ngFor="let shoppingCenter of shoppingCenters">
              <tr>
                <td>
                  <span
                    class="table-text"
                    [innerHTML]="shoppingCenter.CenterName | titlecase"
                  ></span>
                </td>
                <td>
                  <div
                    class="table-text cursor"
                    (click)="openMapViewPlace(MapViewPlace, shoppingCenter)"
                  >
                    {{ shoppingCenter.CenterAddress }},
                    {{ shoppingCenter.CenterCity | titlecase }},
                    {{ shoppingCenter.CenterState }}
                  </div>
                </td>
                <td>
                  {{ shoppingCenter.CenterCity | titlecase }}
                </td>
                <td>
                  {{ shoppingCenter.CenterState }}
                </td>
                <td *ngIf="placesRepresentative != false">
                  <ng-container
                    *ngIf="shoppingCenter.ShoppingCenter?.ManagerOrganization"
                  >
                    <div>
                      <div
                        class="d-flex align-items-center justify-content-between w-100"
                      >
                        <img
                          class="logo"
                          src="https://api.cherrypick.com/api/Organization/GetOrgImag?orgId={{
                            shoppingCenter.ShoppingCenter.ManagerOrganization[0]
                              .ID
                          }}"
                          [title]="
                            shoppingCenter.ShoppingCenter.ManagerOrganization[0]
                              .Name
                          "
                          alt=""
                        />
                        <div class="table-text">
                          {{
                            shoppingCenter.ShoppingCenter.ManagerOrganization[0]
                              .Name
                          }}
                        </div>

                        <div>
                          <img
                            class="ms-2 cursor"
                            src="../../../assets/Images/Icons/eye.png"
                            alt="View Manager Details"
                            [ngbPopover]="popoverContent"
                            popoverTitle="Organization Contact Info"
                            triggers="click:outside"
                            [placement]="'right'"
                          />
                        </div>
                      </div>
                      <ng-template #popoverContent>
                        <!-- Dynamic Content from ManagerOrganization -->
                        <div
                          *ngFor="
                            let org of shoppingCenter.ShoppingCenter
                              .ManagerOrganization
                          "
                          class="contact-container table-texttt"
                        >
                          <p class="text-bold m-0">
                            {{ org.Firstname | titlecase }}
                            {{ org.LastName | titlecase }}
                          </p>
                          <p class="m-0">{{ org.CellPhone }}</p>
                          <p class="m-0">{{ org.Email }}</p>
                          <hr
                            *ngIf="
                              !isLast(
                                org,
                                shoppingCenter.ShoppingCenter
                                  .ManagerOrganization
                              )
                            "
                          />
                        </div>
                      </ng-template>
                    </div>
                  </ng-container>
                </td>
                <td
                  class="table-text"
                  [innerHTML]="getShoppingCenterUnitSize(shoppingCenter)"
                ></td>
                <td>
                  <ng-container
                    *ngIf="
                      shoppingCenter?.ShoppingCenter?.BuyBoxPlaces;
                      else emptyTd
                    "
                  >
                    <ng-container
                      *ngFor="
                        let item of shoppingCenter?.ShoppingCenter
                          ?.BuyBoxPlaces;
                        let i = index;
                        trackBy: trackByIndex
                      "
                    >
                      <div
                        class="d-flex align-items-center justify-content-center"
                      >
                        <img
                          class="logo"
                          src="https://api.cherrypick.com/api/Organization/GetOrgImag?orgId={{
                            item.RelationOrganizationId
                          }}"
                          [title]="item.RelationOrganizationName"
                          alt=""
                        />
                        <span>{{ item.RelationOrganizationName }}</span>
                        <div
                          class="d-flex align-items-center justify-content-center"
                        >
                          <span class="ms-2 table-text"> </span>
                        </div>
                      </div>
                    </ng-container>
                  </ng-container>
                </td>
                <ng-template #emptyTd> </ng-template>
                <td>
                  <div class="absolutee">
                    <div
                      class="d-flex justify-content-center align-items-center cursor"
                    >
                      <div class="d-flex toggy">
                        <button
                          class="ellipsis_icon"
                          (click)="
                            toggleShortcuts(
                              shoppingCenter.Id,
                              undefined,
                              $event
                            )
                          "
                        >
                          <i class="fa-solid fa-ellipsis"></i>
                        </button>
                        <div
                          class="shortcuts_icon"
                          *ngIf="selectedId === shoppingCenter.Id"
                        >
                          <ul>
                            <li>
                              <a
                                class="target"
                                [href]="
                                  '/emily/' +
                                  BuyBoxId +
                                  '/' +
                                  shoppingCenter.ShoppingCenter
                                    .ManagerOrganization[0].ID +
                                  '/' +
                                  shoppingCenter.Id
                                "
                                target="_blank"
                              >
                                <i class="fa-regular fa-envelope emily"></i>
                                Emily
                              </a>
                            </li>

                            <li
                              (click)="
                                toggleShortcuts(shoppingCenter.Id, 'close')
                              "
                            >
                              <a
                                class="target"
                                [routerLink]="[
                                  '/landing',
                                  shoppingCenter?.ShoppingCenter?.Places
                                    ? shoppingCenter.ShoppingCenter.Places[0].Id
                                    : 0,
                                  shoppingCenter.Id,
                                  BuyBoxId
                                ]"
                              >
                                <svg
                                  width="24"
                                  height="24"
                                  viewBox="0 0 24 24"
                                  fill="none"
                                  xmlns="http://www.w3.org/2000/svg"
                                >
                                  <path
                                    d="M6.70001 18.75H4.15002C2.31002 18.75 1.25 17.69 1.25 15.85V4.15002C1.25 2.31002 2.31002 1.25 4.15002 1.25H8.45001C10.29 1.25 11.35 2.31002 11.35 4.15002V6C11.35 6.41 11.01 6.75 10.6 6.75C10.19 6.75 9.84998 6.41 9.84998 6V4.15002C9.84998 3.13002 9.47001 2.75 8.45001 2.75H4.15002C3.13002 2.75 2.75 3.13002 2.75 4.15002V15.85C2.75 16.87 3.13002 17.25 4.15002 17.25H6.70001C7.11001 17.25 7.45001 17.59 7.45001 18C7.45001 18.41 7.11001 18.75 6.70001 18.75Z"
                                    fill="#707791"
                                  />
                                  <path
                                    d="M14.9602 22.75H9.12018C7.11018 22.75 5.9502 21.59 5.9502 19.58V8.41998C5.9502 6.40998 7.11018 5.25 9.12018 5.25H14.9602C16.9702 5.25 18.1202 6.40998 18.1202 8.41998V19.58C18.1202 21.59 16.9702 22.75 14.9602 22.75ZM9.12018 6.75C7.92018 6.75 7.4502 7.21998 7.4502 8.41998V19.58C7.4502 20.78 7.92018 21.25 9.12018 21.25H14.9602C16.1502 21.25 16.6202 20.78 16.6202 19.58V8.41998C16.6202 7.21998 16.1502 6.75 14.9602 6.75H9.12018Z"
                                    fill="#707791"
                                  />
                                  <path
                                    d="M19.8503 18.75H17.3704C16.9604 18.75 16.6204 18.41 16.6204 18C16.6204 17.59 16.9604 17.25 17.3704 17.25H19.8503C20.8703 17.25 21.2504 16.87 21.2504 15.85V4.15002C21.2504 3.13002 20.8703 2.75 19.8503 2.75H15.5504C14.5304 2.75 14.1504 3.13002 14.1504 4.15002V6C14.1504 6.41 13.8104 6.75 13.4004 6.75C12.9904 6.75 12.6504 6.41 12.6504 6V4.15002C12.6504 2.31002 13.7104 1.25 15.5504 1.25H19.8503C21.6903 1.25 22.7504 2.31002 22.7504 4.15002V15.85C22.7504 17.69 21.6903 18.75 19.8503 18.75Z"
                                    fill="#707791"
                                  />
                                  <path
                                    d="M14 11.75H10C9.59 11.75 9.25 11.41 9.25 11C9.25 10.59 9.59 10.25 10 10.25H14C14.41 10.25 14.75 10.59 14.75 11C14.75 11.41 14.41 11.75 14 11.75Z"
                                    fill="#707791"
                                  />
                                  <path
                                    d="M14 14.75H10C9.59 14.75 9.25 14.41 9.25 14C9.25 13.59 9.59 13.25 10 13.25H14C14.41 13.25 14.75 13.59 14.75 14C14.75 14.41 14.41 14.75 14 14.75Z"
                                    fill="#707791"
                                  />
                                  <path
                                    d="M12 22.75C11.59 22.75 11.25 22.41 11.25 22V19C11.25 18.59 11.59 18.25 12 18.25C12.41 18.25 12.75 18.59 12.75 19V22C12.75 22.41 12.41 22.75 12 22.75Z"
                                    fill="#707791"
                                  />
                                </svg>
                                View Details
                              </a>
                            </li>
                            <li
                              (click)="
                                toggleShortcuts(shoppingCenter.Id, 'close')
                              "
                            >
                              <a
                                class="target"
                                (click)="
                                  openMapViewPlace(MapViewPlace, shoppingCenter)
                                "
                              >
                                <i
                                  class="fa-solid fa-map-location-dot emily"
                                ></i>
                                View location
                              </a>
                            </li>
                            <li
                              (click)="
                                toggleShortcuts(shoppingCenter.Id, 'close')
                              "
                            >
                              <a
                                class="target"
                                (click)="
                                  openStreetViewPlace(
                                    StreetViewPlace,
                                    shoppingCenter
                                  )
                                "
                              >
                                <svg
                                  width="24"
                                  height="24"
                                  viewBox="0 0 24 24"
                                  fill="none"
                                  xmlns="http://www.w3.org/2000/svg"
                                >
                                  <g id="Street View">
                                    <path
                                      id="Vector"
                                      d="M12 3C10.3506 3 9 4.35059 9 6C9 6.83496 9.35742 7.58789 9.91406 8.13281C8.91504 8.80957 8.25 9.96094 8.25 11.25V14.7188L9.75 15.4688V18.75H14.25V15.4688L15.75 14.7188V11.25C15.75 9.96094 15.085 8.80957 14.0859 8.13281C14.6426 7.58789 15 6.83496 15 6C15 4.35059 13.6494 3 12 3ZM12 4.5C12.8379 4.5 13.5 5.16211 13.5 6C13.5 6.83789 12.8379 7.5 12 7.5C11.1621 7.5 10.5 6.83789 10.5 6C10.5 5.16211 11.1621 4.5 12 4.5ZM12 9C13.251 9 14.25 9.99902 14.25 11.25V13.7812L12.75 14.5312V17.25H11.25V14.5312L9.75 13.7812V11.25C9.75 9.99902 10.749 9 12 9ZM6.75 14.1562C4.56152 14.7686 3 15.8057 3 17.25C3 19.7109 7.52637 21 12 21C16.4736 21 21 19.7109 21 17.25C21 15.8057 19.4385 14.7686 17.25 14.1562V15.7266C18.6768 16.1865 19.5 16.7812 19.5 17.25C19.5 18.1465 16.5088 19.5 12 19.5C7.49121 19.5 4.5 18.1465 4.5 17.25C4.5 16.7812 5.32324 16.1865 6.75 15.7266V14.1562Z"
                                      fill="#707791"
                                    />
                                  </g>
                                </svg>
                                Street View
                              </a>
                            </li>
                            <li
                              class="cursor"
                              (click)="
                                toggleShortcuts(shoppingCenter.Id, 'close')
                              "
                            >
                              <a
                                class="target"
                                (click)="
                                  openDeleteShoppingCenterModal(
                                    deleteSingleShoppingCenterModal,
                                    shoppingCenter.Id
                                  )
                                "
                              >
                                <i class="fa-regular fa-trash-can emily"></i>
                                Remove Shopping
                              </a>
                            </li>
                          </ul>
                          <i class="fa-solid fa-caret-right"></i>
                        </div>
                      </div>
                    </div>
                  </div>
                </td>
              </tr>
            </ng-container>
          </tbody>
        </table>
      </div>
    </div>
    <div class="row d-sm-none fixed-bottom-mobile">
      <div class="col-12 d-flex justify-content-around align-items-center">
        <div class="custom-icon-container">
          <p routerLink="/summary" class="d-flex d-sm-none Home-icon">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="#7A8591"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="lucide lucide-house"
            >
              <path d="M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8" />
              <path
                d="M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"
              />
            </svg>
          </p>

          <div
            class="icon-option"
            *ngFor="let option of dropdowmOptions"
            (click)="selectOption(option)"
            [class.selected]="
              selectedOption === option.status || selectedOption === option
            "
            [ngClass]="{
              'hide-on-mobile': option.text === 'Side List View'
            }"
          >
            <img [src]="option.icon" [alt]="option.text" class="icon-image" />
          </div>
        </div>
      </div>
    </div>
    <div
      class="pt-2 d-flex justify-content-center align-items-center heightt"
      *ngIf="shoppingCenters?.length == 0"
    >
      <p class="fontweight">No data Shopping Center</p>
    </div>
  </ng-container>

  <div
    class="whitee"
    [ngClass]="{
      'd-none': currentView == 1 || currentView == 4 || currentView == 5,
      'col-md-8 col-sm-12 cards ': currentView == 2,
      'col-12': currentView == 3
    }"
    class="responsiveMain"
  >
    <div class="row mt-2">
      <ng-container *ngIf="currentView != 2">
        <ng-container *ngFor="let shopping of shoppingCenters">
          <div
            class="card-window cursor"
            [ngClass]="{
              'col-md-4 col-sm-4 col-12': currentView == 3,
              'col-12 col-sm-6 cards': currentView == 2
            }"
          >
            <div class="cardResponsive">
              <a
                [routerLink]="['/landing',shopping?.ShoppingCenter?.Places?.[0]?.Id || 0,shopping?.Id,BuyBoxId]"
              >
                <div class="main-img">
                  <img
                    src="{{
                      shopping.MainImage || 'assets/Images/skeltonImage.png'
                    }}"
                    [title]="shopping.CenterName"
                  />
                </div>
                <div class="-container"></div>
              </a>
              <div
                class="content-wrap card-content card-content_view view-cont"
              >
                <!-- <div> -->
                <div>
                  <div class="d-flex justify-content-between">
                    <a
                      class="textdecoration"
                      [routerLink]="[ '/landing', shopping?.ShoppingCenter?.Places ? shopping?.ShoppingCenter?.Places?.[0]?.Id : 0,shopping.Id,BuyBoxId]"
                    >
                      <div class="content-title cursor">
                        {{
                          shopping.CenterName.length > 22
                            ? (shopping.CenterName | titlecase).slice(0, 22) +
                              "..."
                            : (shopping.CenterName | titlecase)
                        }}
                      </div>
                    </a>

                    <div class="relativee">
                      <button
                        class="ellipsis_icont"
                        (click)="toggleShortcutsCard(shopping.Id)"
                      >
                        <i class="fa-solid fa-ellipsis"></i>
                      </button>
                      <div
                        class="shortcuts_iconCard"
                        *ngIf="selectedIdCard === shopping.Id"
                      >
                        <ul>
                          <li class="cursor">
                            <a
                              class="target"
                              [href]="
                                '/emily/' +
                                BuyBoxId +
                                '/' +
                                shopping.ShoppingCenter.ManagerOrganization[0]
                                  .ID +
                                '/' +
                                shopping?.Id
                              "
                              target="_blank"
                            >
                              <i class="fa-regular fa-envelope emily"></i>
                              Emily
                            </a>
                          </li>
                          <li (click)="toggleShortcuts(shopping.Id, 'close')">
                            <a
                              class="target"
                              [routerLink]="['/landing',shopping?.ShoppingCenter?.Places?.[0]?.Id || 0,shopping?.Id,BuyBoxId]"
                            >
                              <svg
                                width="24"
                                height="24"
                                viewBox="0 0 24 24"
                                fill="none"
                                xmlns="http://www.w3.org/2000/svg"
                              >
                                <path
                                  d="M6.70001 18.75H4.15002C2.31002 18.75 1.25 17.69 1.25 15.85V4.15002C1.25 2.31002 2.31002 1.25 4.15002 1.25H8.45001C10.29 1.25 11.35 2.31002 11.35 4.15002V6C11.35 6.41 11.01 6.75 10.6 6.75C10.19 6.75 9.84998 6.41 9.84998 6V4.15002C9.84998 3.13002 9.47001 2.75 8.45001 2.75H4.15002C3.13002 2.75 2.75 3.13002 2.75 4.15002V15.85C2.75 16.87 3.13002 17.25 4.15002 17.25H6.70001C7.11001 17.25 7.45001 17.59 7.45001 18C7.45001 18.41 7.11001 18.75 6.70001 18.75Z"
                                  fill="#707791"
                                />
                                <path
                                  d="M14.9602 22.75H9.12018C7.11018 22.75 5.9502 21.59 5.9502 19.58V8.41998C5.9502 6.40998 7.11018 5.25 9.12018 5.25H14.9602C16.9702 5.25 18.1202 6.40998 18.1202 8.41998V19.58C18.1202 21.59 16.9702 22.75 14.9602 22.75ZM9.12018 6.75C7.92018 6.75 7.4502 7.21998 7.4502 8.41998V19.58C7.4502 20.78 7.92018 21.25 9.12018 21.25H14.9602C16.1502 21.25 16.6202 20.78 16.6202 19.58V8.41998C16.6202 7.21998 16.1502 6.75 14.9602 6.75H9.12018Z"
                                  fill="#707791"
                                />
                                <path
                                  d="M19.8503 18.75H17.3704C16.9604 18.75 16.6204 18.41 16.6204 18C16.6204 17.59 16.9604 17.25 17.3704 17.25H19.8503C20.8703 17.25 21.2504 16.87 21.2504 15.85V4.15002C21.2504 3.13002 20.8703 2.75 19.8503 2.75H15.5504C14.5304 2.75 14.1504 3.13002 14.1504 4.15002V6C14.1504 6.41 13.8104 6.75 13.4004 6.75C12.9904 6.75 12.6504 6.41 12.6504 6V4.15002C12.6504 2.31002 13.7104 1.25 15.5504 1.25H19.8503C21.6903 1.25 22.7504 2.31002 22.7504 4.15002V15.85C22.7504 17.69 21.6903 18.75 19.8503 18.75Z"
                                  fill="#707791"
                                />
                                <path
                                  d="M14 11.75H10C9.59 11.75 9.25 11.41 9.25 11C9.25 10.59 9.59 10.25 10 10.25H14C14.41 10.25 14.75 10.59 14.75 11C14.75 11.41 14.41 11.75 14 11.75Z"
                                  fill="#707791"
                                />
                                <path
                                  d="M14 14.75H10C9.59 14.75 9.25 14.41 9.25 14C9.25 13.59 9.59 13.25 10 13.25H14C14.41 13.25 14.75 13.59 14.75 14C14.75 14.41 14.41 14.75 14 14.75Z"
                                  fill="#707791"
                                />
                                <path
                                  d="M12 22.75C11.59 22.75 11.25 22.41 11.25 22V19C11.25 18.59 11.59 18.25 12 18.25C12.41 18.25 12.75 18.59 12.75 19V22C12.75 22.41 12.41 22.75 12 22.75Z"
                                  fill="#707791"
                                />
                              </svg>
                              View Details
                            </a>
                          </li>
                          <li (click)="toggleShortcuts(shopping.Id, 'close')">
                            <a
                              class="target"
                              (click)="openMapViewPlace(MapViewPlace, shopping)"
                            >
                              <i class="fa-solid fa-map-location-dot emily"></i>
                              View location
                            </a>
                          </li>
                          <li (click)="toggleShortcuts(shopping.Id, 'close')">
                            <a
                              class="target"
                              (click)="
                                openStreetViewPlace(StreetViewPlace, shopping)
                              "
                            >
                              <svg
                                width="24"
                                height="24"
                                viewBox="0 0 24 24"
                                fill="none"
                                xmlns="http://www.w3.org/2000/svg"
                              >
                                <g id="Street View">
                                  <path
                                    id="Vector"
                                    d="M12 3C10.3506 3 9 4.35059 9 6C9 6.83496 9.35742 7.58789 9.91406 8.13281C8.91504 8.80957 8.25 9.96094 8.25 11.25V14.7188L9.75 15.4688V18.75H14.25V15.4688L15.75 14.7188V11.25C15.75 9.96094 15.085 8.80957 14.0859 8.13281C14.6426 7.58789 15 6.83496 15 6C15 4.35059 13.6494 3 12 3ZM12 4.5C12.8379 4.5 13.5 5.16211 13.5 6C13.5 6.83789 12.8379 7.5 12 7.5C11.1621 7.5 10.5 6.83789 10.5 6C10.5 5.16211 11.1621 4.5 12 4.5ZM12 9C13.251 9 14.25 9.99902 14.25 11.25V13.7812L12.75 14.5312V17.25H11.25V14.5312L9.75 13.7812V11.25C9.75 9.99902 10.749 9 12 9ZM6.75 14.1562C4.56152 14.7686 3 15.8057 3 17.25C3 19.7109 7.52637 21 12 21C16.4736 21 21 19.7109 21 17.25C21 15.8057 19.4385 14.7686 17.25 14.1562V15.7266C18.6768 16.1865 19.5 16.7812 19.5 17.25C19.5 18.1465 16.5088 19.5 12 19.5C7.49121 19.5 4.5 18.1465 4.5 17.25C4.5 16.7812 5.32324 16.1865 6.75 15.7266V14.1562Z"
                                    fill="#707791"
                                  />
                                </g>
                              </svg>
                              Street View
                            </a>
                          </li>
                          <li
                            class="cursor"
                            (click)="toggleShortcuts(shopping.Id, 'close')"
                          >
                            <!-- (click)="openDeleteShoppingCenterModal(deleteShoppingCenterModal,item.id)" -->
                            <a
                              class="target"
                              (click)="
                                openDeleteShoppingCenterModal(
                                  deleteSingleShoppingCenterModal,
                                  shopping.Id
                                )
                              "
                            >
                              <i class="fa-regular fa-trash-can emily"></i>
                              Remove Shopping
                            </a>
                          </li>
                        </ul>
                        <i class="fa-solid fa-caret-right"></i>
                      </div>
                    </div>
                  </div>
                  <div
                    class="card-address cursor"
                    (click)="openMapViewPlace(MapViewPlace, shopping)"
                  >
                    <span class="mb-5">
                      {{ shopping.CenterAddress }},
                      {{ shopping.CenterCity | titlecase }},
                      {{ shopping.CenterState }}
                    </span>
                  </div>
                  <div>
                    <p
                      class="ShoppingCenterUnitSize"
                      [innerHTML]="getShoppingCenterUnitSize(shopping)"
                    ></p>
                  </div>
                  <div class="row">
                    <div
                      *ngFor="let item of shopping.ShoppingCenter?.BuyBoxPlaces"
                      class="col-12 d-flex flex-column spec"
                    >
                      <div class="d-flex flex-column">
                        <p class="nearset-category">
                          <b>{{ getNeareastCategoryName(item.CategoryId) }} </b>
                        </p>
                        <p>
                          {{ item.RelationOrganizationName }}
                          <img
                            class="logo ms-2"
                            src="https://api.cherrypick.com/api/Organization/GetOrgImag?orgId={{
                              item.RelationOrganizationId
                            }}"
                            [title]="item.RelationOrganizationName"
                            alt=""
                          />
                        </p>
                      </div>
                    </div>
                  </div>
                </div>
                <div
                  class="col-md-12 spec"
                  *ngIf="
                    shopping.ShoppingCenter?.ManagerOrganization &&
                    placesRepresentative != false
                  "
                >
                  <hr class="small-hr mt-2" />
                  <span class="managed-by">Leased by</span>
                  <div class="spec-head between">
                    <div>
                      <img
                        class="logo"
                        src="https://api.cherrypick.com/api/Organization/GetOrgImag?orgId={{
                          shopping.ShoppingCenter.ManagerOrganization[0].ID
                        }}"
                        [title]="
                          shopping.ShoppingCenter.ManagerOrganization[0].Name
                        "
                        alt=""
                      />
                    </div>
                    <div class="width55">
                      {{ shopping.ShoppingCenter.ManagerOrganization[0].Name }}
                    </div>
                    <div>
                      <img
                        class="ms-2 cursor"
                        src="../../../assets/Images/Icons/eye.png"
                        alt="View Manager Details"
                        [ngbPopover]="popoverContent"
                        popoverTitle="Organization Contact Info"
                        triggers="click:outside"
                        [placement]="'top'"
                      />
                    </div>
                    <br />
                    <ng-template #popoverContent>
                      <div
                        *ngFor="
                          let org of shopping.ShoppingCenter.ManagerOrganization
                        "
                        class="contact-container table-texttt"
                      >
                        <p class="text-bold m-0">
                          {{ org.Firstname | titlecase }}
                          {{ org.LastName | titlecase }}
                        </p>
                        <p class="m-0">{{ org.CellPhone }}</p>
                        <p class="m-0">{{ org.Email }}</p>
                        <hr
                          *ngIf="
                            !isLast(
                              org,
                              shoppingCenter.ShoppingCenter.ManagerOrganization
                            )
                          "
                        />
                      </div>
                    </ng-template>
                  </div>
                </div>
                <!-- </div> -->
              </div>
            </div>
          </div>
        </ng-container>
      </ng-container>
      <ng-container *ngIf="currentView == 2">
        <div class="p-3 d-flex justify-content-between">
          <p class="m-0 fontweight">
            {{ cardsSideList.length }} places within map area
          </p>
          <div class="gap-2 d-flex" *ngIf="showbackIds.length > 0">
            <p
              class="Button_delete"
              (click)="ArrOfDelete(deleteShoppingCenterModal)"
            >
              Delete
            </p>
            <p class="Button_cancel" (click)="CancelDelete()">Cancel</p>
          </div>
        </div>

        <ng-container *ngFor="let place of cardsSideList">
          <div
            class="card-window cursor"
            (mouseenter)="onMouseHighlight(place)"
            (mouseleave)="onMouseLeaveHighlight(place)"
            [ngClass]="{ 'col-md-6 col-sm-12': currentView == 2 }"
          >
            <div class="card-window-back w-100">
              <a
                *ngIf="place.CenterCity"
                [routerLink]="[ '/landing', place.ShoppingCenter?.Places ? place.ShoppingCenter.Places?.[0].Id: 0,place.Id,BuyBoxId]"
              >
                <div class="main-img">
                  <img
                    src="{{
                      place.MainImage || 'assets/Images/skeltonImage.png'
                    }}"
                    [title]="place.CenterName"
                  />
                </div>
              </a>
              <a
                *ngIf="!place.CenterCity"
                [routerLink]="['/landing', place.Id, 0, BuyBoxId]"
              >
                <div class="main-img">
                  <img
                    src="{{
                      place.MainImage || 'assets/Images/skeltonImage.png'
                    }}"
                  />
                </div>
              </a>
              <div
                class="content-wrap card-sideview justify-content-between relativee"
              >
                <div>
                  <div *ngIf="place.CenterCity">
                    <div class="d-flex justify-content-between">
                      <a
                        [routerLink]="[ '/landing', place.ShoppingCenter?.Places ? place.ShoppingCenter.Places?.[0].Id: 0,place.Id,BuyBoxId]"
                      >
                        <p class="content-title cursor">
                          {{
                            place.CenterName.length > 22
                              ? (place.CenterName | titlecase).slice(0, 22) +
                                "..."
                              : (place.CenterName | titlecase)
                          }}
                        </p>
                      </a>

                      <div class="relativee">
                        <button
                          class="ellipsis_icont"
                          (click)="toggleShortcutsCard(place.Id)"
                        >
                          <i class="fa-solid fa-ellipsis"></i>
                        </button>
                        <div
                          class="shortcuts_iconCard"
                          *ngIf="selectedIdCard === place.Id"
                        >
                          <ul>
                            <li class="cursor">
                              <a
                                class="target"
                                [href]="
                                  '/emily/' +
                                  BuyBoxId +
                                  '/' +
                                  place.ShoppingCenter.ManagerOrganization[0]
                                    .ID +
                                  '/' +
                                  place?.Id
                                "
                                target="_blank"
                              >
                                <i class="fa-regular fa-envelope emily"></i>
                                Emily
                              </a>
                            </li>
                            <li (click)="toggleShortcuts(place.Id, 'close')">
                              <a
                                class="target"
                                [routerLink]="['/landing',place?.ShoppingCenter?.Places?.[0]?.Id || 0,place?.Id,BuyBoxId]"
                              >
                                <svg
                                  width="24"
                                  height="24"
                                  viewBox="0 0 24 24"
                                  fill="none"
                                  xmlns="http://www.w3.org/2000/svg"
                                >
                                  <path
                                    d="M6.70001 18.75H4.15002C2.31002 18.75 1.25 17.69 1.25 15.85V4.15002C1.25 2.31002 2.31002 1.25 4.15002 1.25H8.45001C10.29 1.25 11.35 2.31002 11.35 4.15002V6C11.35 6.41 11.01 6.75 10.6 6.75C10.19 6.75 9.84998 6.41 9.84998 6V4.15002C9.84998 3.13002 9.47001 2.75 8.45001 2.75H4.15002C3.13002 2.75 2.75 3.13002 2.75 4.15002V15.85C2.75 16.87 3.13002 17.25 4.15002 17.25H6.70001C7.11001 17.25 7.45001 17.59 7.45001 18C7.45001 18.41 7.11001 18.75 6.70001 18.75Z"
                                    fill="#707791"
                                  />
                                  <path
                                    d="M14.9602 22.75H9.12018C7.11018 22.75 5.9502 21.59 5.9502 19.58V8.41998C5.9502 6.40998 7.11018 5.25 9.12018 5.25H14.9602C16.9702 5.25 18.1202 6.40998 18.1202 8.41998V19.58C18.1202 21.59 16.9702 22.75 14.9602 22.75ZM9.12018 6.75C7.92018 6.75 7.4502 7.21998 7.4502 8.41998V19.58C7.4502 20.78 7.92018 21.25 9.12018 21.25H14.9602C16.1502 21.25 16.6202 20.78 16.6202 19.58V8.41998C16.6202 7.21998 16.1502 6.75 14.9602 6.75H9.12018Z"
                                    fill="#707791"
                                  />
                                  <path
                                    d="M19.8503 18.75H17.3704C16.9604 18.75 16.6204 18.41 16.6204 18C16.6204 17.59 16.9604 17.25 17.3704 17.25H19.8503C20.8703 17.25 21.2504 16.87 21.2504 15.85V4.15002C21.2504 3.13002 20.8703 2.75 19.8503 2.75H15.5504C14.5304 2.75 14.1504 3.13002 14.1504 4.15002V6C14.1504 6.41 13.8104 6.75 13.4004 6.75C12.9904 6.75 12.6504 6.41 12.6504 6V4.15002C12.6504 2.31002 13.7104 1.25 15.5504 1.25H19.8503C21.6903 1.25 22.7504 2.31002 22.7504 4.15002V15.85C22.7504 17.69 21.6903 18.75 19.8503 18.75Z"
                                    fill="#707791"
                                  />
                                  <path
                                    d="M14 11.75H10C9.59 11.75 9.25 11.41 9.25 11C9.25 10.59 9.59 10.25 10 10.25H14C14.41 10.25 14.75 10.59 14.75 11C14.75 11.41 14.41 11.75 14 11.75Z"
                                    fill="#707791"
                                  />
                                  <path
                                    d="M14 14.75H10C9.59 14.75 9.25 14.41 9.25 14C9.25 13.59 9.59 13.25 10 13.25H14C14.41 13.25 14.75 13.59 14.75 14C14.75 14.41 14.41 14.75 14 14.75Z"
                                    fill="#707791"
                                  />
                                  <path
                                    d="M12 22.75C11.59 22.75 11.25 22.41 11.25 22V19C11.25 18.59 11.59 18.25 12 18.25C12.41 18.25 12.75 18.59 12.75 19V22C12.75 22.41 12.41 22.75 12 22.75Z"
                                    fill="#707791"
                                  />
                                </svg>
                                View Details
                              </a>
                            </li>
                            <li (click)="toggleShortcuts(place.Id, 'close')">
                              <a
                                class="target"
                                (click)="openMapViewPlace(MapViewPlace, place)"
                              >
                                <i
                                  class="fa-solid fa-map-location-dot emily"
                                ></i>
                                View location
                              </a>
                            </li>
                            <li (click)="toggleShortcuts(place.Id, 'close')">
                              <a
                                class="target"
                                (click)="
                                  openStreetViewPlace(StreetViewPlace, place)
                                "
                              >
                                <svg
                                  width="24"
                                  height="24"
                                  viewBox="0 0 24 24"
                                  fill="none"
                                  xmlns="http://www.w3.org/2000/svg"
                                >
                                  <g id="Street View">
                                    <path
                                      id="Vector"
                                      d="M12 3C10.3506 3 9 4.35059 9 6C9 6.83496 9.35742 7.58789 9.91406 8.13281C8.91504 8.80957 8.25 9.96094 8.25 11.25V14.7188L9.75 15.4688V18.75H14.25V15.4688L15.75 14.7188V11.25C15.75 9.96094 15.085 8.80957 14.0859 8.13281C14.6426 7.58789 15 6.83496 15 6C15 4.35059 13.6494 3 12 3ZM12 4.5C12.8379 4.5 13.5 5.16211 13.5 6C13.5 6.83789 12.8379 7.5 12 7.5C11.1621 7.5 10.5 6.83789 10.5 6C10.5 5.16211 11.1621 4.5 12 4.5ZM12 9C13.251 9 14.25 9.99902 14.25 11.25V13.7812L12.75 14.5312V17.25H11.25V14.5312L9.75 13.7812V11.25C9.75 9.99902 10.749 9 12 9ZM6.75 14.1562C4.56152 14.7686 3 15.8057 3 17.25C3 19.7109 7.52637 21 12 21C16.4736 21 21 19.7109 21 17.25C21 15.8057 19.4385 14.7686 17.25 14.1562V15.7266C18.6768 16.1865 19.5 16.7812 19.5 17.25C19.5 18.1465 16.5088 19.5 12 19.5C7.49121 19.5 4.5 18.1465 4.5 17.25C4.5 16.7812 5.32324 16.1865 6.75 15.7266V14.1562Z"
                                      fill="#707791"
                                    />
                                  </g>
                                </svg>
                                Street View
                              </a>
                            </li>
                            <li
                              class="cursor"
                              (click)="toggleShortcuts(place.Id, 'close')"
                            >
                              <a
                                class="target"
                                (click)="deleteShopping(place.Id)"
                              >
                                <i class="fa-regular fa-trash-can emily"></i>
                                Remove Shopping
                              </a>
                            </li>
                          </ul>
                          <i class="fa-solid fa-caret-right"></i>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div
                    *ngIf="place.CenterAddress"
                    class="card-address cursor"
                    (click)="openMapViewPlace(MapViewPlace, place)"
                  >
                    <span>
                      {{ place.CenterAddress }},
                      {{ place.CenterCity | titlecase }},
                      {{ place.CenterState }}
                    </span>
                  </div>
                  <div
                    *ngIf="place.Address"
                    class="card-address cursor"
                    (click)="openMapViewPlace(MapViewPlace, place)"
                  >
                    <p>
                      {{ place.Address }}, {{ place.City | titlecase }},
                      {{ place.State }}
                    </p>
                  </div>
                  <div *ngIf="place.CenterAddress">
                    <p
                      class="ShoppingCenterUnitSize"
                      [innerHTML]="getShoppingCenterUnitSize(place)"
                    ></p>
                  </div>

                  <div
                    class="row"
                    *ngIf="place.ShoppingCenter?.BuyBoxPlaces || place.Place"
                  >
                    <div
                      *ngFor="
                        let item of place.ShoppingCenter
                          ? place.ShoppingCenter?.BuyBoxPlaces
                          : place.Place?.BuyBoxPlaces
                      "
                      class="col-12 d-flex flex-column spec"
                    >
                      <div class="d-flex flex-column">
                        <p class="nearset-category">
                          <b>{{ getNeareastCategoryName(item.CategoryId) }} </b>
                        </p>
                        <p>
                          {{ item.RelationOrganizationName }}
                          <img
                            class="logo ms-2"
                            src="https://api.cherrypick.com/api/Organization/GetOrgImag?orgId={{
                              item.RelationOrganizationId
                            }}"
                            [title]="item.RelationOrganizationName"
                            alt=""
                          />
                        </p>
                      </div>
                    </div>
                  </div>
                </div>
                <div
                  class="col-md-12 spec"
                  *ngIf="
                    place.ShoppingCenter?.ManagerOrganization &&
                    placesRepresentative != false
                  "
                >
                  <span class="managed-by">Leased by</span>
                  <div
                    class="spec-head d-flex align-items-center justify-content-between"
                  >
                    <div>
                      <img
                        class="logo"
                        src="https://api.cherrypick.com/api/Organization/GetOrgImag?orgId={{
                          place.ShoppingCenter.ManagerOrganization[0].ID
                        }}"
                        [title]="
                          place.ShoppingCenter.ManagerOrganization[0].Name
                        "
                        alt=""
                      />
                    </div>
                    <div>
                      {{ place.ShoppingCenter.ManagerOrganization[0].Name }}
                    </div>
                    <div>
                      <img
                        class="ms-2 cursor"
                        src="../../../assets/Images/Icons/eye.png"
                        alt="View Manager Details"
                        [ngbPopover]="popoverContent"
                        popoverTitle="Organization Contact Info"
                        [placement]="'top'"
                      />
                    </div>
                    <br />
                    <ng-template #popoverContent>
                      <div
                        *ngFor="
                          let org of place.ShoppingCenter.ManagerOrganization
                        "
                        class="contact-container table-texttt"
                      >
                        <p class="text-bold m-0">
                          {{ org.Firstname | titlecase }}
                          {{ org.LastName | titlecase }}
                        </p>
                        <p class="m-0">{{ org.CellPhone }}</p>
                        <p class="m-0">{{ org.Email }}</p>
                        <hr
                          *ngIf="
                            !isLast(
                              org,
                              shoppingCenter.ShoppingCenter.ManagerOrganization
                            )
                          "
                        />
                      </div>
                    </ng-template>
                  </div>
                </div>
              </div>
            </div>
            <div
              class="card-window-back2"
              [ngClass]="{ show: showbackIds.includes(place.Id) }"
            >
              <i
                class="fa-solid fa-trash"
                (click)="CancelOneDelete(place.Id)"
              ></i>
            </div>
          </div>
        </ng-container>
      </ng-container>
    </div>
    <div class="row d-sm-none fixed-bottom-mobile">
      <div class="col-12 d-flex justify-content-around align-items-center">
        <div class="custom-icon-container">
          <p routerLink="/summary" class="d-flex d-sm-none Home-icon">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="#7A8591"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="lucide lucide-house"
            >
              <path d="M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8" />
              <path
                d="M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"
              />
            </svg>
          </p>

          <div
            class="icon-option"
            *ngFor="let option of dropdowmOptions"
            (click)="selectOption(option)"
            [class.selected]="
              selectedOption === option.status || selectedOption === option
            "
            [ngClass]="{
              'hide-on-mobile': option.text === 'Side List View'
            }"
          >
            <img [src]="option.icon" [alt]="option.text" class="icon-image" />
          </div>
        </div>
      </div>
    </div>
  </div>
  <div
    class="p-0"
    [ngClass]="{
      'd-none': currentView == 4 || currentView == 3 || currentView == 5,
      'col-12': currentView == 1,
      'col-12 col-sm-4': currentView == 2
    }"
  >
    <div id="map" class="custom-map"></div>
    <div class="row d-sm-none fixed-bottom-mobile">
      <div class="col-12 d-flex justify-content-around align-items-center">
        <div class="custom-icon-container">
          <p routerLink="/summary" class="d-flex d-sm-none Home-icon">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="#7A8591"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="lucide lucide-house"
            >
              <path d="M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8" />
              <path
                d="M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"
              />
            </svg>
          </p>

          <div
            class="icon-option"
            *ngFor="let option of dropdowmOptions"
            (click)="selectOption(option)"
            [class.selected]="
              selectedOption === option.status || selectedOption === option
            "
            [ngClass]="{
              'hide-on-mobile': option.text === 'Side List View'
            }"
          >
            <img [src]="option.icon" [alt]="option.text" class="icon-image" />
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<ng-template #MapViewPlace let-modal>
  <div id="mappopup" class="h700" *ngIf="mapViewOnePlacex"></div>
</ng-template>

<ng-template #ShareLink let-modal>
  <div class="d-flex p-3 m-3 align-items-center shareelink">
    <p>{{ shareLink }}</p>
    <i class="fa-solid fa-copy ms-3 cursor" (click)="copyLink(shareLink)"></i>
  </div>
</ng-template>

<ng-template #StreetViewPlace let-modal>
  <div *ngIf="General.modalObject.StreetViewURL">
    <iframe
      [src]="sanitizedUrl"
      height="450"
      class="sanitizedUrl"
      allowfullscreen=""
    >
    </iframe>
  </div>
  <div
    id="street-view"
    class="h700"
    *ngIf="!General.modalObject.StreetViewURL"
  ></div>
</ng-template>

<ng-template #deleteShoppingCenterModal let-modal>
  <div class="modal-body-general p-4 rounded deleteShopping">
    <h2 class="text-center mb-4 RemoveShopping">Remove Shopping Center</h2>
    <p class="text-center Areyou">
      Are you sure you want to remove this Shopping Center?
    </p>

    <div class="d-flex justify-content-end mt-4">
      <button
        type="button"
        class="btn btn-secondary me-2 px-4 py-2 btnborder"
        (click)="modal.dismiss('Cancel click')"
      >
        Cancel
      </button>
      <button
        type="button"
        class="btn btn-danger px-4 py-2 btnborder"
        (click)="confirmDeleteShoppingCenter(modal)"
      >
        Remove
      </button>
    </div>
  </div>
</ng-template>

<ng-template #deleteSingleShoppingCenterModal let-modal>
  <div class="modal-body-general p-4 rounded deleteShopping">
    <h2 class="text-center mb-4 RemoveShopping">Remove Shopping Center</h2>
    <p class="text-center Areyou">
      Are you sure you want to remove this Shopping Center?
    </p>

    <div class="d-flex justify-content-end mt-4">
      <button
        type="button"
        class="btn btn-secondary me-2 px-4 py-2 btnborder"
        (click)="modal.dismiss('Cancel click')"
      >
        Cancel
      </button>
      <button
        type="button"
        class="btn btn-danger px-4 py-2 btnborder"
        (click)="deleteShCenter()"
      >
        Remove
      </button>
    </div>
  </div>
</ng-template>

<ng-template #shoppingDetails let-modal>
  <div class="modal-body p-0">
    <div class="carousel-wrapper position-relative">
      <div  class="expanded-info">
        <h4>Details:</h4>
        <p>{{ General.modalObject.CenterAddress }}</p>
        <p>{{ General.modalObject.CenterCity | titlecase }}</p>
        <p>{{ General.modalObject.CenterState }}</p>
        <p [innerHTML]="getShoppingCenterUnitSize(General.modalObject)"></p>

        <div class="row">
          <ng-container
            *ngFor="let item of General.modalObject.ShoppingCenter?.BuyBoxPlaces"
          >
            <div
              style="
                color: black;
                font-weight: bold;
                padding: 0;
                display: flex;
                align-items: center;
                font-size: 1rem;
              "
            >
              <span>{{ getNeareastCategoryName(item.CategoryId) }}: </span>
              <img
                class="logo"
                src="https://api.cherrypick.com/api/Organization/GetOrgImag?orgId={{
                  item.RelationOrganizationId
                }}"
                [title]="item.RelationOrganizationName"
                alt=""
              />
              <span>{{ item.RelationOrganizationName }}</span>
            </div>
          </ng-container>
        </div>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #contactsModal let-modal>
  <div class="modal-header d-flex justify-content-between align-items-center">
    <span class="modal-title" id="modal-basic-title">Contacts</span>
    <div>
      <button
        type="button"
        class="btn btn-primary me-2 contact-btn"
        (click)="openAddContactModal(addContactModal)"
      >
        Add New Contact
      </button>
      <button
        type="button"
        class="btn btn-close contact-btn"
        aria-label="Close"
        (click)="modal.dismiss('Cross click')"
      ></button>
    </div>
  </div>
  <!-- Added inline styles for vertical scrolling -->
  <div class="modal-body modalbodyy">
    <div
      *ngFor="let contact of OrganizationContacts"
      class="mb-3 border-bottom pb-2 d-flex justify-content-between align-items-center"
    >
      <div>
        <div>
          <span class="first-last"
            >{{ contact.firstname }} {{ contact.lastname }}
          </span>
        </div>
        <div>
          <span class="email">
            {{ contact.email }}
          </span>
        </div>
      </div>
      <!-- Pass the contact to openLink -->
      <i
        class="fa-solid fa-share ms-2 sharee-link"
        (click)="openLink(ShareLink, contact)"
      >
      </i>
    </div>
  </div>
  <div class="modal-footer">
    <button
      type="button"
      class="btn btn-secondary contact-btn"
      (click)="modal.close()"
    >
      Close
    </button>
  </div>
</ng-template>

<ng-template #addContactModal let-modal>
  <form (ngSubmit)="addContact(addContactForm)" #addContactForm="ngForm">
    <div class="modal-header d-flex justify-content-between align-items-center">
      <span class="modal-title" id="modal-add-contact">Add Contact</span>
      <div>
        <button
          type="button"
          class="btn btn-close"
          aria-label="Close"
          (click)="modal.dismiss('Cross click')"
        ></button>
      </div>
    </div>
    <div class="modal-body">
      <div class="mb-3">
        <label for="firstName" class="form-label">First Name</label>
        <input
          type="text"
          id="firstName"
          class="form-control"
          required
          [(ngModel)]="newContact.firstName"
          name="firstName"
        />
      </div>
      <div class="mb-3">
        <label for="lastName" class="form-label">Last Name</label>
        <input
          type="text"
          id="lastName"
          class="form-control"
          required
          [(ngModel)]="newContact.lastName"
          name="lastName"
        />
      </div>
      <div class="mb-3">
        <label for="email" class="form-label">Email</label>
        <input
          type="email"
          id="email"
          class="form-control"
          required
          [(ngModel)]="newContact.email"
          name="email"
        />
      </div>
      <div class="mb-3">
        <label for="password" class="form-label">Password</label>
        <input
          type="password"
          id="password"
          class="form-control"
          required
          [(ngModel)]="newContact.password"
          name="password"
        />
      </div>
    </div>
    <div class="modal-footer">
      <button
        type="submit"
        class="btn btn-primary me-2 contact-btn"
        [disabled]="!addContactForm.form.valid"
      >
        Save
      </button>
      <button
        type="button"
        class="btn btn-secondary contact-btn"
        (click)="modal.close()"
      >
        Close
      </button>
    </div>
  </form>
</ng-template>

<ng-template #galleryModal let-modal>
  <div class="modal-body p-0">
    <div class="carousel-wrapper position-relative">
      <ngb-carousel
        class="custom-carousel"
        [showNavigationIndicators]="true"
        [showNavigationArrows]="true"
      >
        <ng-template ngbSlide *ngFor="let img of placeImage; let i = index">
          <div class="text-center">
            <img [src]="img" class="img-fluid p-img" alt="image" />
          </div>
        </ng-template>
      </ngb-carousel>
    </div>
  </div>
</ng-template>
