<ngx-spinner type="ball-scale-multiple"></ngx-spinner>

<div class="row mb-3 container_border">
  <div class="col-6 col-md-6 pt-2 d-flex justify-content-strat align-items-cente">
    <div class="custom-icon-container">
      <!-- <div class="icon-option" *ngFor="let option of dropdowmOptions" (click)="selectOption(option)"
        [class.selected]="selectedOption === option.status"> -->
      <div class="icon-option" *ngFor="let option of dropdowmOptions" (click)="selectOption(option)"
        [class.selected]="selectedOption === option.status || selectedOption === option"
        [ngClass]="{'hide-on-mobile': option.text === 'Table View' || option.text === 'Side List View'}">
        <img [src]="option.icon" [alt]="option.text" class="icon-image" />
        <span class="icon-text">{{ option.text }}</span>
      </div>
    </div>

    <!-- <div class="checkbox-section-select pb-2">
      <label for="stateFilter" class="pb-2">Filter by State</label>
      <select class="form-select form-select-lg" aria-label="Large select example" id="stateFilter"
        [(ngModel)]="selectedState" (change)="onStateChange($event)">
        <option value="" selected>All States</option>
        <option *ngFor="let state of StateCodes" [value]="state">
          {{ state }}
        </option>
      </select>
    </div> -->
  </div>
  <!-- <div class="col-6 col-md- pt-2"> -->
  <!-- <div class="checkbox-section-select pb-2">
      <label for="cityFilter" class="pb-2">Filter by City</label>
      <select class="form-select form-select-lg" aria-label="Large select example" id="cityFilter"
        [(ngModel)]="selectedCity" (change)="onCityChange()" [disabled]="!filteredCities.length">
        <option value="">All Cities</option>
        <option *ngFor="let city of filteredCities" [value]="city">
          {{ city }}
        </option>
      </select>
    </div> -->
  <!-- </div> -->
  <!-- <div class="col-6 col-md-6 pt-2 d-flex justify-content-end align-items-center">
    <button class="Bind__button" [routerLink]="['/kayak']">Manage</button>
  </div> -->
</div>

<div class="map-view">
  <div class="row" style="background-color: #fff">
    <ng-container *ngIf="currentView == 4">
      <div class="container p-2">
        <div style="margin-top: 10px" *ngIf="
            showShoppingCenters && shoppingCenters && shoppingCenters.length > 0
          ">
          <table class="procpect-table">
            <thead class="procpect-table-head">
              <tr>
                <th>Name</th>
                <th>Address</th>
                <th>City</th>
                <th>State</th>

                <th *ngIf="placesRepresentative != false">Leased by</th>
                <th style="width: 250px">Unit Size & Lease Price</th>
                <th>
                  <ng-container *ngFor="
                      let item of shoppingCenters[0].ShoppingCenter
                        .BuyBoxPlaces;
                      let i = index
                    ">
                    {{ getNeareastCategoryName(item.CategoryId) }}
                  </ng-container>
                </th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody class="procpect-table-body">
              <ng-container *ngFor="let shoppingCenter of shoppingCenters">
                <tr>
                  <td>
                    <span class="table-text" [innerHTML]="shoppingCenter.CenterName | titlecase"></span>
                  </td>
                  <td>
                    <div class="table-text" (click)="openMapViewPlace(MapViewPlace, shoppingCenter)"
                      style="cursor: pointer">
                      {{ shoppingCenter.CenterAddress }}, {{
                        shoppingCenter.CenterCity | titlecase
                      }}, {{ shoppingCenter.CenterState }}
                    </div>
                  </td>
                  <td>
                    {{ shoppingCenter.CenterCity | titlecase
                  }}
                  </td>
                  <td>
                    {{ shoppingCenter.CenterState }}
                  </td>
                  <td *ngIf="placesRepresentative != false">
                    <ng-container *ngIf="shoppingCenter.ShoppingCenter?.ManagerOrganization">
                      <div>
                        <div class="d-flex align-items-center" style="width: 100%; justify-content: space-between">
                          <img class="logo" src="https://api.cherrypick.com/api/Organization/GetOrgImag?orgId={{
                              shoppingCenter.ShoppingCenter
                                .ManagerOrganization[0].ID
                            }}" [title]="
                              shoppingCenter.ShoppingCenter
                                .ManagerOrganization[0].Name
                            " alt="" />
                          <div class="table-text">
                            {{
                              shoppingCenter.ShoppingCenter
                                .ManagerOrganization[0].Name
                            }}
                          </div>

                          <div>
                            <img style="cursor: pointer" class="ms-2" src="../../../assets/Images/Icons/eye.png"
                              alt="View Manager Details" [ngbPopover]="popoverContent"
                              popoverTitle="Organization Contact Info" triggers="click:outside" [placement]="'right'" />
                          </div>
                        </div>
                        <ng-template #popoverContent>
                          <!-- Dynamic Content from ManagerOrganization -->
                          <div *ngFor="
                              let org of shoppingCenter.ShoppingCenter
                                .ManagerOrganization
                            " class="contact-container table-texttt">
                            <p class="text-bold m-0">
                              {{ org.Firstname | titlecase }}
                              {{ org.LastName | titlecase }}
                            </p>
                            <p class="m-0">{{ org.CellPhone }}</p>
                            <p class="m-0">{{ org.Email }}</p>
                            <hr *ngIf="
                                !isLast(
                                  org,
                                  shoppingCenter.ShoppingCenter
                                    .ManagerOrganization
                                )
                              " />
                          </div>
                        </ng-template>
                      </div>
                    </ng-container>
                  </td>
                  <td class="table-text" [innerHTML]="getShoppingCenterUnitSize(shoppingCenter)"></td>
                  <td>
                    <ng-container *ngIf="
                        shoppingCenter?.ShoppingCenter?.BuyBoxPlaces;
                        else emptyTd
                      ">
                      <ng-container *ngFor="
                          let item of shoppingCenter?.ShoppingCenter
                            ?.BuyBoxPlaces;
                          let i = index;
                          trackBy: trackByIndex
                        ">
                        <div class="d-flex align-items-center justify-content-center">
                          <img class="logo" src="https://api.cherrypick.com/api/Organization/GetOrgImag?orgId={{
                              item.RelationOrganizationId
                            }}" [title]="item.RelationOrganizationName" alt="" />
                          <span>{{ item.RelationOrganizationName }}</span>
                          <div class="d-flex align-items-center justify-content-center">
                            <span class="ms-2 table-text"> 
                            </span> 
                          </div>
                        </div>
                      </ng-container>
                    </ng-container>
                  </td>
                  <ng-template #emptyTd>
                  </ng-template>
                  <td>
                    <div style="position: absolute; display: contents">
                      <div class="d-flex justify-content-center align-items-center"
                        style="cursor: pointer svg-container">
                        <div style="display: flex; gap: 16px; position: relative"> 
                          <button class="ellipsis_icon" (click)="
                              toggleShortcuts(
                                shoppingCenter.Id,
                                undefined,
                                $event
                              )
                            ">
                            <i class="fa-solid fa-ellipsis"></i>
                          </button>
                          <div class="shortcuts_icon" *ngIf="selectedId === shoppingCenter.Id">
                            <ul>
                              <li>
                                <a class="target" [href]="'/emily/' + BuyBoxId + '/' + shoppingCenter.ShoppingCenter.ManagerOrganization[0].ID + '/' + shoppingCenter.Id" target="_blank">
                                  <i class="fa-regular fa-envelope" style="font-size: 18px; margin-top: 3px; width: 24px;"></i>
                                  Emily
                                </a>
                              </li>
                              
                              <li (click)="
                                  toggleShortcuts(shoppingCenter.Id, 'close')
                                ">
                                <a class="target" [routerLink]="[
                                    '/landing',
                                    shoppingCenter?.ShoppingCenter?.Places
                                      ? shoppingCenter.ShoppingCenter.Places[0]
                                          .Id
                                      : 0,
                                    shoppingCenter.Id,
                                    BuyBoxId,
                                    OrgId
                                  ]">
                                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none"
                                    xmlns="http://www.w3.org/2000/svg">
                                    <path
                                      d="M6.70001 18.75H4.15002C2.31002 18.75 1.25 17.69 1.25 15.85V4.15002C1.25 2.31002 2.31002 1.25 4.15002 1.25H8.45001C10.29 1.25 11.35 2.31002 11.35 4.15002V6C11.35 6.41 11.01 6.75 10.6 6.75C10.19 6.75 9.84998 6.41 9.84998 6V4.15002C9.84998 3.13002 9.47001 2.75 8.45001 2.75H4.15002C3.13002 2.75 2.75 3.13002 2.75 4.15002V15.85C2.75 16.87 3.13002 17.25 4.15002 17.25H6.70001C7.11001 17.25 7.45001 17.59 7.45001 18C7.45001 18.41 7.11001 18.75 6.70001 18.75Z"
                                      fill="#707791" />
                                    <path
                                      d="M14.9602 22.75H9.12018C7.11018 22.75 5.9502 21.59 5.9502 19.58V8.41998C5.9502 6.40998 7.11018 5.25 9.12018 5.25H14.9602C16.9702 5.25 18.1202 6.40998 18.1202 8.41998V19.58C18.1202 21.59 16.9702 22.75 14.9602 22.75ZM9.12018 6.75C7.92018 6.75 7.4502 7.21998 7.4502 8.41998V19.58C7.4502 20.78 7.92018 21.25 9.12018 21.25H14.9602C16.1502 21.25 16.6202 20.78 16.6202 19.58V8.41998C16.6202 7.21998 16.1502 6.75 14.9602 6.75H9.12018Z"
                                      fill="#707791" />
                                    <path
                                      d="M19.8503 18.75H17.3704C16.9604 18.75 16.6204 18.41 16.6204 18C16.6204 17.59 16.9604 17.25 17.3704 17.25H19.8503C20.8703 17.25 21.2504 16.87 21.2504 15.85V4.15002C21.2504 3.13002 20.8703 2.75 19.8503 2.75H15.5504C14.5304 2.75 14.1504 3.13002 14.1504 4.15002V6C14.1504 6.41 13.8104 6.75 13.4004 6.75C12.9904 6.75 12.6504 6.41 12.6504 6V4.15002C12.6504 2.31002 13.7104 1.25 15.5504 1.25H19.8503C21.6903 1.25 22.7504 2.31002 22.7504 4.15002V15.85C22.7504 17.69 21.6903 18.75 19.8503 18.75Z"
                                      fill="#707791" />
                                    <path
                                      d="M14 11.75H10C9.59 11.75 9.25 11.41 9.25 11C9.25 10.59 9.59 10.25 10 10.25H14C14.41 10.25 14.75 10.59 14.75 11C14.75 11.41 14.41 11.75 14 11.75Z"
                                      fill="#707791" />
                                    <path
                                      d="M14 14.75H10C9.59 14.75 9.25 14.41 9.25 14C9.25 13.59 9.59 13.25 10 13.25H14C14.41 13.25 14.75 13.59 14.75 14C14.75 14.41 14.41 14.75 14 14.75Z"
                                      fill="#707791" />
                                    <path
                                      d="M12 22.75C11.59 22.75 11.25 22.41 11.25 22V19C11.25 18.59 11.59 18.25 12 18.25C12.41 18.25 12.75 18.59 12.75 19V22C12.75 22.41 12.41 22.75 12 22.75Z"
                                      fill="#707791" />
                                  </svg>
                                  View Details
                                </a>
                              </li>
                              <li (click)="
                                  toggleShortcuts(shoppingCenter.Id, 'close')
                                ">
                                <a class="target" (click)="
                                    openMapViewPlace(
                                      MapViewPlace,
                                      shoppingCenter
                                    )
                                  ">
                                  <i class="fa-solid fa-map-location-dot" style="
                                      font-size: 18px;
                                      margin-top: 3px;
                                      width: 24px;
                                    "></i>
                                  View location
                                </a>
                              </li>
                              <li (click)="
                                  toggleShortcuts(shoppingCenter.Id, 'close')
                                ">
                                <a class="target" (click)="
                                    openStreetViewPlace(
                                      StreetViewPlace,
                                      shoppingCenter
                                    )
                                  ">
                                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none"
                                    xmlns="http://www.w3.org/2000/svg">
                                    <g id="Street View">
                                      <path id="Vector"
                                        d="M12 3C10.3506 3 9 4.35059 9 6C9 6.83496 9.35742 7.58789 9.91406 8.13281C8.91504 8.80957 8.25 9.96094 8.25 11.25V14.7188L9.75 15.4688V18.75H14.25V15.4688L15.75 14.7188V11.25C15.75 9.96094 15.085 8.80957 14.0859 8.13281C14.6426 7.58789 15 6.83496 15 6C15 4.35059 13.6494 3 12 3ZM12 4.5C12.8379 4.5 13.5 5.16211 13.5 6C13.5 6.83789 12.8379 7.5 12 7.5C11.1621 7.5 10.5 6.83789 10.5 6C10.5 5.16211 11.1621 4.5 12 4.5ZM12 9C13.251 9 14.25 9.99902 14.25 11.25V13.7812L12.75 14.5312V17.25H11.25V14.5312L9.75 13.7812V11.25C9.75 9.99902 10.749 9 12 9ZM6.75 14.1562C4.56152 14.7686 3 15.8057 3 17.25C3 19.7109 7.52637 21 12 21C16.4736 21 21 19.7109 21 17.25C21 15.8057 19.4385 14.7686 17.25 14.1562V15.7266C18.6768 16.1865 19.5 16.7812 19.5 17.25C19.5 18.1465 16.5088 19.5 12 19.5C7.49121 19.5 4.5 18.1465 4.5 17.25C4.5 16.7812 5.32324 16.1865 6.75 15.7266V14.1562Z"
                                        fill="#707791" />
                                    </g>
                                  </svg>
                                  Street View
                                </a>
                              </li>
                              <li style="cursor: pointer" (click)="
                                  toggleShortcuts(shoppingCenter.Id, 'close')
                                ">
                                 <a class="target" (click)="
                                    openDeleteShoppingCenterModal(
                                      deleteSingleShoppingCenterModal,
                                      shoppingCenter.Id
                                    )
                                  ">
                                  <i class="fa-regular fa-trash-can" style="
                                      font-size: 18px;
                                      margin-top: 3px;
                                      width: 24px;
                                    "></i>
                                  Remove Shopping
                                </a>
                              </li>
                            </ul>
                            <i class="fa-solid fa-caret-right"></i>
                          </div>
                        </div>
                      </div>
                    </div>
                  </td>
                </tr>
              </ng-container>
            </tbody>
          </table>
        </div>
      </div>
      <div class="pt-2 d-flex justify-content-center align-items-center" style="height: 50vh"
        *ngIf="shoppingCenters?.length == 0">
        <p style="font-weight: 500">No data Shopping Center</p>
      </div>
    </ng-container>
    <div style="background-color: #fff" [ngClass]="{
        'd-none': currentView == 1 || currentView == 4,
        'col-md-8 col-sm-12 cards ': currentView == 2,
        'col-12': currentView == 3
      }" class="responsiveMain">
      <div class="row mt-2">
        <ng-container *ngIf="currentView != 2">
          <ng-container *ngFor="let shopping of shoppingCenters">
            <div style="cursor: pointer" class="card-window" [ngClass]="{
                'col-md-4 col-sm-4 col-12': currentView == 3,
                'col-12 col-sm-6 cards': currentView == 2
              }">
              <div style="background: white; min-height: 100%; border-radius: 20px;width: 100%;" class="cardResponsive">
                <a
                  [routerLink]="['/landing',shopping?.ShoppingCenter?.Places?.[0]?.Id || 0,shopping?.Id,BuyBoxId,OrgId]">
                  <div class="main-img">
                    <img src="{{ shopping.MainImage }}" [title]="shopping.CenterName"/>
                  </div>
                </a>
                <div class="content-wrap card-content card-content_view">
                  <!-- <div> -->
                    <div >
                      <div class="d-flex justify-content-between">
                        <a style="text-decoration: none"
                          [routerLink]="[ '/landing', shopping?.ShoppingCenter?.Places ? shopping?.ShoppingCenter?.Places?.[0]?.Id : 0,shopping.Id,BuyBoxId,OrgId]">
                          <div class="content-title" style="cursor: pointer">
                            {{
                              shopping.CenterName.length > 22
                                ? (shopping.CenterName | titlecase).slice(
                                    0,
                                    22
                                  ) + "..."
                                : (shopping.CenterName | titlecase)
                            }}
                          </div>
                        </a>

                        <div style="position: relative">
                          <button class="ellipsis_icont" (click)="toggleShortcutsCard(shopping.Id)">
                            <i class="fa-solid fa-ellipsis"></i>
                          </button>
                          <div class="shortcuts_iconCard" *ngIf="selectedIdCard === shopping.Id" >
                            <ul>
                              <li style="cursor: pointer">
                                <a class="target" [href]="'/emily/' + BuyBoxId + '/' + shopping.ShoppingCenter.ManagerOrganization[0].ID + '/' + shopping?.Id" target="_blank">
                                  <i class="fa-regular fa-envelope" style="font-size: 18px; margin-top: 3px; width: 24px;"></i>
                                  Emily
                                </a>
                              </li>
                              <li (click)="toggleShortcuts(shopping.Id, 'close')">
                                <a class="target"
                                  [routerLink]="['/landing',shopping?.ShoppingCenter?.Places?.[0]?.Id || 0,shopping?.Id,BuyBoxId,OrgId]">
                                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none"
                                    xmlns="http://www.w3.org/2000/svg">
                                    <path
                                      d="M6.70001 18.75H4.15002C2.31002 18.75 1.25 17.69 1.25 15.85V4.15002C1.25 2.31002 2.31002 1.25 4.15002 1.25H8.45001C10.29 1.25 11.35 2.31002 11.35 4.15002V6C11.35 6.41 11.01 6.75 10.6 6.75C10.19 6.75 9.84998 6.41 9.84998 6V4.15002C9.84998 3.13002 9.47001 2.75 8.45001 2.75H4.15002C3.13002 2.75 2.75 3.13002 2.75 4.15002V15.85C2.75 16.87 3.13002 17.25 4.15002 17.25H6.70001C7.11001 17.25 7.45001 17.59 7.45001 18C7.45001 18.41 7.11001 18.75 6.70001 18.75Z"
                                      fill="#707791" />
                                    <path
                                      d="M14.9602 22.75H9.12018C7.11018 22.75 5.9502 21.59 5.9502 19.58V8.41998C5.9502 6.40998 7.11018 5.25 9.12018 5.25H14.9602C16.9702 5.25 18.1202 6.40998 18.1202 8.41998V19.58C18.1202 21.59 16.9702 22.75 14.9602 22.75ZM9.12018 6.75C7.92018 6.75 7.4502 7.21998 7.4502 8.41998V19.58C7.4502 20.78 7.92018 21.25 9.12018 21.25H14.9602C16.1502 21.25 16.6202 20.78 16.6202 19.58V8.41998C16.6202 7.21998 16.1502 6.75 14.9602 6.75H9.12018Z"
                                      fill="#707791" />
                                    <path
                                      d="M19.8503 18.75H17.3704C16.9604 18.75 16.6204 18.41 16.6204 18C16.6204 17.59 16.9604 17.25 17.3704 17.25H19.8503C20.8703 17.25 21.2504 16.87 21.2504 15.85V4.15002C21.2504 3.13002 20.8703 2.75 19.8503 2.75H15.5504C14.5304 2.75 14.1504 3.13002 14.1504 4.15002V6C14.1504 6.41 13.8104 6.75 13.4004 6.75C12.9904 6.75 12.6504 6.41 12.6504 6V4.15002C12.6504 2.31002 13.7104 1.25 15.5504 1.25H19.8503C21.6903 1.25 22.7504 2.31002 22.7504 4.15002V15.85C22.7504 17.69 21.6903 18.75 19.8503 18.75Z"
                                      fill="#707791" />
                                    <path
                                      d="M14 11.75H10C9.59 11.75 9.25 11.41 9.25 11C9.25 10.59 9.59 10.25 10 10.25H14C14.41 10.25 14.75 10.59 14.75 11C14.75 11.41 14.41 11.75 14 11.75Z"
                                      fill="#707791" />
                                    <path
                                      d="M14 14.75H10C9.59 14.75 9.25 14.41 9.25 14C9.25 13.59 9.59 13.25 10 13.25H14C14.41 13.25 14.75 13.59 14.75 14C14.75 14.41 14.41 14.75 14 14.75Z"
                                      fill="#707791" />
                                    <path
                                      d="M12 22.75C11.59 22.75 11.25 22.41 11.25 22V19C11.25 18.59 11.59 18.25 12 18.25C12.41 18.25 12.75 18.59 12.75 19V22C12.75 22.41 12.41 22.75 12 22.75Z"
                                      fill="#707791" />
                                  </svg>
                                  View Details
                                </a>
                              </li>
                              <li (click)="toggleShortcuts(shopping.Id, 'close')">
                                <a class="target" (click)="
                                    openMapViewPlace(MapViewPlace, shopping)
                                  ">
                                  <i class="fa-solid fa-map-location-dot" style="
                                      font-size: 18px;
                                      margin-top: 3px;
                                      width: 24px;
                                    "></i>
                                  View location
                                </a>
                              </li>
                              <li (click)="toggleShortcuts(shopping.Id, 'close')">
                                <a class="target" (click)="
                                    openStreetViewPlace(
                                      StreetViewPlace,
                                      shopping
                                    )
                                  ">
                                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none"
                                    xmlns="http://www.w3.org/2000/svg">
                                    <g id="Street View">
                                      <path id="Vector"
                                        d="M12 3C10.3506 3 9 4.35059 9 6C9 6.83496 9.35742 7.58789 9.91406 8.13281C8.91504 8.80957 8.25 9.96094 8.25 11.25V14.7188L9.75 15.4688V18.75H14.25V15.4688L15.75 14.7188V11.25C15.75 9.96094 15.085 8.80957 14.0859 8.13281C14.6426 7.58789 15 6.83496 15 6C15 4.35059 13.6494 3 12 3ZM12 4.5C12.8379 4.5 13.5 5.16211 13.5 6C13.5 6.83789 12.8379 7.5 12 7.5C11.1621 7.5 10.5 6.83789 10.5 6C10.5 5.16211 11.1621 4.5 12 4.5ZM12 9C13.251 9 14.25 9.99902 14.25 11.25V13.7812L12.75 14.5312V17.25H11.25V14.5312L9.75 13.7812V11.25C9.75 9.99902 10.749 9 12 9ZM6.75 14.1562C4.56152 14.7686 3 15.8057 3 17.25C3 19.7109 7.52637 21 12 21C16.4736 21 21 19.7109 21 17.25C21 15.8057 19.4385 14.7686 17.25 14.1562V15.7266C18.6768 16.1865 19.5 16.7812 19.5 17.25C19.5 18.1465 16.5088 19.5 12 19.5C7.49121 19.5 4.5 18.1465 4.5 17.25C4.5 16.7812 5.32324 16.1865 6.75 15.7266V14.1562Z"
                                        fill="#707791" />
                                    </g>
                                  </svg>
                                  Street View
                                </a>
                              </li>
                              <li style="cursor: pointer" (click)="toggleShortcuts(shopping.Id, 'close')">
                                <!-- (click)="openDeleteShoppingCenterModal(deleteShoppingCenterModal,item.id)" -->
                                <a class="target" (click)="
                                    openDeleteShoppingCenterModal(
                                      deleteSingleShoppingCenterModal,
                                      shopping.Id
                                    )
                                  ">
                                  <i class="fa-regular fa-trash-can" style="
                                      font-size: 18px;
                                      margin-top: 3px;
                                      width: 24px;
                                    "></i>
                                  Remove Shopping
                                </a>
                              </li>
                            </ul>
                            <i class="fa-solid fa-caret-right"></i>
                          </div>
                        </div>
                      </div>
                      <div class="card-address" style="cursor: pointer"
                        (click)="openMapViewPlace(MapViewPlace, shopping)">
                        <span class="mb-5">
                          {{ shopping.CenterAddress }},
                          {{ shopping.CenterCity | titlecase }},
                          {{ shopping.CenterState }}
                        </span>
                      </div>
                      <div>
                        <p style="
                            font-size: 15px;
                            font-weight: 500;
                            color: #565656;
                          " [innerHTML]="getShoppingCenterUnitSize(shopping)"></p>
                      </div>
                      <div class="row">
                        <div *ngFor="
                            let item of shopping.ShoppingCenter?.BuyBoxPlaces
                          " class="col-12 d-flex flex-column spec">
                          <div class="d-flex flex-column">
                            <p class="nearset-category">
                              <b>{{ getNeareastCategoryName(item.CategoryId) }}
                              </b>
                            </p>
                            <p>
                              {{ item.RelationOrganizationName }}
                              <img class="logo ms-2" src="https://api.cherrypick.com/api/Organization/GetOrgImag?orgId={{
                                  item.RelationOrganizationId
                                }}" [title]="item.RelationOrganizationName" alt="" />
                            </p>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="col-md-12 spec" *ngIf="
                        shopping.ShoppingCenter?.ManagerOrganization &&
                        placesRepresentative != false
                      ">
                      <hr class="small-hr mt-2" />
                      <span class="managed-by">Leased by</span>
                      <div class="spec-head between">
                        <div>
                          <img class="logo" src="https://api.cherrypick.com/api/Organization/GetOrgImag?orgId={{
                              shopping.ShoppingCenter.ManagerOrganization[0].ID
                            }}" [title]="
                              shopping.ShoppingCenter.ManagerOrganization[0]
                                .Name
                            " alt="" />
                        </div>
                        <div style="width: 55%">
                          {{
                            shopping.ShoppingCenter.ManagerOrganization[0].Name
                          }}
                        </div>
                        <div>
                          <img style="cursor: pointer" class="ms-2" src="../../../assets/Images/Icons/eye.png"
                            alt="View Manager Details" [ngbPopover]="popoverContent"
                            popoverTitle="Organization Contact Info" triggers="click:outside" [placement]="'top'" />
                        </div>
                        <br />
                        <ng-template #popoverContent>
                          <div *ngFor="
                              let org of shopping.ShoppingCenter
                                .ManagerOrganization
                            " class="contact-container table-texttt">
                            <p class="text-bold m-0">
                              {{ org.Firstname | titlecase }}
                              {{ org.LastName | titlecase }}
                            </p>
                            <p class="m-0">{{ org.CellPhone }}</p>
                            <p class="m-0">{{ org.Email }}</p>
                            <hr *ngIf="
                                !isLast(
                                  org,
                                  shoppingCenter.ShoppingCenter
                                    .ManagerOrganization
                                )
                              " />
                          </div>
                        </ng-template>
                      </div>
                    </div>
                  <!-- </div> -->

                </div>
              </div>
            </div>
          </ng-container>
          <ng-container *ngFor="let place of standAlone">
            <div class="card-window" (mouseenter)="onMouseEnter(place)"
              [ngClass]="{ 'col-md-3 col-sm-4 col-12': currentView == 3 }">
              <a [routerLink]="['/landing', place.Id, 0, BuyBoxId, OrgId]">
                <div class="main-img">
                  <img src="{{ place.MainImage }}" />
                </div>
              </a>
              <div class="content-wrap card-content2">
                <div>
                  <div>
                    <div class="card-address" style="cursor: pointer" (click)="openMapViewPlace(MapViewPlace, place)">
                      <span class="mb-5">
                        {{ place.Address }}, {{ place.City | titlecase }},
                        {{ place.State }}
                      </span>
                    </div>
                  </div>

                  <div *ngIf="place.BuildingSizeSf">
                    <p style="font-size: 15px; font-weight: 500; color: #565656">
                      {{ place.BuildingSizeSf | number }} SF
                    </p>
                  </div>

                  <div *ngIf="place.ForLeasePrice">
                    <p class="spec-content" [innerHTML]="
                        getStandAloneLeasePrice(
                          place.ForLeasePrice,
                          place.BuildingSizeSf
                        )
                      "></p>
                  </div>
                </div>

                <div *ngIf="place.Place">
                  <div *ngFor="let item of place.Place?.BuyBoxPlaces"
                    class="d-flex align-items-center justify-content-centermb-2">
                    <!-- Image -->
                    <img class="logo" src="https://api.cherrypick.com/api/Organization/GetOrgImag?orgId={{
                        item.RelationOrganizationId
                      }}" [title]="item.RelationOrganizationName" alt="" />
                    <p class="spec-head me-2 mb-0">
                      {{ getNeareastCategoryName(item.CategoryId) }}
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </ng-container>
        </ng-container>
        <ng-container *ngIf="currentView == 2">
          <div class="p-3 d-flex justify-content-between">
            <p style="font-weight: 500" class="m-0">
              {{ cardsSideList.length }} places within map area
            </p>
            <div class="gap-2 d-flex" *ngIf="showbackIds.length > 0">
              <p class="Button_delete" (click)="ArrOfDelete(deleteShoppingCenterModal)">
                Delete
              </p>
              <p class="Button_cancel" (click)="CancelDelete()">
                Cancel
              </p>
            </div>
          </div>
          <ng-container *ngFor="let place of cardsSideList">
            <div class="card-window" style="cursor: pointer" (mouseenter)="onMouseHighlight(place)"
              (mouseleave)="onMouseLeaveHighlight(place)" [ngClass]="{ 'col-md-6 col-sm-12': currentView == 2 }">
              <div class="card-window-back w-100">
                <a *ngIf="place.CenterCity"
                  [routerLink]="[ '/landing', place.ShoppingCenter?.Places ? place.ShoppingCenter.Places?.[0].Id: 0,place.Id,BuyBoxId,OrgId]">
                  <div class="main-img">
                    <img *ngIf="place.MainImage" src="{{ place.MainImage }}" [title]="place.CenterName"/>
                  </div>
                </a>
                <a *ngIf="!place.CenterCity" [routerLink]="['/landing', place.Id, 0, BuyBoxId, OrgId]">
                  <div class="main-img">
                    <img *ngIf="place.MainImage" src="{{ place.MainImage }}" />
                  </div>
                </a>
                <div class="content-wrap card-sideview" style="position: relative; justify-content: space-between">
                  <div>
                    <div *ngIf="place.CenterCity">
                      <div class="d-flex justify-content-between">
                        <a
                          [routerLink]="[ '/landing', place.ShoppingCenter?.Places ? place.ShoppingCenter.Places?.[0].Id: 0,place.Id,BuyBoxId,OrgId]">
                          <p class="content-title" style="cursor: pointer">
                            {{
                              place.CenterName.length > 22
                                ? (place.CenterName | titlecase).slice(0, 22) +
                                  "..."
                                : (place.CenterName | titlecase)
                            }}
                          </p>
                        </a>
  
                        <div style="position: relative">
                          <button class="ellipsis_icont" (click)="toggleShortcutsCard(place.Id)">
                            <i class="fa-solid fa-ellipsis"></i>
                          </button>
                          <div class="shortcuts_iconCard" *ngIf="selectedIdCard === place.Id">
                            <ul>
                              <li style="cursor: pointer">
  
                                <a class="target" [href]="'/emily/' + BuyBoxId + '/' + place.ShoppingCenter.ManagerOrganization[0].ID + '/' + place?.Id" target="_blank">
                                  <i class="fa-regular fa-envelope" style="font-size: 18px; margin-top: 3px; width: 24px;"></i>
                                  Emily
                                </a>
                              </li>
                              <li (click)="toggleShortcuts(place.Id, 'close')">
                                <a class="target"
                                  [routerLink]="['/landing',place?.ShoppingCenter?.Places?.[0]?.Id || 0,place?.Id,BuyBoxId,OrgId]">
                                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none"
                                    xmlns="http://www.w3.org/2000/svg">
                                    <path
                                      d="M6.70001 18.75H4.15002C2.31002 18.75 1.25 17.69 1.25 15.85V4.15002C1.25 2.31002 2.31002 1.25 4.15002 1.25H8.45001C10.29 1.25 11.35 2.31002 11.35 4.15002V6C11.35 6.41 11.01 6.75 10.6 6.75C10.19 6.75 9.84998 6.41 9.84998 6V4.15002C9.84998 3.13002 9.47001 2.75 8.45001 2.75H4.15002C3.13002 2.75 2.75 3.13002 2.75 4.15002V15.85C2.75 16.87 3.13002 17.25 4.15002 17.25H6.70001C7.11001 17.25 7.45001 17.59 7.45001 18C7.45001 18.41 7.11001 18.75 6.70001 18.75Z"
                                      fill="#707791" />
                                    <path
                                      d="M14.9602 22.75H9.12018C7.11018 22.75 5.9502 21.59 5.9502 19.58V8.41998C5.9502 6.40998 7.11018 5.25 9.12018 5.25H14.9602C16.9702 5.25 18.1202 6.40998 18.1202 8.41998V19.58C18.1202 21.59 16.9702 22.75 14.9602 22.75ZM9.12018 6.75C7.92018 6.75 7.4502 7.21998 7.4502 8.41998V19.58C7.4502 20.78 7.92018 21.25 9.12018 21.25H14.9602C16.1502 21.25 16.6202 20.78 16.6202 19.58V8.41998C16.6202 7.21998 16.1502 6.75 14.9602 6.75H9.12018Z"
                                      fill="#707791" />
                                    <path
                                      d="M19.8503 18.75H17.3704C16.9604 18.75 16.6204 18.41 16.6204 18C16.6204 17.59 16.9604 17.25 17.3704 17.25H19.8503C20.8703 17.25 21.2504 16.87 21.2504 15.85V4.15002C21.2504 3.13002 20.8703 2.75 19.8503 2.75H15.5504C14.5304 2.75 14.1504 3.13002 14.1504 4.15002V6C14.1504 6.41 13.8104 6.75 13.4004 6.75C12.9904 6.75 12.6504 6.41 12.6504 6V4.15002C12.6504 2.31002 13.7104 1.25 15.5504 1.25H19.8503C21.6903 1.25 22.7504 2.31002 22.7504 4.15002V15.85C22.7504 17.69 21.6903 18.75 19.8503 18.75Z"
                                      fill="#707791" />
                                    <path
                                      d="M14 11.75H10C9.59 11.75 9.25 11.41 9.25 11C9.25 10.59 9.59 10.25 10 10.25H14C14.41 10.25 14.75 10.59 14.75 11C14.75 11.41 14.41 11.75 14 11.75Z"
                                      fill="#707791" />
                                    <path
                                      d="M14 14.75H10C9.59 14.75 9.25 14.41 9.25 14C9.25 13.59 9.59 13.25 10 13.25H14C14.41 13.25 14.75 13.59 14.75 14C14.75 14.41 14.41 14.75 14 14.75Z"
                                      fill="#707791" />
                                    <path
                                      d="M12 22.75C11.59 22.75 11.25 22.41 11.25 22V19C11.25 18.59 11.59 18.25 12 18.25C12.41 18.25 12.75 18.59 12.75 19V22C12.75 22.41 12.41 22.75 12 22.75Z"
                                      fill="#707791" />
                                  </svg>
                                  View Details
                                </a>
                              </li>
                              <li (click)="toggleShortcuts(place.Id, 'close')">
                                <a class="target" (click)="openMapViewPlace(MapViewPlace, place)">
                                  <i class="fa-solid fa-map-location-dot" style="
                                      font-size: 18px;
                                      margin-top: 3px;
                                      width: 24px;
                                    "></i>
                                  View location
                                </a>
                              </li>
                              <li (click)="toggleShortcuts(place.Id, 'close')">
                                <a class="target" (click)="
                                    openStreetViewPlace(StreetViewPlace, place)
                                  ">
                                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none"
                                    xmlns="http://www.w3.org/2000/svg">
                                    <g id="Street View">
                                      <path id="Vector"
                                        d="M12 3C10.3506 3 9 4.35059 9 6C9 6.83496 9.35742 7.58789 9.91406 8.13281C8.91504 8.80957 8.25 9.96094 8.25 11.25V14.7188L9.75 15.4688V18.75H14.25V15.4688L15.75 14.7188V11.25C15.75 9.96094 15.085 8.80957 14.0859 8.13281C14.6426 7.58789 15 6.83496 15 6C15 4.35059 13.6494 3 12 3ZM12 4.5C12.8379 4.5 13.5 5.16211 13.5 6C13.5 6.83789 12.8379 7.5 12 7.5C11.1621 7.5 10.5 6.83789 10.5 6C10.5 5.16211 11.1621 4.5 12 4.5ZM12 9C13.251 9 14.25 9.99902 14.25 11.25V13.7812L12.75 14.5312V17.25H11.25V14.5312L9.75 13.7812V11.25C9.75 9.99902 10.749 9 12 9ZM6.75 14.1562C4.56152 14.7686 3 15.8057 3 17.25C3 19.7109 7.52637 21 12 21C16.4736 21 21 19.7109 21 17.25C21 15.8057 19.4385 14.7686 17.25 14.1562V15.7266C18.6768 16.1865 19.5 16.7812 19.5 17.25C19.5 18.1465 16.5088 19.5 12 19.5C7.49121 19.5 4.5 18.1465 4.5 17.25C4.5 16.7812 5.32324 16.1865 6.75 15.7266V14.1562Z"
                                        fill="#707791" />
                                    </g>
                                  </svg>
                                  Street View
                                </a>
                              </li>
                              <li style="cursor: pointer" (click)="toggleShortcuts(place.Id, 'close')">
                                <a class="target" (click)="deleteShopping(place.Id)">
                                  <i class="fa-regular fa-trash-can" style="
                                      font-size: 18px;
                                      margin-top: 3px;
                                      width: 24px;
                                    "></i>
                                  Remove Shopping
                                </a>
                              </li>
                            </ul>
                            <i class="fa-solid fa-caret-right"></i>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div *ngIf="place.CenterAddress" class="card-address" style="cursor: pointer"
                      (click)="openMapViewPlace(MapViewPlace, place)">
                      <span>
                        {{ place.CenterAddress }},
                        {{ place.CenterCity | titlecase }},
                        {{ place.CenterState }}
                      </span>
                    </div>
                    <div *ngIf="place.Address" class="card-address" style="cursor: pointer"
                      (click)="openMapViewPlace(MapViewPlace, place)">
                      <p>
                        {{ place.Address }}, {{ place.City | titlecase }},
                        {{ place.State }}
                      </p>
                    </div>
                    <div *ngIf="place.CenterAddress">
                      <p style="font-size: 15px; font-weight: 500; color: #565656"
                        [innerHTML]="getShoppingCenterUnitSize(place)"></p>
                    </div>
                    <div *ngIf="!place.CenterAddress">
                      <p style="font-size: 15px; font-weight: 500; color: #565656">
                        <span>
                          Unit Size: {{ place.BuildingSizeSf | number }} SF
                        </span>
                      </p>
                      <p style="font-size: 15px; font-weight: 500; color: #565656">
                        <span [innerHTML]="
                            getStandAloneLeasePrice(
                              place.ForLeasePrice,
                              place.BuildingSizeSf
                            )
                          "></span>
                      </p>
                    </div>
                    <div class="row" *ngIf="place.ShoppingCenter?.BuyBoxPlaces || place.Place">
                      <div *ngFor="
                          let item of place.ShoppingCenter
                            ? place.ShoppingCenter?.BuyBoxPlaces
                            : place.Place?.BuyBoxPlaces
                        " class="col-12 d-flex flex-column spec">
                        <div class="d-flex flex-column">
                          <p class="nearset-category">
                            <b>{{ getNeareastCategoryName(item.CategoryId) }} </b>
                          </p>
                          <p>
                            {{ item.RelationOrganizationName }}
                            <img class="logo ms-2" src="https://api.cherrypick.com/api/Organization/GetOrgImag?orgId={{
                                item.RelationOrganizationId
                              }}" [title]="item.RelationOrganizationName" alt="" />
                          </p>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-12 spec" *ngIf="
                      place.ShoppingCenter?.ManagerOrganization &&
                      placesRepresentative != false
                    ">
                    <span class="managed-by">Leased by</span>
                    <div class="spec-head between">
                      <div>
                        <img class="logo" src="https://api.cherrypick.com/api/Organization/GetOrgImag?orgId={{
                            place.ShoppingCenter.ManagerOrganization[0].ID
                          }}" [title]="
                            place.ShoppingCenter.ManagerOrganization[0].Name
                          " alt="" />
                      </div>
                      <div>
                        {{ place.ShoppingCenter.ManagerOrganization[0].Name }}
                      </div>
                      <div>
                        <img style="cursor: pointer" class="ms-2" src="../../../assets/Images/Icons/eye.png"
                          alt="View Manager Details" [ngbPopover]="popoverContent"
                          popoverTitle="Organization Contact Info" [placement]="'top'" />
                      </div>
                      <br />
                      <ng-template #popoverContent>
                        <div *ngFor="
                            let org of place.ShoppingCenter.ManagerOrganization
                          " class="contact-container table-texttt">
                          <p class="text-bold m-0">
                            {{ org.Firstname | titlecase }}
                            {{ org.LastName | titlecase }}
                          </p>
                          <p class="m-0">{{ org.CellPhone }}</p>
                          <p class="m-0">{{ org.Email }}</p>
                          <hr *ngIf="
                              !isLast(
                                org,
                                shoppingCenter.ShoppingCenter.ManagerOrganization
                              )
                            " />
                        </div>
                      </ng-template>
                    </div>
                  </div>
                </div>
              </div>
              <div class="card-window-back2" [ngClass]="{'show': showbackIds.includes(place.Id)}">
                <i class="fa-solid fa-trash" (click)="CancelOneDelete(place.Id)"></i>
              </div>
            </div>
          </ng-container>
        </ng-container>
      </div>
    </div>
    <div class="p-0" [ngClass]="{
        'd-none': currentView == 4 || currentView == 3,
        'col-12': currentView == 1,
        'col-12 col-sm-4': currentView == 2
      }">
      <div id="map" class="custom-map"></div>
    </div>
  </div>
</div>

<ng-template #MapViewPlace let-modal>
  <div id="mappopup" style="height: 700px" *ngIf="mapViewOnePlacex"></div>
</ng-template>

<ng-template #ShareLink let-modal>
  <div class="d-flex p-3 m-3 align-items-center" style="border: 1px solid #ccc; border-radius: 10px">
    <p>{{ shareLink }}</p>
    <i style="cursor: pointer" class="fa-solid fa-copy ms-3" (click)="copyLink(shareLink)"></i>
  </div>
</ng-template>

<ng-template #StreetViewPlace let-modal>
  <div *ngIf="General.modalObject.StreetViewURL">
    <iframe [src]="sanitizedUrl" height="450" style="border: 0; width: 100%; height: 700px" allowfullscreen="">
    </iframe>
  </div>
  <div id="street-view" style="height: 700px" *ngIf="!General.modalObject.StreetViewURL"></div>
</ng-template>

<!-- delete-shopping-center-modal -->
<ng-template #deleteShoppingCenterModal let-modal>
  <div class="modal-body-general p-4 rounded" style="
      background-color: #f8f9fa;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    ">
    <h2 class="text-center mb-4" style="font-size: 1.5rem; font-weight: bold; color: var(--app-color)">
      Remove Shopping Center
    </h2>
    <p class="text-center" style="font-size: 1rem; color: #6c757d">
      Are you sure you want to remove this Shopping Center?
    </p>

    <div class="d-flex justify-content-end mt-4">
      <button type="button" class="btn btn-secondary me-2 px-4 py-2" (click)="modal.dismiss('Cancel click')"
        style="border-radius: 4px">
        Cancel
      </button>
      <button type="button" class="btn btn-danger px-4 py-2" (click)="confirmDeleteShoppingCenter(modal)"
        style="border-radius: 4px">
        Remove
      </button>
    </div>
  </div>
</ng-template>


<!-- delete-shopping-center-modal -->
<ng-template #deleteSingleShoppingCenterModal let-modal>
  <div class="modal-body-general p-4 rounded" style="
      background-color: #f8f9fa;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    ">
    <h2 class="text-center mb-4" style="font-size: 1.5rem; font-weight: bold; color: var(--app-color)">
      Remove Shopping Center
    </h2>
    <p class="text-center" style="font-size: 1rem; color: #6c757d">
      Are you sure you want to remove this Shopping Center?
    </p>

    <div class="d-flex justify-content-end mt-4">
      <button type="button" class="btn btn-secondary me-2 px-4 py-2" (click)="modal.dismiss('Cancel click')"
        style="border-radius: 4px">
        Cancel
      </button>
      <button type="button" class="btn btn-danger px-4 py-2" (click)="deleteShCenter()" style="border-radius: 4px">
        Remove
      </button>
    </div>
  </div>
</ng-template>
