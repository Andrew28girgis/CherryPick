<div class="page-layout p-3">
  <div class="h-100 row m-0">
    <!-- kanbans sidebar -->
    <div class="col-md-2 col-12 p-0 h-100">
      <div class="h-100 kanbans-container">
        <ul>
          <ng-container *ngFor="let kanban of userKanbans">
            <li
              class="kanban-item"
              [ngClass]="{ 'kanban-active-item': activeKanbanId == kanban.Id }"
              (click)="GetKanbanDetails(kanban)"
            >
              {{ kanban.kanbanName }}
            </li>
          </ng-container>
        </ul>
      </div>
    </div>

    <div class="col-md-10 col-12 p-0 h-100">
      <div class="h-100 table-container">
        <table class="align-middle">
          <thead>
            <tr>
              <th *ngFor="let stage of kanbanList[0]?.kanbanStages">
                <div class="stage-container">
                  <h2
                    class="stage-name"
                    [ngClass]="{ 'green-text': stage.isQualified }"
                  >
                    {{ stage.stageName }}
                  </h2>
                </div>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td *ngFor="let stage of kanbanList[0]?.kanbanStages">
                <div class="card">
                  <div
                    cdkDropList
                    [id]="stage.Id.toString()"
                    [cdkDropListData]="stage.kanbanOrganizations || []"
                    [cdkDropListConnectedTo]="
                      getConnectedLists(stage.Id.toString())
                    "
                    class="card-body"
                    (cdkDropListDropped)="drop($event)"
                  >
                    <ng-container *ngFor="let org of stage.kanbanOrganizations">
                      <ng-container *ngIf="org.Organization?.[0]?.Name">
                        <tr>
                          <div class="kanban-card" cdkDrag>
                            <div
                              class="d-flex justify-content-between w-100 align-items-center"
                            >
                              <div class="d-flex align-items-center gap-2">
                                <img
                                  [src]="org.Organization?.[0]?.LogoURL "
                                  alt="Logo"
                                  class="logo"
                                />
                                <span
                                  class="kanban-title"
                                  [title]="(org.Organization?.[0]?.Name?.length > 20 ? org.Organization?.[0]?.Name : '') || ''"
                                  [class.truncate]="org.Organization?.[0]?.Name?.length > 20"
                                >
                                  {{ org.Organization?.[0]?.Name || '' }}
                                </span>
                              </div>
                            </div>
                          </div>
                        </tr>
                      </ng-container>
                    </ng-container>
                  </div>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
