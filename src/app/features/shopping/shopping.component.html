<div (click)="onDocumentsClick()">
  <!-- Header Section -->
  <div class="title-div">
    <h2 class="title">Sites Vault</h2>
  </div>
  <div class="header-container d-flex flex-row justify-content-between">
    <div
      class="search-filter d-flex flex-row"
      style="gap: 12px; width: 88% !important"
    >
      <div class="search-section">
        <div class="search-container">
          <div class="icon">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="20"
              height="20"
              viewBox="0 0 20 20"
              fill="none"
            >
              <path
                d="M9.58366 18.1248C4.87533 18.1248 1.04199 14.2915 1.04199 9.58317C1.04199 4.87484 4.87533 1.0415 9.58366 1.0415C14.292 1.0415 18.1253 4.87484 18.1253 9.58317C18.1253 14.2915 14.292 18.1248 9.58366 18.1248ZM9.58366 2.2915C5.55866 2.2915 2.29199 5.5665 2.29199 9.58317C2.29199 13.5998 5.55866 16.8748 9.58366 16.8748C13.6087 16.8748 16.8753 13.5998 16.8753 9.58317C16.8753 5.5665 13.6087 2.2915 9.58366 2.2915Z"
                fill="#704E73"
              />
              <path
                d="M18.3335 18.9585C18.1752 18.9585 18.0169 18.9002 17.8919 18.7752L16.2252 17.1085C15.9835 16.8669 15.9835 16.4669 16.2252 16.2252C16.4669 15.9835 16.8669 15.9835 17.1085 16.2252L18.7752 17.8919C19.0169 18.1335 19.0169 18.5335 18.7752 18.7752C18.6502 18.9002 18.4919 18.9585 18.3335 18.9585Z"
                fill="#704E73"
              />
            </svg>
          </div>
          <input
            type="text"
            class="search-input"
            placeholder="Search..."
            [(ngModel)]="searchTerm"
            (input)="onSearch()"
            (click)="$event.stopPropagation()"
          />
        </div>
      </div>
      <div class="actions-section">
        <!-- Filter Dropdown -->
        <div class="dropdown" ngbDropdown>
          <button class="filter-btn" ngbDropdownToggle>
            <svg
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <polygon
                points="22,3 2,3 10,12.46 10,19 14,21 14,12.46"
              ></polygon>
            </svg>
            Filter
          </button>
          <div class="dropdown-menu" ngbDropdownMenu>
            <!-- <h3 class="dropdown-header">Share Status</h3>
            <div class="radio-group px-3">
              <div class="form-check">
                <input
                  type="radio"
                  class="form-check-input"
                  id="all"
                  name="share"
                  value="all"
                  [(ngModel)]="shareFilter"
                  (change)="onFilterChange()"
                />
                <label class="form-check-label" for="all">All</label>
              </div>
              <div class="form-check">
                <input
                  type="radio"
                  class="form-check-input"
                  id="shared"
                  name="share"
                  value="shared"
                  [(ngModel)]="shareFilter"
                  (change)="onFilterChange()"
                />
                <label class="form-check-label" for="shared">Shared</label>
              </div>
              <div class="form-check">
                <input
                  type="radio"
                  class="form-check-input"
                  id="not-shared"
                  name="share"
                  value="not-shared"
                  [(ngModel)]="shareFilter"
                  (change)="onFilterChange()"
                />
                <label class="form-check-label" for="not-shared"
                  >Not Shared</label
                >
              </div>
            </div> -->

            <!-- <h3 class="dropdown-header mt-3">Price</h3>
            <div class="px-3 mb-3">
              <div class="input-group input-group-sm">
                <input
                  type="number"
                  class="form-control"
                  placeholder="From"
                  [(ngModel)]="priceFrom"
                  (input)="onFilterChange()"
                />
                <input
                  type="number"
                  class="form-control"
                  placeholder="To"
                  [(ngModel)]="priceTo"
                  (input)="onFilterChange()"
                />
              </div>
            </div> -->

            <!-- <h3 class="dropdown-header">Building Size (SF)</h3>
            <div class="px-3 mb-3">
              <div class="input-group input-group-sm">
                <input
                  type="number"
                  class="form-control"
                  placeholder="From"
                  [(ngModel)]="sizeFrom"
                  (input)="onFilterChange()"
                />
                <input
                  type="number"
                  class="form-control"
                  placeholder="To"
                  [(ngModel)]="sizeTo"
                  (input)="onFilterChange()"
                />
              </div>
            </div> -->

            <h3 class="dropdown-header"  *ngIf="availableStates.length">State</h3>
            <div class="px-3 mb-3" *ngIf="availableStates.length">
              <select class="form-select" [(ngModel)]="stateFilter" (change)="onFilterChange()">
                <option value="all">All States</option>
                <option *ngFor="let state of availableStates" [value]="state">
                  {{state}}
                </option>
              </select>
            </div>

            <h3 class="dropdown-header" *ngIf="availableTypes.length">Property Type</h3>
            <div class="px-3 mb-3"  *ngIf="availableTypes.length">
              <select class="form-select" [(ngModel)]="typeFilter" (change)="onFilterChange()">
                <option value="all">All Types</option>
                <option *ngFor="let type of availableTypes" [value]="type">
                  {{type}}
                </option>
              </select>
            </div>

            <h3 class="dropdown-header"  *ngIf="availableLeaseTypes.length" >Lease Type</h3>
            <div class="px-3 mb-3"  *ngIf="availableLeaseTypes.length" >
              <select class="form-select" [(ngModel)]="leaseTypeFilter" (change)="onFilterChange()">
                <option value="all">All Lease Types</option>
                <option *ngFor="let leaseType of availableLeaseTypes" [value]="leaseType">
                  {{leaseType}}
                </option>
              </select>
            </div>
          </div>
        </div>

        <!-- Sort Dropdown -->
        <!-- <div class="dropdown" ngbDropdown>
          <button class="sort-btn" ngbDropdownToggle>
            <svg
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <line x1="3" y1="6" x2="21" y2="6"></line>
              <line x1="7" y1="12" x2="17" y2="12"></line>
              <line x1="10" y1="18" x2="14" y2="18"></line>
            </svg>
            Sort
          </button>
          <div class="dropdown-menu" ngbDropdownMenu>
            <div class="px-3">
              <div class="form-check" *ngFor="let option of sortOptions">
                <input
                  type="radio"
                  class="form-check-input"
                  [id]="option.value"
                  name="sort"
                  [value]="option.value"
                  [(ngModel)]="sortBy"
                  (change)="onSortChange()"
                />
                <label class="form-check-label" [for]="option.value">{{
                  option.label
                }}</label>
              </div>
            </div>
          </div>
        </div> -->
      </div>
    </div>

    <!-- ===================== Upload Button ===================== -->
    <div class="add-new-actions">
      <button class="g-button" (click)="openUploadModal(uploadModal)">
        <svg
          class="btn-icon"
          viewBox="0 0 24 24"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z"
            stroke="currentColor"
            stroke-width="2"
          />
          <path
            d="M12 8V16"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
          />
          <path
            d="M8 12H16"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
          />
        </svg>
        <span class="btn-text">Upload OM Files</span>
      </button>
    </div>

    <!-- ===================== Upload Modal ===================== -->
    <ng-template #uploadModal let-modal>
      <div class="modal-header">
        <h5 class="modal-title">Upload OM PDF</h5>
        <button
          type="button"
          class="btn-close"
          aria-label="Close"
          (click)="modal.dismiss()"
        ></button>
      </div>

      <div class="modal-body">
        <ngx-file-drop
          dropZoneLabel="Drop files here or click to browse"
          (onFileDrop)="dropped($event)"
          (onFileOver)="fileOver($event)"
          (onFileLeave)="fileLeave($event)"
          [accept]="'application/pdf,.pdf'"
          [multiple]="false"
          class="file-drop-zone"
        >
          <ng-template
            ngx-file-drop-content-tmp
            let-openFileSelector="openFileSelector"
          >
            <div
              class="file-drop-content"
              (click)="openFileSelector(); $event.stopPropagation()"
            >
              <svg
                class="upload-icon"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M21 15V19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V15"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
                <path
                  d="M17 8L12 3L7 8"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
                <path
                  d="M12 3V15"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
              <p class="mb-0">
                Drop PDF files here or
                <button
                  type="button"
                  class="browse-btn"
                  (click)="openFileSelector(); $event.stopPropagation()"
                >
                  browse
                </button>
              </p>
              <small>Only PDF files are accepted</small>
            </div>
          </ng-template>
        </ngx-file-drop>
      </div>

      <div class="modal-footer">
        <button class="btn btn-secondary" (click)="modal.close()">Close</button>
      </div>
    </ng-template>
  </div>

  <!-- Loading State -->
  <div class="main-inner">
    <div class="loading-state" *ngIf="isLoading">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
      <p>Loading shopping centers...</p>
    </div>

    <!-- Skeleton Loading State -->
    <div class="skeleton-grid" *ngIf="isLoading">
      <div class="skeleton-card" *ngFor="let i of [1, 2, 3, 4, 5, 6, 7, 8, 9]">
        <div class="skeleton-image">
          <div class="skeleton-overlay">
            <div class="skeleton-badge"></div>
            <div class="skeleton-menu"></div>
          </div>
        </div>
        <div class="skeleton-content">
          <div class="skeleton-title"></div>
          <div class="skeleton-address"></div>
          <div class="skeleton-details">
            <div class="skeleton-price"></div>
            <div class="skeleton-price-line">
              <div class="skeleton-price-sf"></div>
              <div class="skeleton-unit-size"></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <!-- Filterations Section -->
      <!-- <div class="col-3">
        <div class="filters-panel">
          <div class="filters-header">
            <div class="filters-title">Filter</div>
            <div class="filters-title clear-filterr">Clear Filters</div>
          </div>

          <div class="filter-block">
            <div class="filter-block-title">Project Status</div>
            <label class="filter-check">
              <input type="checkbox" />
              <span>On Track</span>
            </label>
            <label class="filter-check">
              <input type="checkbox" />
              <span>At Risk</span>
            </label>
            <label class="filter-check">
              <input type="checkbox" />
              <span>Off Track</span>
            </label>
          </div>

          <div class="filter-block">
            <div class="filter-block-title">Project Type</div>
            <label class="filter-check">
              <input type="checkbox" />
              <span>QSR</span>
            </label>
            <label class="filter-check">
              <input type="checkbox" />
              <span>Medical</span>
            </label>
            <label class="filter-check">
              <input type="checkbox" />
              <span>Industrial</span>
            </label>
            <label class="filter-check">
              <input type="checkbox" />
              <span>Retail</span>
            </label>
          </div>

          <div class="filter-block">
            <div class="filter-block-title">Client</div>
            <input
              type="text"
              class="filter-input"
              placeholder="Client Name ..."
            />
            <label class="filter-check">
              <input type="checkbox" />
              <span>Osmow's</span>
            </label>
            <label class="filter-check">
              <input type="checkbox" />
              <span>Scooters</span>
            </label>
            <label class="filter-check">
              <input type="checkbox" />
              <span>Buffalo Burger</span>
            </label>
          </div>

          <div class="filter-block">
            <div class="filter-block-title">Broker</div>
            <input
              type="text"
              class="filter-input"
              placeholder="Broker Name ..."
            />
            <label class="filter-check">
              <input type="checkbox" />
              <span>Ibrahim Mohamed</span>
            </label>
            <label class="filter-check">
              <input type="checkbox" />
              <span>Sarah Selim</span>
            </label>
            <label class="filter-check">
              <input type="checkbox" />
              <span>Omar Khaled</span>
            </label>
          </div>

          <div class="filters-actions">
            <button type="button" class="btn-base btn-cancel">Clear</button>
            <button type="button" class="btn-base btn-filter">Filter</button>
          </div>
        </div>
      </div> -->
      <div class="col-12">
        <!-- Shopping Centers Grid -->
        <div
          class="centers-grid"
          *ngIf="!isLoading && viewMode === 'grid' && !isLoading"
        >
          <div
            class="center-card"
            *ngFor="let center of filteredCenters; trackBy: trackByCenterId"
          >
            <div
              class="card-click-area"
              [class.click-disabled]="openMenuId === center.scId"
              [routerLink]="['/landing', 0, center?.scId, center.campaignId]"
            >
              <div class="image-container">
                <img
                  loading="lazy"
                  [src]="center.mainImage || 'assets/Images/placeholder.png'"
                  [alt]="center.centerName"
                  class="center-image"
                  (error)="center.mainImage = 'assets/Images/placeholder.png'"
                />
                <div
                  (click)="
                    openCampaignModal(campaignModal, center);
                    $event.stopPropagation()
                  "
                  class="add-badge"
                  title="Add Campaign"
                >
                  +
                </div>
                <button
                  class="add-badge reload"
                  [ngClass]="{ rotate: rotatingKeys[center.scId] > 0 }"
                  (click)="
                    InsertAutomation(center.scId, 1); $event.stopPropagation()
                  "
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="none"
                  >
                    <path
                      d="M12.0001 22.75C6.80008 22.75 2.58008 18.52 2.58008 13.33C2.58008 8.13999 6.80008 3.89999 12.0001 3.89999C13.0701 3.89999 14.1101 4.04999 15.1101 4.35999C15.5101 4.47999 15.7301 4.89999 15.6101 5.29999C15.4901 5.69999 15.0701 5.91999 14.6701 5.79999C13.8201 5.53999 12.9201 5.39999 12.0001 5.39999C7.63008 5.39999 4.08008 8.94999 4.08008 13.32C4.08008 17.69 7.63008 21.24 12.0001 21.24C16.3701 21.24 19.9201 17.69 19.9201 13.32C19.9201 11.74 19.4601 10.22 18.5901 8.91999C18.3601 8.57999 18.4501 8.10999 18.8001 7.87999C19.1401 7.64999 19.6101 7.73999 19.8401 8.08999C20.8801 9.63999 21.4301 11.45 21.4301 13.33C21.4201 18.52 17.2001 22.75 12.0001 22.75Z"
                      fill="#704E73"
                    />
                    <path
                      d="M16.1304 6.06999C15.9204 6.06999 15.7104 5.97999 15.5604 5.80999L12.6704 2.49C12.4004 2.18 12.4304 1.69999 12.7404 1.42999C13.0504 1.15999 13.5304 1.18999 13.8004 1.49999L16.6904 4.82C16.9604 5.13 16.9304 5.60999 16.6204 5.87999C16.4904 6.00999 16.3104 6.06999 16.1304 6.06999Z"
                      fill="#704E73"
                    />
                    <path
                      d="M12.7602 8.52999C12.5302 8.52999 12.3002 8.41999 12.1502 8.21999C11.9102 7.88999 11.9802 7.41999 12.3102 7.16999L15.6802 4.70999C16.0102 4.45999 16.4802 4.53999 16.7302 4.86999C16.9802 5.19999 16.9002 5.66999 16.5702 5.91999L13.2002 8.38999C13.0702 8.48999 12.9202 8.52999 12.7602 8.52999Z"
                      fill="#704E73"
                    />
                  </svg>
                </button>
                <div
                  *ngIf="center.docsLink"
                  class="add-badge docs"
                  (click)="$event.stopPropagation()"
                >
                  <a
                    class="info-value text-dark"
                    [href]="center.docsLink"
                    target="_blank"
                  >
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                      <path
                        d="M14 2H6C5.46957 2 4.96086 2.21071 4.58579 2.58579C4.21071 2.96086 4 3.46957 4 4V20C4 20.5304 4.21071 21.0391 4.58579 21.4142C4.96086 21.7893 5.46957 22 6 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V8L14 2Z"
                        stroke="currentColor"
                        stroke-width="2"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                      />
                    </svg>
                  </a>
                </div>

                <div
                  (click)="$event.stopPropagation()"
                  class="date score"
                  *ngIf="center.lastUpdateDate"
                >
                  {{ center.lastUpdateDate | date }}
                  <span *ngIf="center.source">
                    <span class="source">By </span
                    >{{ getSourceDisplay(center.source) }}
                  </span>
                </div>

                <div class="card-overlay">
                  <!-- Only show shared badge if center is shared -->
                  <div class="share-badge" *ngIf="center.isShared">
                    <svg
                      width="12"
                      height="12"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <polyline points="20 6 9 17 4 12"></polyline>
                    </svg>
                    Shared
                    <svg
                      width="12"
                      height="12"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <circle cx="12" cy="12" r="1"></circle>
                    </svg>
                  </div>
                  <div class="menu-wrapper" (click)="$event.stopPropagation()">
                    <button
                      class="menu-btn"
                      (click)="toggleMenu(center.scId, $event)"
                    >
                      <!-- your 3-dots SVG -->
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="20"
                        height="20"
                        viewBox="0 0 20 20"
                        fill="none"
                      >
                        <path
                          d="M4.16699 8.20801C5.15737 8.20818 5.95801 9.00958 5.95801 10C5.95783 10.9903 5.15726 11.7908 4.16699 11.791C3.17658 11.791 2.37518 10.9904 2.375 10C2.375 9.00948 3.17647 8.20801 4.16699 8.20801ZM4.16699 8.45801C3.31585 8.45801 2.625 9.14886 2.625 10C2.62518 10.851 3.31596 11.541 4.16699 11.541C5.01788 11.5408 5.70783 10.8509 5.70801 10C5.70801 9.14897 5.01799 8.45818 4.16699 8.45801Z"
                          fill="#18171F"
                          stroke="#18171F"
                        />
                        <path
                          d="M15.8334 12.2913C14.5667 12.2913 13.5417 11.2663 13.5417 9.99967C13.5417 8.73301 14.5667 7.70801 15.8334 7.70801C17.1001 7.70801 18.1251 8.73301 18.1251 9.99967C18.1251 11.2663 17.1001 12.2913 15.8334 12.2913ZM15.8334 8.95801C15.2584 8.95801 14.7917 9.42467 14.7917 9.99967C14.7917 10.5747 15.2584 11.0413 15.8334 11.0413C16.4084 11.0413 16.8751 10.5747 16.8751 9.99967C16.8751 9.42467 16.4084 8.95801 15.8334 8.95801Z"
                          fill="#18171F"
                        />
                        <path
                          d="M9.99992 12.2913C8.73325 12.2913 7.70825 11.2663 7.70825 9.99967C7.70825 8.73301 8.73325 7.70801 9.99992 7.70801C11.2666 7.70801 12.2916 8.73301 12.2916 9.99967C12.2916 11.2663 11.2666 12.2913 9.99992 12.2913ZM9.99992 8.95801C9.42492 8.95801 8.95825 9.42467 8.95825 9.99967C8.95825 10.5747 9.42492 11.0413 9.99992 11.0413C10.5749 11.0413 11.0416 10.5747 11.0416 9.99967C11.0416 9.42467 10.5749 8.95801 9.99992 8.95801Z"
                          fill="#18171F"
                        />
                      </svg>
                    </button>

                    <!-- DROPDOWN -->
                    <div
                      class="menu-dropdown"
                      *ngIf="openMenuId === center.scId"
                    >
                      <button
                        class="menu-item"
                        (click)="onEnriche(center); closeMenu()"
                      >
                        Enriche Data
                      </button>
                      <button
                        class="menu-item"
                        (click)="deleteCenter(center.scId); closeMenu()"
                      >
                        Delete Center
                      </button>
                    </div>
                  </div>
                  <div
                    class="click-shield"
                    *ngIf="openMenuId === center.scId"
                    (click)="closeMenu()"
                  ></div>
                </div>
              </div>

              <div class="center-info">
                <h3 class="center-name">{{ center.centerName }}</h3>
                <p class="center-address">{{ center.centerAddress }}</p>
                <div class="center-details">
                  <span
                    class="purchase-price"
                    *ngIf="center.forSalePrice && center.forSalePrice > 0"
                    >Purchase Price</span
                  >
                  <span
                    class="info-badge"
                    *ngIf="center.centerType"
                    >{{center.centerType}}</span
                  >
                </div>
                <div class="price-line" *ngIf="center.buildingSizeSf">
                  <span
                    *ngIf="center.forSalePrice && center.forSalePrice > 0"
                    class="price-per-sf"
                    >1.2% SF-1.568 SF</span
                  >
                  <span *ngIf="center.buildingSizeSf" class="unit-size">
                    {{ center.buildingSizeSf }} SF</span
                  >
                </div>

                <div class="property-details" *ngIf="center.shoppingCenter?.places">
                  <div class="detail-row">
                    <!-- Building Size Range -->
                    <span *ngIf="getMinMaxSizes(center.shoppingCenter.places) as sizes" class="building-size">
                      {{ sizes.min | number }} - {{ sizes.max | number }} SF
                    </span>
                    
                    <!-- Price Range -->
                    <span *ngIf="getMinMaxPrices(center.shoppingCenter.places) as prices" class="price">
                      <ng-container *ngIf="prices.min > 0 || prices.max > 0">
                        ${{ prices.min | number }} - ${{ prices.max | number }}
                        <!-- <span *ngIf="center.shoppingCenter.places[0]?.leaseType">({{ center.shoppingCenter.places[0].leaseType }})</span> -->
                      </ng-container>
                    </span>
                  </div>
                </div>
                
                <div
                class="leased-by"
                *ngIf="center?.shoppingCenter?.managerOrganization?.length"
                (click)="
                  toggleOrgMenu(center.scId, $event); $event.stopPropagation()
                "
              >
                <img
                  *ngIf="center.managerORGLogoURL"
                  src="{{ center.managerORGLogoURL }}"
                  alt=""
                  width="30"
                  height="30"
                  class="mx-1"
                />
                <span class="MangerORG"> {{ center?.managerORG || "—" }}</span>
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                >
                  <path
                    d="M11.9999 16.3299C9.60992 16.3299 7.66992 14.3899 7.66992 11.9999C7.66992 9.60992 9.60992 7.66992 11.9999 7.66992C14.3899 7.66992 16.3299 9.60992 16.3299 11.9999C16.3299 14.3899 14.3899 16.3299 11.9999 16.3299ZM11.9999 9.16992C10.4399 9.16992 9.16992 10.4399 9.16992 11.9999C9.16992 13.5599 10.4399 14.8299 11.9999 14.8299C13.5599 14.8299 14.8299 13.5599 14.8299 11.9999C14.8299 10.4399 13.5599 9.16992 11.9999 9.16992Z"
                    fill="#292D32"
                  />
                  <path
                    d="M12.0001 21.02C8.24008 21.02 4.69008 18.82 2.25008 15C1.19008 13.35 1.19008 10.66 2.25008 8.99998C4.70008 5.17998 8.25008 2.97998 12.0001 2.97998C15.7501 2.97998 19.3001 5.17998 21.7401 8.99998C22.8001 10.65 22.8001 13.34 21.7401 15C19.3001 18.82 15.7501 21.02 12.0001 21.02ZM12.0001 4.47998C8.77008 4.47998 5.68008 6.41998 3.52008 9.80998C2.77008 10.98 2.77008 13.02 3.52008 14.19C5.68008 17.58 8.77008 19.52 12.0001 19.52C15.2301 19.52 18.3201 17.58 20.4801 14.19C21.2301 13.02 21.2301 10.98 20.4801 9.80998C18.3201 6.41998 15.2301 4.47998 12.0001 4.47998Z"
                    fill="#292D32"
                  />
                </svg>
                <!-- trigger -->
                <div class="org-info-trigger">
                  <div
                    class="org-mini-menu"
                    *ngIf="openOrgMenuId === center.scId"
                    [ngStyle]="orgMenuPos"
                    (click)="$event.stopPropagation()"
                  >
                    <div
                      *ngFor="
                        let org of center.shoppingCenter.managerOrganization;
                        let i = index
                      "
                      class="org-mini-item"
                      (click)="openContactModal(center)"
                    >
                      <p class="name">
                        {{ org.firstname | titlecase }}
                        {{ org.lastName | titlecase }}
                      </p>
                       <p class="small">{{ org.email }}</p>
                      <div
                        class="divider"
                        *ngIf="
                          i < center.shoppingCenter.managerOrganization.length - 1
                        "
                      ></div>
                    </div>
                  </div>
                </div>
              </div>
              </div>
            </div>
          </div>
        </div>
        <!-- Shopping Centers Table -->
        <div
          class="centers-table-wrap"
          *ngIf="!isLoading && viewMode === 'table'"
        >
          <table class="centers-table">
            <thead>
              <tr>
                <th style="width: 48px"></th>
                <th
                  (click)="sortBy = 'name'; onSortChange()"
                  [class.sorting]="true"
                >
                  Name
                </th>
                <th
                  (click)="sortBy = 'address'; onSortChange()"
                  [class.sorting]="true"
                >
                  Address
                </th>
                <th>Type</th>
                <th>Category</th>
                <th>Last Update Date</th>
                <th>Manager ORG</th>
                <th></th>

                <th style="width: 56px"></th>
              </tr>
            </thead>

            <tbody>
              <tr
                *ngFor="let center of filteredCenters"
                [class.click-disabled]="openMenuId === center.scId"
              >
                <!-- Thumb -->
                <td>
                  <img
                    loading="lazy"
                    [src]="center.mainImage || 'assets/Images/placeholder.png'"
                    [alt]="center.centerName"
                    class="thumb"
                    (error)="center.mainImage = 'assets/Images/placeholder.png'"
                  />
                </td>

                <!-- Name -->
                <td>
                  <div class="name-cell">
                    <div class="title">{{ center.centerName }}</div>
                    <div class="id" *ngIf="center.scId">
                      ID: {{ center.scId }}
                    </div>
                  </div>
                </td>

                <!-- Address -->
                <td class="muted">{{ center.centerAddress }}</td>
                <!-- Type -->
                <td class="muted">{{ center.centerType }}</td>
                <!-- category -->
                <td class="muted">{{ center.category }}</td>
                <!-- last update date -->
                <td class="muted">{{ center.lastUpdateDate | date }}</td>
                <!-- manager ORG -->
                <td class="muted">{{ center.organizationName }}</td>
                <td class="link-details">
                  <button
                    class="icon-btn"
                    (click)="onRowNavigate(center, $event)"
                    title="Details"
                  >
                    <!-- paste either SVG from above here -->
                    <!-- stroke-style example -->
                    <svg
                      width="18"
                      height="18"
                      viewBox="0 0 24 24"
                      aria-hidden="true"
                      focusable="false"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        d="M3 12h12"
                        stroke="currentColor"
                        stroke-width="2.6"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        fill="none"
                      />
                      <path
                        d="M13 6l7 6-7 6"
                        stroke="currentColor"
                        stroke-width="2.6"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        fill="none"
                      />
                    </svg>
                  </button>
                </td>

                <!-- Actions (same 3-dots dropdown) -->
                <td (click)="$event.stopPropagation()">
                  <div class="menu-wrapper">
                    <button
                      class="menu-btn"
                      (click)="toggleMenu(center.scId, $event)"
                    >
                      <!-- 3 dots svg -->
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="18"
                        height="18"
                        viewBox="0 0 20 20"
                        fill="none"
                      >
                        <path
                          d="M4.16699 8.20801C5.15737 8.20818 5.95801 9.00958 5.95801 10C5.95783 10.9903 5.15726 11.7908 4.16699 11.791C3.17658 11.791 2.37518 10.9904 2.375 10C2.375 9.00948 3.17647 8.20801 4.16699 8.20801Z"
                          fill="#18171F"
                          stroke="#18171F"
                        />
                        <path
                          d="M15.8334 12.2913C14.5667 12.2913 13.5417 11.2663 13.5417 9.99967C13.5417 8.73301 14.5667 7.70801 15.8334 7.70801C17.1001 7.70801 18.1251 8.73301 18.1251 9.99967C18.1251 11.2663 17.1001 12.2913 15.8334 12.2913Z"
                          fill="#18171F"
                        />
                        <path
                          d="M9.99992 12.2913C8.73325 12.2913 7.70825 11.2663 7.70825 9.99967C7.70825 8.73301 8.73325 7.70801 9.99992 7.70801C11.2666 7.70801 12.2916 8.73301 12.2916 9.99967C12.2916 11.2663 11.2666 12.2913 9.99992 12.2913Z"
                          fill="#18171F"
                        />
                      </svg>
                    </button>

                    <div class="menu-table" *ngIf="openMenuId === center.scId">
                      <button
                        class="menu-item"
                        (click)="onEnriche(center); closeMenu()"
                      >
                        Enriche Data
                      </button>
                      <button class="menu-item" (click)="closeMenu()">
                        Upload OM Files
                      </button>
                    </div>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="pagination" *ngIf="totalItems > itemsPerPage">
          <button 
            class="page-button prev"
            [disabled]="currentPage === 1"
            (click)="onPageChange(currentPage - 1)"
          >
            Previous
          </button>
        
          <div class="page-numbers">
            <button 
              *ngFor="let page of getPageNumbers()"
              class="page-number"
              [class.active]="currentPage === page"
              [disabled]="page === 0"
              (click)="onPageChange(page)"
            >
              {{ page === 0 ? '...' : page }}
            </button>
          </div>
        
          <button 
            class="page-button next"
            [disabled]="currentPage === totalPages"
            (click)="onPageChange(currentPage + 1)"
          >
            Next
          </button>
        </div>
      </div>
    </div>

    <!-- No Results Message -->
    <div
      class="no-results"
      *ngIf="!isLoading && filteredCenters.length === 0 && centers.length > 0"
    >
      <p>No shopping centers match your search criteria.</p>
    </div>

    <!-- Empty State -->
    <div class="no-results" *ngIf="!isLoading && centers.length === 0">
      <p>No shopping centers available.</p>
    </div>
  </div>
</div>
<!-- File Explorer Component - Simplified integration -->
<app-file-explorer
  #fileExplorer
  [contactID]="contactID"
  (fileSelected)="onFileSelected($event)"
  (onClose)="onFileExplorerClose()"
>
</app-file-explorer>
<ng-template #campaignModal let-modal>
  <div class="modal-header">
    <h4 class="modal-title">Select Campaign</h4>
    <button
      type="button"
      class="btn-close"
      aria-label="Close"
      (click)="modal.dismiss()"
    ></button>
  </div>

  <div class="modal-body">
    <div class="campaign-cards-grid">
      <div
        *ngFor="let campaign of campaigns"
        class="campaign-card"
        [class.selected]="selectedCampaign === campaign"
        (click)="selectedCampaign = campaign"
      >
        <!-- Logo + name -->
        <div class="campaign-header">
          <ng-container *ngIf="campaign.logoUrl; else logoPlaceholder">
            <img
              [src]="campaign.logoUrl"
              class="campaign-logo"
              crossorigin="anonymous"
            />
          </ng-container>
          <ng-template #logoPlaceholder>
            <div class="campaign-logo placeholder">
              {{ campaign.CampaignName.charAt(0) }}
            </div>
          </ng-template>
          <h3 class="campaign-name">{{ campaign.CampaignName }}</h3>
        </div>

        <!-- selection mark -->
        <div class="campaign-check" *ngIf="selectedCampaign === campaign">
          ✓
        </div>
      </div>
      <!-- Add Campaign Card -->
      <div class="campaign-card add-card" (click)="goToAddCampaign()">
        <div class="add-card-content">
          <div class="plus-icon" style="height: 48px !important;">+</div>
          <h3 class="campaign-name">Add Campaign</h3>
        </div>
      </div>
    </div>
  </div>

  <div class="modal-footer">
    <!-- <button class="btn btn-secondary" (click)="modal.dismiss()">Cancel</button> -->
    <button
      class="btn btn-primary btn-custom"
      (click)="addCenter(currentCenter, selectedCampaign.Id); modal.close()"
    >
      Add
    </button>
  </div>
</ng-template>

<div id="customToast" class="custom-toast">
  <div class="toast-content">
    <p id="toastMessage"></p>
  </div>
</div>



<ng-template #StreetViewPlace let-modal>
  <div id="street-view" class="h700"></div>
</ng-template>

<ng-template #MapViewPlace let-modal>
  <div id="mappopup" class="h700"></div>
</ng-template>
