<div class="campaign-manager-container">
  <div
    *ngIf="filteredCampaigns.length > 0"
    class="w-100 d-flex align-items-center justify-content-between"
  >
    <div class="search-campaign-container">
      <input
        type="text"
        class="form-control search-campaign-input"
        placeholder="Search Campaigns..."
        name="searchCampaign"
        [(ngModel)]="searchCampaign"
        (input)="onSearchCampaign()"
      />
      <svg
        class="search-campaign-icon"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
      >
        <path
          d="M11.5 21.75C5.85 21.75 1.25 17.15 1.25 11.5C1.25 5.85 5.85 1.25 11.5 1.25C17.15 1.25 21.75 5.85 21.75 11.5C21.75 17.15 17.15 21.75 11.5 21.75ZM11.5 2.75C6.67 2.75 2.75 6.68 2.75 11.5C2.75 16.32 6.67 20.25 11.5 20.25C16.33 20.25 20.25 16.32 20.25 11.5C20.25 6.68 16.33 2.75 11.5 2.75Z"
          fill="#707791"
        />
        <path
          d="M21.9999 22.7499C21.8099 22.7499 21.6199 22.6799 21.4699 22.5299L19.4699 20.5299C19.1799 20.2399 19.1799 19.7599 19.4699 19.4699C19.7599 19.1799 20.2399 19.1799 20.5299 19.4699L22.5299 21.4699C22.8199 21.7599 22.8199 22.2399 22.5299 22.5299C22.3799 22.6799 22.1899 22.7499 21.9999 22.7499Z"
          fill="#707791"
        />
      </svg>
    </div>
    <button class="add-new-campaign" (click)="openAddCampaignPopup(content)">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="20"
        height="20"
        viewBox="0 0 20 20"
        fill="none"
      >
        <path
          d="M10.0001 18.3333C14.5834 18.3333 18.3334 14.5833 18.3334 9.99996C18.3334 5.41663 14.5834 1.66663 10.0001 1.66663C5.41675 1.66663 1.66675 5.41663 1.66675 9.99996C1.66675 14.5833 5.41675 18.3333 10.0001 18.3333Z"
          stroke="white"
          stroke-width="1.5"
          stroke-linecap="round"
          stroke-linejoin="round"
        />
        <path
          d="M6.66675 10H13.3334"
          stroke="white"
          stroke-width="1.5"
          stroke-linecap="round"
          stroke-linejoin="round"
        />
        <path
          d="M10 13.3333V6.66663"
          stroke="white"
          stroke-width="1.5"
          stroke-linecap="round"
          stroke-linejoin="round"
        />
      </svg>
      <span>Add New Campaign</span>
    </button>
  </div>

  <div *ngIf="filteredCampaigns.length > 0" class="campaign-manager-body">
    <div class="table-responsive">
      <table class="table align-middle">
        <thead>
          <tr>
            <th scope="col">Campaign Name</th>
            <th scope="col">Tenant</th>
            <th scope="col" style="min-width: 8vw">States</th>
            <th scope="col">Date Created</th>
            <th scope="col">Privacy</th>
            <th scope="col"></th>
          </tr>
        </thead>
        <tbody>
          <ng-container *ngFor="let c of filteredCampaigns">
            <ng-container *ngFor="let campaign of c.Campaigns">
              <tr>
                <td>
                  {{ campaign.CampaignName }}
                </td>
                <td>
                  <div class="d-flex align-items-center gap-2">
                    <img
                      *ngIf="c.organizationid"
                      [src]="
                        'https://api.cherrypick.com/api/Organization/GetOrgImag?orgId=' +
                        c.organizationid
                      "
                      [alt]="c.name"
                      class="tenant-logo"
                    />
                    <span>{{ c.name }}</span>
                  </div>
                </td>
                <td>
                  <div class="d-flex align-items-center gap-1">
                    <ng-container *ngFor="let polygon of campaign.Geojsons">
                      <div class="d-flex align-items-center gap-1">
                        <span>{{ polygon.state }}</span>
                        <span>&bull;</span>
                      </div>
                    </ng-container>
                  </div>
                </td>
                <td>
                  {{ (campaign.CreatedDate | date : "MMM d, y") ?? "N/A" }}
                </td>
                <td>
                  <div
                    class="campaign-privacy"
                    [ngClass]="{
                      'campaign-privacy-public': campaign.CampaignPrivacy == 0,
                      'campaign-privacy-private': campaign.CampaignPrivacy == 1
                    }"
                  >
                    <div class="campaign-privacy-icon"></div>
                    <span>
                      {{
                        campaign.CampaignPrivacy == 0 ? "Public" : "Private"
                      }}</span
                    >
                  </div>
                </td>
                <td>
                  <div
                    class="d-flex align-items-center justify-content-center gap-2"
                  >
                    <div class="more">
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        fill="none"
                      >
                        <path
                          d="M20.6201 13.07C20.2401 13.07 19.9201 12.78 19.8701 12.4C19.6301 10.14 18.4101 8.08998 16.5301 6.78998C16.1901 6.54998 16.1101 6.08998 16.3401 5.74998C16.5801 5.40998 17.0501 5.32998 17.3801 5.55998C19.6201 7.10998 21.0601 9.54998 21.3501 12.24C21.3901 12.65 21.1001 13.02 20.6801 13.07C20.6701 13.07 20.6401 13.07 20.6201 13.07Z"
                          fill="#707791"
                        />
                        <path
                          d="M3.49015 13.12C3.46015 13.12 3.44015 13.12 3.41015 13.12C3.00015 13.07 2.70015 12.7 2.74015 12.29C3.01015 9.60001 4.44015 7.17001 6.65015 5.60001C6.99015 5.36001 7.46015 5.44001 7.70015 5.78001C7.94015 6.12001 7.86015 6.59001 7.52015 6.83001C5.66015 8.14001 4.46015 10.19 4.23015 12.45C4.20015 12.83 3.87015 13.12 3.49015 13.12Z"
                          fill="#707791"
                        />
                        <path
                          d="M12.0601 22.61C10.5801 22.61 9.17009 22.27 7.85009 21.61C7.48009 21.42 7.33009 20.97 7.52009 20.6C7.71009 20.23 8.16009 20.08 8.53009 20.27C10.6901 21.36 13.2901 21.38 15.4701 20.33C15.8401 20.15 16.2901 20.31 16.4701 20.68C16.6501 21.05 16.4901 21.5 16.1201 21.68C14.8401 22.3 13.4801 22.61 12.0601 22.61Z"
                          fill="#707791"
                        />
                        <path
                          d="M12.0602 8.44C10.1102 8.44 8.53015 6.86 8.53015 4.91C8.53015 2.96 10.1102 1.38 12.0602 1.38C14.0102 1.38 15.5902 2.96 15.5902 4.91C15.5902 6.86 14.0002 8.44 12.0602 8.44ZM12.0602 2.89C10.9402 2.89 10.0302 3.8 10.0302 4.92C10.0302 6.04 10.9402 6.95 12.0602 6.95C13.1802 6.95 14.0902 6.04 14.0902 4.92C14.0902 3.8 13.1702 2.89 12.0602 2.89Z"
                          fill="#707791"
                        />
                        <path
                          d="M4.83017 20.67C2.88017 20.67 1.30017 19.09 1.30017 17.14C1.30017 15.2 2.88017 13.61 4.83017 13.61C6.78017 13.61 8.36017 15.19 8.36017 17.14C8.36017 19.08 6.78017 20.67 4.83017 20.67ZM4.83017 15.11C3.71017 15.11 2.80017 16.02 2.80017 17.14C2.80017 18.26 3.71017 19.17 4.83017 19.17C5.95017 19.17 6.86017 18.26 6.86017 17.14C6.86017 16.02 5.95017 15.11 4.83017 15.11Z"
                          fill="#707791"
                        />
                        <path
                          d="M19.1701 20.67C17.2201 20.67 15.6401 19.09 15.6401 17.14C15.6401 15.2 17.2201 13.61 19.1701 13.61C21.1201 13.61 22.7001 15.19 22.7001 17.14C22.6901 19.08 21.1101 20.67 19.1701 20.67ZM19.1701 15.11C18.0501 15.11 17.1401 16.02 17.1401 17.14C17.1401 18.26 18.0501 19.17 19.1701 19.17C20.2901 19.17 21.2001 18.26 21.2001 17.14C21.1901 16.02 20.2901 15.11 19.1701 15.11Z"
                          fill="#707791"
                        />
                      </svg>
                    </div>
                    <div class="more">
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        fill="none"
                      >
                        <path
                          d="M5.00012 14.75C3.48012 14.75 2.25012 13.52 2.25012 12C2.25012 10.48 3.48012 9.25 5.00012 9.25C6.52012 9.25 7.75012 10.48 7.75012 12C7.75012 13.52 6.52012 14.75 5.00012 14.75ZM5.00012 10.75C4.31012 10.75 3.75012 11.31 3.75012 12C3.75012 12.69 4.31012 13.25 5.00012 13.25C5.69012 13.25 6.25012 12.69 6.25012 12C6.25012 11.31 5.69012 10.75 5.00012 10.75Z"
                          fill="#707791"
                        />
                        <path
                          d="M19.0001 14.75C17.4801 14.75 16.2501 13.52 16.2501 12C16.2501 10.48 17.4801 9.25 19.0001 9.25C20.5201 9.25 21.7501 10.48 21.7501 12C21.7501 13.52 20.5201 14.75 19.0001 14.75ZM19.0001 10.75C18.3101 10.75 17.7501 11.31 17.7501 12C17.7501 12.69 18.3101 13.25 19.0001 13.25C19.6901 13.25 20.2501 12.69 20.2501 12C20.2501 11.31 19.6901 10.75 19.0001 10.75Z"
                          fill="#707791"
                        />
                        <path
                          d="M12.0001 14.75C10.4801 14.75 9.25012 13.52 9.25012 12C9.25012 10.48 10.4801 9.25 12.0001 9.25C13.5201 9.25 14.7501 10.48 14.7501 12C14.7501 13.52 13.5201 14.75 12.0001 14.75ZM12.0001 10.75C11.3101 10.75 10.7501 11.31 10.7501 12C10.7501 12.69 11.3101 13.25 12.0001 13.25C12.6901 13.25 13.2501 12.69 13.2501 12C13.2501 11.31 12.6901 10.75 12.0001 10.75Z"
                          fill="#707791"
                        />
                      </svg>
                    </div>
                  </div>
                </td>
              </tr>
            </ng-container>
          </ng-container>
        </tbody>
      </table>
    </div>
  </div>

  <div *ngIf="!(filteredCampaigns.length > 0)" class="empty-campaigns">
    <img src="../../../assets/Images/empty-state.png" alt="Empty Campaigns" />
    <h4>Campaigns Will Appear Here!</h4>
    <p>Create, Track, and Manage Expansion Campaigns Here.</p>
    <button class="add-new-campaign" (click)="openAddCampaignPopup(content)">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="20"
        height="20"
        viewBox="0 0 20 20"
        fill="none"
      >
        <path
          d="M10.0001 18.3333C14.5834 18.3333 18.3334 14.5833 18.3334 9.99996C18.3334 5.41663 14.5834 1.66663 10.0001 1.66663C5.41675 1.66663 1.66675 5.41663 1.66675 9.99996C1.66675 14.5833 5.41675 18.3333 10.0001 18.3333Z"
          stroke="white"
          stroke-width="1.5"
          stroke-linecap="round"
          stroke-linejoin="round"
        />
        <path
          d="M6.66675 10H13.3334"
          stroke="white"
          stroke-width="1.5"
          stroke-linecap="round"
          stroke-linejoin="round"
        />
        <path
          d="M10 13.3333V6.66663"
          stroke="white"
          stroke-width="1.5"
          stroke-linecap="round"
          stroke-linejoin="round"
        />
      </svg>
      <span>Add New Campaign</span>
    </button>
  </div>
</div>

<ng-template #content let-modal>
  <div class="modal-body">
    <label for="user-buybox" class="form-label mb-2">Select Tenants</label>
    <select
      id="user-buybox"
      class="form-select mb-3"
      aria-label="Buybox select"
    >
      <ng-container *ngFor="let buyBox of userBuyBoxes">
        <option [value]="buyBox.id">
          {{ buyBox.name }}
        </option>
      </ng-container>
    </select>

    <div class="campaign-drawing-component">
      <app-campaign-drawing
        [buyBoxId]="selectedBuyBoxId"
        (onCampaignCreated)="onCampaignCreated()"
      ></app-campaign-drawing>
    </div>
  </div>
</ng-template>

<ngx-spinner type="ball-scale-multiple"> </ngx-spinner>
