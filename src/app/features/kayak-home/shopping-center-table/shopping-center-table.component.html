<div class="tab-view-container">
  <div class="header-container">
    <div class="search-container">
      <i class="fa-solid fa-search search-icon"></i>
      <input 
        type="text" 
        placeholder="Search Properties..." 
        class="search-input" 
        [(ngModel)]="searchQuery"
        (input)="onSearch($event)">
    </div>
    <div class="actions-container">
      <div class="stage-select-container">
        <div class="custom-select-wrapper">
          <button
            class="custom-select"
            type="button"
            id="stageDropdown"
            data-bs-toggle="dropdown"
            aria-expanded="false"
          >
            {{ selectedStageName }}
            <i class="fa-solid fa-chevron-down ms-2"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="stageDropdown">
            <li>
              <a
                class="dropdown-item"
                [class.active]="selectedStageId === 0"
                (click)="selectStagekan(0)"
                >All</a
              >
            </li>
            <li *ngFor="let stage of stages">
              <a
                class="dropdown-item"
                [class.active]="selectedStageId === stage.id"
                [attr.aria-current]="selectedStageId === stage.id ? 'true' : null"
                (click)="selectStagekan(stage.id)"
              >
                {{ stage.stageName }}
              </a>
            </li>
          </ul>
        </div>
      </div>
      
      <div class="sort-container">
        <button class="action-btn" (click)="toggleSort()">
          <i class="fa-solid fa-arrow-up-arrow-down"></i>
          <span>{{ getSelectedSortText() }}</span>
        </button>
        <div class="sort-menu" *ngIf="isSortMenuOpen">
          <div 
            *ngFor="let option of sortOptions" 
            class="sort-option"
            [class.active]="selectedSortId === option.id"
            (click)="selectSort(option)"
          >
            <i [class]="option.icon"></i>
            <span>{{ option.text }}</span>
          </div>
        </div>
      </div>

      <div class="dropdown">
        <button class="action-btn dropdown-toggle" type="button" id="viewDropdown" data-bs-toggle="dropdown" aria-expanded="false">
          <img [src]="getCurrentViewIcon()" [alt]="getCurrentViewName()" class="view-icon">
          <span>{{ getCurrentViewName() }}</span>
        </button>
        <ul class="dropdown-menu" aria-labelledby="viewDropdown">
          <li *ngFor="let option of dropdowmOptions">
            <a class="dropdown-item" (click)="selectOption(option)">
              <img [src]="option.icon" [alt]="option.text" class="view-icon">
              <span>{{ option.text }}</span>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- <div 
    class="mobileButtons mt-2 d-flex justify-content-between align-items-center "
    style="padding-left: 12px;"
  >
    <div class="custom-icon-container">
      <div
        class="icon-option"
        *ngFor="let option of dropdowmOptions"
        [class.d-none]="option.status == 2"
        [class.d-sm-flex]="option.status == 2"
        (click)="selectOption(option)"
        [class.displayNone]="
          (option.status == 6 && isMobile) || (option.status == 4 && isMobile)
        "
        [class.selected]="
          selectedOption === option.status || selectedOption === option
        "
      >
        <img [src]="option.icon" [alt]="option.text" class="icon-image" />
        <span class="icon-text d-none d-sm-flex" *ngIf="!isMobile">{{
          option.text
        }}</span> 
      </div>
    </div>
    <div class="d-flex">
      <button
        style="border: none; background: none"
        class="border-none mx-2 d-sm-flex d-none"
      >
        <app-link-microsoft style="height: 25px"></app-link-microsoft>
      </button>

      <button
        class="action-btn optionMobileColor"
        [routerLink]="['/organization-mail', BuyBoxId, OrgId, CampaignId]"
      >
        <i
          class="fa-regular fa-envelope me-2 optionMobile"
          style="color: #fff"
        ></i>
        <span>Emily</span>
      </button>

      <button
        class="action-btn optionMobileColor"
        [routerLink]="['/campaigns/ataglance', CampaignId]"
      >
        <i class="fa-regular fa-star"></i>
        <span> At a Glance </span>
      </button>
      <button class="action-btn optionMobileColor">
        <a
          class="action-btn optionMobileColor"
          [href]="generateSafeUrl()"
          target="_blank"
        >
          <i class="fa-solid fa-house"></i>
          <span> Market Survey </span>
        </a>
      </button>
    </div>
  </div> -->
 
  <app-map-view
    *ngIf="currentView == 1"
    (viewChange)="onViewChange($event)"
    #mapView
  ></app-map-view>

  <div class="row m-0" *ngIf="currentView == 2">
    <div class="col-12 p-0">
      <app-side-list-view
        (highlightMarker)="onHighlightMarker($event)"
        (unhighlightMarker)="onUnhighlightMarker($event)"
      ></app-side-list-view>
    </div>
  </div>
  <app-card-view *ngIf="currentView == 3"></app-card-view>
  <app-table-view *ngIf="currentView == 4" (viewChange)="onViewChange($event)"></app-table-view>
  <app-social-view *ngIf="currentView == 5" (viewChange)="onViewChange($event)"></app-social-view>
  <app-kanban-view *ngIf="currentView == 6"></app-kanban-view>
</div>
<ngx-spinner type="ball-scale-multiple"></ngx-spinner>
