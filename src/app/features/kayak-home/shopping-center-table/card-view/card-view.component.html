<!-- Skeleton loading template -->
<div class="cards-row m-0 mt-2" *ngIf="isLoading">
  <ng-container *ngFor="let i of [1, 2, 3, 4, 5, 6]">
    <div class="card-window cursor">
      <div class="cardResponsive skeleton-card">
        <div class="skeleton-img"></div>
        <div class="content-wrap card-content">
          <div>
            <div class="d-flex justify-content-between">
              <div class="skeleton-title"></div>
              <div class="skeleton-button"></div>
            </div>
            <div class="skeleton-address"></div>
            <div class="skeleton-category"></div>
            <div class="row m-0">
              <div class="col-12 d-flex flex-column spec">
                <div class="d-flex flex-column">
                  <div class="skeleton-text"></div>
                  <div class="skeleton-text-sm"></div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-12 spec">
            <hr class="small-hr mt-1 mb-1" />
            <div class="skeleton-footer"></div>
          </div>
        </div>
      </div>
    </div>
  </ng-container>
</div>

<!-- Actual content when loaded -->
<div class="cards-row m-0" *ngIf="!isLoading">
  <div id="customToastsuccess" class="custom-toast">
    <div class="toast-content">
      <p id="toastMessagesuccess"></p>
    </div>
  </div>
  <ng-container *ngFor="let shopping of cardsSideList; trackBy: trackById">
    <div
      class="cardResponsive"
      [class.click-disabled]="openMenuId === shopping.Id"
      *ngIf="shopping.MainImage || shopping.scoreImage"
    >
      <div
        class="main-img"
        [routerLink]="(openMenuId === shopping.Id||openStageId === shopping.Id) ? null : ['/landing',shopping?.ShoppingCenter?.Places?.[0]?.Id || 0,shopping?.Id,shopping.CampaignId]"
      >
        <img
          *ngIf="shopping.MainImage && !shopping.scoreImage; else score"
          (error)="shopping.scoreImage = true"
          loading="lazy"
          [src]="shopping.MainImage"
          [title]="shopping.CenterName"
          [ngClass]="{ loading: imageLoadingStates[shopping.Id] }"
          loading="lazy"
          alt="{{ shopping.CenterName }}"
          referrerpolicy="no-referrer"
          [class.click-disabled]="
            shopping.isDropdownOpen || openOrgMenuId === shopping.Id
          "
          class="imgggg"
          [routerLink]="(openMenuId === shopping.Id||openStageId === shopping.Id) ? null : ['/landing',shopping?.ShoppingCenter?.Places?.[0]?.Id || 0,shopping?.Id,shopping.CampaignId]"
        />
        <button
          class="plus-icon reload"
          [ngClass]="{ rotate: rotatingKeys[shopping.Id] > 0 }"
          (click)="InsertAutomation(shopping.Id, 1); $event.stopPropagation()"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
          >
            <path
              d="M12.0001 22.75C6.80008 22.75 2.58008 18.52 2.58008 13.33C2.58008 8.13999 6.80008 3.89999 12.0001 3.89999C13.0701 3.89999 14.1101 4.04999 15.1101 4.35999C15.5101 4.47999 15.7301 4.89999 15.6101 5.29999C15.4901 5.69999 15.0701 5.91999 14.6701 5.79999C13.8201 5.53999 12.9201 5.39999 12.0001 5.39999C7.63008 5.39999 4.08008 8.94999 4.08008 13.32C4.08008 17.69 7.63008 21.24 12.0001 21.24C16.3701 21.24 19.9201 17.69 19.9201 13.32C19.9201 11.74 19.4601 10.22 18.5901 8.91999C18.3601 8.57999 18.4501 8.10999 18.8001 7.87999C19.1401 7.64999 19.6101 7.73999 19.8401 8.08999C20.8801 9.63999 21.4301 11.45 21.4301 13.33C21.4201 18.52 17.2001 22.75 12.0001 22.75Z"
              fill="#704E73"
            />
            <path
              d="M16.1304 6.06999C15.9204 6.06999 15.7104 5.97999 15.5604 5.80999L12.6704 2.49C12.4004 2.18 12.4304 1.69999 12.7404 1.42999C13.0504 1.15999 13.5304 1.18999 13.8004 1.49999L16.6904 4.82C16.9604 5.13 16.9304 5.60999 16.6204 5.87999C16.4904 6.00999 16.3104 6.06999 16.1304 6.06999Z"
              fill="#704E73"
            />
            <path
              d="M12.7602 8.52999C12.5302 8.52999 12.3002 8.41999 12.1502 8.21999C11.9102 7.88999 11.9802 7.41999 12.3102 7.16999L15.6802 4.70999C16.0102 4.45999 16.4802 4.53999 16.7302 4.86999C16.9802 5.19999 16.9002 5.66999 16.5702 5.91999L13.2002 8.38999C13.0702 8.48999 12.9202 8.52999 12.7602 8.52999Z"
              fill="#704E73"
            />
          </svg>
        </button>

        <div
          (click)="$event.stopPropagation()"
          class="plus-icon date score"
          *ngIf="shopping.LastUpdateDate"
        >
          {{ shopping.LastUpdateDate | date }}
          <span *ngIf="shopping.Source">
            <span class="source">By </span>{{ shopping.Source }}
          </span>
        </div>

        <button
          class="plus-icon score"
          [class.active]="scoringId === shopping.Id"
          (click)="getscore(shopping); $event.stopPropagation()"
          *ngIf="!shopping.Score && shopping.Score !== 0"
        >
          <span *ngIf="scoringId !== shopping.Id">Get Score</span>
          <span *ngIf="scoringId === shopping.Id">
            Getting Score
            <span class="stat-bars" aria-hidden="true">
              <span></span><span></span><span></span><span></span><span></span
              ><span></span>
            </span>
          </span>
        </button>
        <!-- <div
          (click)="deleteCenter(shopping.Id); $event.stopPropagation()"
          class="card-badge delete-badge"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
          >
            <path
              d="M21 5.98001C17.67 5.65001 14.32 5.48001 10.98 5.48001C9 5.48001 7.02 5.58001 5.04 5.78001L3 5.98001"
              stroke="#292D32"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
            <path
              d="M8.5 4.97L8.72 3.66C8.88 2.71 9 2 10.69 2H13.31C15 2 15.13 2.75 15.28 3.67L15.5 4.97"
              stroke="#292D32"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
            <path
              d="M18.85 9.14001L18.2 19.21C18.09 20.78 18 22 15.21 22H8.78999C5.99999 22 5.90999 20.78 5.79999 19.21L5.14999 9.14001"
              stroke="#292D32"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
            <path
              d="M10.33 16.5H13.66"
              stroke="#292D32"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
            <path
              d="M9.5 12.5H14.5"
              stroke="#292D32"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </svg>
        </div> -->
        <div
          (click)="openInfoPopup(shopping, infoModal); $event.stopPropagation()"
          *ngIf="shopping.Score !== null"
          class="card-badge"
          [ngClass]="{
            'green-circle': shopping.Score > 50,
            'yellow-circle': shopping.Score < 50,
            'red-circle': !shopping.Score
          }"
          [attr.aria-label]="shopping.Score"
        >
          <span>{{ shopping.Score }} %</span>
        </div>

        <!--  White div with Score -->
        <ng-template #score>
          <div
            *ngIf="shopping.Score !== undefined; else fallback"
            class="score-placeholder"
          >
            <div
              class="score-text"
              (click)="
                $event.preventDefault();
                $event.stopPropagation();
                openInfoPopup(shopping, infoModal)
              "
            >
              <!-- {{ shopping.Score | number : "1.0-0" }}% -->
            </div>
            <!-- <button
              (click)="
                $event.preventDefault();
                $event.stopPropagation();
                openInfoPopup(shopping, infoModal)
              "
              class="icon-btn"
            >
              <i class="fa-solid fa-circle-info"></i>
            </button> -->
          </div>
          <ng-template #fallback>
            <div class="score-placeholder">
              <div class="score-text">
                <!-- {{ shopping.CenterName }} -->
              </div>
            </div>
          </ng-template>
        </ng-template>
        <!-- Overlayed stage chip on image -->
        <div class="card-overlay">
          <div class="menu-wrapper">
            <div
              class="selected-option"
              (click)="toggleMenu(shopping.Id, $event, true)"
            >
              {{ getSelectedStageName(shopping.kanbanStageId) }}
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="16"
                height="16"
                viewBox="0 0 16 16"
                fill="none"
              >
                <path
                  d="M8.00001 11.2C7.53335 11.2 7.06668 11.0201 6.71335 10.6667L2.36668 6.32005C2.17335 6.12672 2.17335 5.80672 2.36668 5.61338C2.56001 5.42005 2.88001 5.42005 3.07335 5.61338L7.42001 9.96005C7.74001 10.2801 8.26001 10.2801 8.58001 9.96005L12.9267 5.61338C13.12 5.42005 13.44 5.42005 13.6333 5.61338C13.8267 5.80672 13.8267 6.12672 13.6333 6.32005L9.28668 10.6667C8.93335 11.0201 8.46668 11.2 8.00001 11.2Z"
                  fill="#161017"
                />
              </svg>
            </div>
            <div
              (click)="$event.stopPropagation()"
              class="dropdown-options"
              [class.show]="openStageId === shopping.Id"
            >
              <div
                *ngFor="let stage of KanbanStages"
                class="dropdown-item"
                [class.active]="stage.id === shopping.kanbanStageId"
                (click)="
                  selectStage(
                    shopping.MarketSurveyId,
                    stage.id,
                    shopping,
                    $event
                  )
                "
              >
                {{ stage.stageName }}
              </div>
            </div>
          </div>
          <div class="menu-wrapper" (click)="$event.stopPropagation()">
            <button class="menu-btn" (click)="toggleMenu(shopping.Id, $event)">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="20"
                height="20"
                viewBox="0 0 20 20"
                fill="none"
              >
                <path
                  d="M4.16699 8.20801C5.15737 8.20818 5.95801 9.00958 5.95801 10C5.95783 10.9903 5.15726 11.7908 4.16699 11.791C3.17658 11.791 2.37518 10.9904 2.375 10C2.375 9.00948 3.17647 8.20801 4.16699 8.20801ZM4.16699 8.45801C3.31585 8.45801 2.625 9.14886 2.625 10C2.62518 10.851 3.31596 11.541 4.16699 11.541C5.01788 11.5408 5.70783 10.8509 5.70801 10C5.70801 9.14897 5.01799 8.45818 4.16699 8.45801Z"
                  fill="#18171F"
                  stroke="#18171F"
                />
                <path
                  d="M15.8334 12.2913C14.5667 12.2913 13.5417 11.2663 13.5417 9.99967C13.5417 8.73301 14.5667 7.70801 15.8334 7.70801C17.1001 7.70801 18.1251 8.73301 18.1251 9.99967C18.1251 11.2663 17.1001 12.2913 15.8334 12.2913ZM15.8334 8.95801C15.2584 8.95801 14.7917 9.42467 14.7917 9.99967C14.7917 10.5747 15.2584 11.0413 15.8334 11.0413C16.4084 11.0413 16.8751 10.5747 16.8751 9.99967C16.8751 9.42467 16.4084 8.95801 15.8334 8.95801Z"
                  fill="#18171F"
                />
                <path
                  d="M9.99992 12.2913C8.73325 12.2913 7.70825 11.2663 7.70825 9.99967C7.70825 8.73301 8.73325 7.70801 9.99992 7.70801C11.2666 7.70801 12.2916 8.73301 12.2916 9.99967C12.2916 11.2663 11.2666 12.2913 9.99992 12.2913ZM9.99992 8.95801C9.42492 8.95801 8.95825 9.42467 8.95825 9.99967C8.95825 10.5747 9.42492 11.0413 9.99992 11.0413C10.5749 11.0413 11.0416 10.5747 11.0416 9.99967C11.0416 9.42467 10.5749 8.95801 9.99992 8.95801Z"
                  fill="#18171F"
                />
              </svg>
            </button>

            <!-- DROPDOWN -->
            <div class="menu-dropdown" *ngIf="openMenuId === shopping.Id">
              <button
                [routerLink]="['/landing',shopping?.ShoppingCenter?.Places?.[0]?.Id || 0,shopping?.Id,shopping.CampaignId]"
                class="menu-item"
                (click)="closeMenu()"
              >
                View Details
              </button>

              <button
                class="menu-item"
                (click)="openContactModal(shopping); closeMenu()"
              >
                Contact Broker
              </button>
              <button
                class="menu-item"
                (click)="openMapViewPlace(MapViewPlace, shopping); closeMenu()"
              >
                View Location
              </button>
              <button
                class="menu-item"
                (click)="
                  openStreetViewPlace(StreetViewPlace, shopping); closeMenu()
                "
              >
                Street View
              </button>
              <button
                *ngIf="
                  checkSubmission(shopping?.ShoppingCenter?.UserSubmmision)
                "
                class="menu-item"
                (click)="
                  openModalSubmission(
                    shopping?.ShoppingCenter?.UserSubmmision || [],
                    submission
                  );
                  closeMenu()
                "
              >
                View Submissions
              </button>

              <button
                class="menu-item"
                (click)="openAddContactModal(shopping.Id); closeMenu()"
              >
                Add Contact
              </button>
              <button
                class="menu-item"
                (click)="deleteCenter(shopping.Id); $event.stopPropagation()"
              >
                Delete Center
              </button>
            </div>
          </div>
          <div
            class="click-shield"
            *ngIf="openMenuId === shopping.Id"
            (click)="closeMenu()"
          ></div>
        </div>
      </div>
      <div class="-container"></div>

      <div class="content-wrap card-content">
        <div>
          <div
            class="d-flex justify-content-between"
            [routerLink]="[ '/landing', shopping?.ShoppingCenter?.Places ? shopping?.ShoppingCenter?.Places?.[0]?.Id : 0,shopping?.Id,shopping.CampaignId]"
          >
            <div class="content-title cursor" style="white-space: pre-line">
              {{ shopping.CenterName }}
            </div>
            <span
              class="badge badge-danger mx-2"
              *ngIf="shopping.Deleted == true"
              >Deleted</span
            >
          </div>
          <div
            class="card-address cursor"
            (click)="openMapViewPlace(MapViewPlace, shopping)"
            title="View Location"
            style="cursor: pointer"
          >
            <span class="mb-5">
              {{ shopping.CenterAddress }},
              {{ shopping.CenterCity | titlecase }},
              {{ shopping.CenterState }}
            </span>
          </div>

          <div
            *ngIf="
              shopping.sizeRange !== null && shopping.sizeRange !== undefined
            "
          >
            <ng-container
              *ngIf="Array.isArray(shopping.sizeRange); else singleSize"
            >
              {{ shopping.sizeRange[0] | number }} -
              {{ shopping.sizeRange[1] | number }} SF
            </ng-container>
            <ng-template #singleSize>
              {{ shopping.sizeRange | number }} SF
            </ng-template>
          </div>

          <div>
            <div
              *ngIf="shopping.ShoppingCenter?.Places?.length"
              class="table-responsive mt-2"
              style="max-height: 150px; overflow-y: auto"
            ></div>

            <div *ngIf="getSentMails(shopping).length > 0" class="mt-2">
              <ng-container *ngIf="getSentMails(shopping) as mails">
                <div *ngIf="shopping.lastOutgoingEmail">
                  <span
                    class="mail-summary"
                    (click)="openMailPopup(shopping.lastOutgoingEmail.ID)"
                  >
                    Last Sent Email:
                    <span style="text-decoration: none">{{
                      shopping.lastOutgoingEmail.Date | date
                    }}</span>
                  </span>
                </div>
                <div *ngIf="shopping.lastIncomingEmail" class="mt-2">
                  <span
                    class="mail-summary"
                    (click)="openMailPopup(shopping.lastIncomingEmail.ID)"
                    modal-body
                  >
                    Last Received Email:
                    <span style="text-decoration: none">{{
                      shopping.lastIncomingEmail.Date | date
                    }}</span>
                  </span>
                </div>
              </ng-container>
            </div>
          </div>
          <div class="row m-0">
            <div
              *ngFor="let item of shopping.ShoppingCenter?.BuyBoxPlaces"
              class="col-12 d-flex flex-column spec"
            >
              <div class="d-flex flex-column">
                <p>
                  {{ item.RelationOrganizationName }}
                  <!-- <img loading="lazy" 
                      class="logo ms-2"
                      src="https://api.cherrypick.com/api/Organization/GetOrgImag?orgId={{
                        item.RelationOrganizationId
                      }}"
                      [title]="item.RelationOrganizationName"
                      alt=""
                    /> -->
                </p>
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-12 spec">
          <!-- <hr class="small-hr mt-1 mb-1" /> -->
          <div
            class="spec-head between"
            *ngIf="
              shopping.ShoppingCenter?.ManagerOrganization;
              else findContacts
            "
          ></div>

          <ng-template #findContacts>
            <!-- <a
                class="target"
                href="https://www.google.com/search?q=leasing manager for+{{
                  shopping.CenterName
                }}+{{ shopping.CenterAddress }}+{{ shopping.CenterCity }}+{{
                  
                  shopping.CenterState
                }}+{{
                  shopping.ZipCode
                }}&rlz=1C1FHFK_enEG1100EG1100&oq=city+center&gs_lcrp=EgZjaHJvbWUqCggAEAAYsQMYgAQyDAgAEEUYORixAxiABDIKCAEQABixAxiABDINCAIQLhivARjHARiABDIHCAMQABiABDIKCAQQABixAxiABDINCAUQLhivARjHARiABDIHCAYQABiABDIHCAcQABiABDINCAgQLhivARjHARiABDIHCAkQABiABNIBCDM4MjNqMGo3qAIAsAIA&sourceid=chrome&ie=UTF-8&address={{
                  shopping.CenterAddress
                }},{{ shopping.CenterCity }},{{ shopping.CenterState }},{{
                  shopping.ZipCode
                }}&shoppingCenterName={{
                  shopping.CenterName
                }}&organizationId={{ orgId }}&organizationName={{
                  orgName
                }}&campaignId={{ cId }}"
                target="_blank"
                (click)="
                  finContactMessage(
                    shopping.Id,
                    shopping.CenterName,
                    shopping.CenterAddress
                  )
                "
              >
                Find Contacts
              </a> -->
            <!-- <button
                class="btn find-broker-btn"
                (click)="finContactMessage(shopping)"
              >
                Find Broker
              </button> -->
          </ng-template>
        </div>

        <button
          *ngIf="checkSubmission(shopping?.ShoppingCenter?.UserSubmmision)"
          class="submission-button"
          (click)="
            openModalSubmission(
              shopping?.ShoppingCenter?.UserSubmmision || [],
              submission
            )
          "
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="lucide lucide-file-icon lucide-file"
          >
            <path
              d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"
            />
            <path d="M14 2v4a2 2 0 0 0 2 2h4" />
          </svg>
          View Submissions
        </button>
      </div>
      <div class="stats">
        <div>
          <div
            class="leased-by"
            *ngIf="shopping?.ShoppingCenter?.ManagerOrganization?.length"
            (click)="
              toggleOrgMenu(shopping.Id, $event); $event.stopPropagation()
            "
          >
            <img
              *ngIf="shopping.ManagerORGLogoURL"
              src="{{ shopping.ManagerORGLogoURL }}"
              alt=""
              width="30"
              height="30"
              class="mx-1"
            />
            <span class="MangerORG"> {{ shopping?.ManagerORG || "—" }}</span>
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
            >
              <path
                d="M11.9999 16.3299C9.60992 16.3299 7.66992 14.3899 7.66992 11.9999C7.66992 9.60992 9.60992 7.66992 11.9999 7.66992C14.3899 7.66992 16.3299 9.60992 16.3299 11.9999C16.3299 14.3899 14.3899 16.3299 11.9999 16.3299ZM11.9999 9.16992C10.4399 9.16992 9.16992 10.4399 9.16992 11.9999C9.16992 13.5599 10.4399 14.8299 11.9999 14.8299C13.5599 14.8299 14.8299 13.5599 14.8299 11.9999C14.8299 10.4399 13.5599 9.16992 11.9999 9.16992Z"
                fill="#292D32"
              />
              <path
                d="M12.0001 21.02C8.24008 21.02 4.69008 18.82 2.25008 15C1.19008 13.35 1.19008 10.66 2.25008 8.99998C4.70008 5.17998 8.25008 2.97998 12.0001 2.97998C15.7501 2.97998 19.3001 5.17998 21.7401 8.99998C22.8001 10.65 22.8001 13.34 21.7401 15C19.3001 18.82 15.7501 21.02 12.0001 21.02ZM12.0001 4.47998C8.77008 4.47998 5.68008 6.41998 3.52008 9.80998C2.77008 10.98 2.77008 13.02 3.52008 14.19C5.68008 17.58 8.77008 19.52 12.0001 19.52C15.2301 19.52 18.3201 17.58 20.4801 14.19C21.2301 13.02 21.2301 10.98 20.4801 9.80998C18.3201 6.41998 15.2301 4.47998 12.0001 4.47998Z"
                fill="#292D32"
              />
            </svg>
            <!-- trigger -->
            <div class="org-info-trigger">
              <div
                class="org-mini-menu"
                *ngIf="openOrgMenuId === shopping.Id"
                [ngStyle]="orgMenuPos"
                (click)="$event.stopPropagation()"
              >
                <div
                  *ngFor="
                    let org of shopping.ShoppingCenter.ManagerOrganization;
                    let i = index
                  "
                  class="org-mini-item"
                  (click)="openContactModal(shopping)"
                >
                  <p class="name">
                    {{ org.Firstname | titlecase }}
                    {{ org.LastName | titlecase }}
                  </p>
                  <p class="small">{{ org.CellPhone }}</p>
                  <p class="small">{{ org.Email }}</p>
                  <div
                    class="divider"
                    *ngIf="
                      i < shopping.ShoppingCenter.ManagerOrganization.length - 1
                    "
                  ></div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="actions">
          <div class="pdf" *ngIf="shopping?.DocsLink">
            <a
              class="info-value text-dark"
              href="{{ shopping.DocsLink }}"
              target="_blank"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
              >
                <path
                  d="M15 22.75H9C3.57 22.75 1.25 20.43 1.25 15V9C1.25 3.57 3.57 1.25 9 1.25H14C14.41 1.25 14.75 1.59 14.75 2C14.75 2.41 14.41 2.75 14 2.75H9C4.39 2.75 2.75 4.39 2.75 9V15C2.75 19.61 4.39 21.25 9 21.25H15C19.61 21.25 21.25 19.61 21.25 15V10C21.25 9.59 21.59 9.25 22 9.25C22.41 9.25 22.75 9.59 22.75 10V15C22.75 20.43 20.43 22.75 15 22.75Z"
                  fill="#292D32"
                />
                <path
                  d="M22 10.75H18C14.58 10.75 13.25 9.41999 13.25 5.99999V1.99999C13.25 1.69999 13.43 1.41999 13.71 1.30999C13.99 1.18999 14.31 1.25999 14.53 1.46999L22.53 9.46999C22.74 9.67999 22.81 10.01 22.69 10.29C22.57 10.57 22.3 10.75 22 10.75ZM14.75 3.80999V5.99999C14.75 8.57999 15.42 9.24999 18 9.24999H20.19L14.75 3.80999Z"
                  fill="#292D32"
                />
              </svg>
            </a>
          </div>

          <div class="street-view">
            <a
              class="target"
              (click)="openStreetViewPlace(StreetViewPlace, shopping)"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="16"
                height="16"
                viewBox="0 0 16 16"
                fill="none"
              >
                <path
                  d="M12.875 10.4795C13.4656 10.6906 13.9543 10.9406 14.3145 11.2207C14.7916 11.5918 15 11.9774 15 12.375C15 12.7171 14.8475 13.0452 14.5088 13.3652C14.1632 13.6916 13.6427 13.989 12.9736 14.2383C11.637 14.7362 9.82503 15 8 15C6.17497 15 4.36301 14.7362 3.02637 14.2383C2.35725 13.989 1.83682 13.6916 1.49121 13.3652C1.15247 13.0452 1 12.7171 1 12.375C1 11.9774 1.20837 11.5918 1.68555 11.2207C2.0457 10.9406 2.53444 10.6906 3.125 10.4795V10.752C2.65623 10.925 2.25971 11.1182 1.95801 11.3262C1.77158 11.4547 1.60411 11.5983 1.47949 11.7598C1.3564 11.9192 1.25 12.1291 1.25 12.375C1.25 12.6094 1.34695 12.8109 1.46191 12.9668C1.57781 13.1239 1.73351 13.2641 1.90625 13.3887C2.25197 13.6379 2.73008 13.8684 3.30371 14.0654C4.45653 14.4614 6.07492 14.75 8 14.75C9.92508 14.75 11.5435 14.4614 12.6963 14.0654C13.2699 13.8684 13.748 13.6379 14.0938 13.3887C14.2665 13.2641 14.4222 13.1239 14.5381 12.9668C14.653 12.8109 14.75 12.6094 14.75 12.375C14.75 12.1291 14.6436 11.9192 14.5205 11.7598C14.3959 11.5983 14.2284 11.4547 14.042 11.3262C13.7403 11.1182 13.3438 10.925 12.875 10.752V10.4795ZM8 5C6.68138 5 5.625 6.05638 5.625 7.375V9.79297L5.90137 9.93164L6.875 10.418V12.875H9.125V10.418L10.0986 9.93164L10.375 9.79297V7.375C10.375 6.05638 9.31862 5 8 5ZM8 1.25C7.02562 1.25 6.25 2.02562 6.25 3C6.25 3.97438 7.02562 4.75 8 4.75C8.97438 4.75 9.75 3.97438 9.75 3C9.75 2.02562 8.97438 1.25 8 1.25ZM6.625 10.582L6.34863 10.4434L5.375 9.95605V7.375C5.375 6.47551 5.83943 5.66741 6.54199 5.19141L7.04883 4.84766L6.61133 4.41992C6.23466 4.05112 6 3.54923 6 3C6 1.90163 6.90163 1 8 1C9.09837 1 10 1.90163 10 3C10 3.54923 9.76534 4.05112 9.38867 4.41992L8.95117 4.84766L9.45801 5.19141C10.1606 5.66741 10.625 6.47551 10.625 7.375V9.95605L9.65137 10.4434L9.375 10.582V13.125H6.625V10.582Z"
                  fill="#161017"
                  stroke="#161017"
                />
              </svg>
            </a>
          </div>
          <div class="map-view">
            <a
              class="target"
              (click)="openMapViewPlace(MapViewPlace, shopping)"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
              >
                <path
                  d="M20.3799 21.13C20.1799 21.13 19.9899 21.05 19.8499 20.91L13.4699 14.53C13.1799 14.24 13.1799 13.76 13.4699 13.47L21.2 5.74001C21.39 5.55001 21.6799 5.48001 21.9399 5.55001C22.1999 5.63001 22.3999 5.84001 22.4599 6.10001C22.6499 6.95001 22.7499 7.90001 22.7499 9.00001V15C22.7499 17.77 22.1699 19.64 20.9099 20.91C20.7699 21.05 20.5599 21.08 20.3799 21.13ZM15.0599 14L20.3199 19.26C20.9499 18.29 21.2499 16.91 21.2499 15V9.00001C21.2499 8.59001 21.2399 8.21001 21.2099 7.85001L15.0599 14Z"
                  fill="#292D32"
                />
                <path
                  d="M6.26999 22.48C6.20999 22.48 6.16001 22.47 6.10001 22.46C2.79001 21.7 1.25 19.33 1.25 15V9C1.25 3.57 3.57 1.25 9 1.25H15C19.33 1.25 21.7 2.79001 22.46 6.10001C22.52 6.35001 22.44 6.62 22.26 6.8L6.79999 22.26C6.65999 22.4 6.46999 22.48 6.26999 22.48ZM9 2.75C4.39 2.75 2.75 4.39 2.75 9V15C2.75 18.47 3.71001 20.21 6.04001 20.9L20.89 6.05C20.21 3.72 18.46 2.75999 14.99 2.75999H9V2.75Z"
                  fill="#292D32"
                />
                <path
                  d="M14.9999 22.7499H8.99989C7.89989 22.7499 6.95989 22.6599 6.09989 22.4599C5.82989 22.3999 5.61987 22.1999 5.54987 21.9399C5.46987 21.6799 5.54988 21.3999 5.73988 21.1999L13.4699 13.4699C13.7599 13.1799 14.2399 13.1799 14.5299 13.4699L20.9099 19.8499C21.0499 19.9899 21.1299 20.1799 21.1299 20.3799C21.1299 20.5799 21.0499 20.7699 20.9099 20.9099C19.6399 22.1699 17.7699 22.7499 14.9999 22.7499ZM7.84989 21.2099C8.20989 21.2399 8.58989 21.2499 8.99989 21.2499H14.9999C16.9199 21.2499 18.2899 20.9499 19.2599 20.3199L13.9999 15.0599L7.84989 21.2099Z"
                  fill="#292D32"
                />
                <path
                  d="M9.11994 13.31C8.48994 13.31 7.85993 13.08 7.35993 12.61C5.76993 11.1 5.12996 9.44005 5.50996 7.82005C5.88996 6.16005 7.33994 5.04004 9.11994 5.04004C10.8999 5.04004 12.35 6.16005 12.73 7.82005C13.1 9.45005 12.4599 11.1 10.8699 12.61C10.3799 13.07 9.74994 13.31 9.11994 13.31ZM6.96995 8.15004C6.64995 9.51004 7.56994 10.7301 8.39994 11.5201C8.80994 11.91 9.43994 11.91 9.83994 11.5201C10.6599 10.7401 11.5799 9.52004 11.2699 8.15004C10.9999 6.96004 9.93994 6.53004 9.11994 6.53004C8.29994 6.53004 7.24995 6.96004 6.96995 8.15004Z"
                  fill="#292D32"
                />
                <path
                  d="M9.1499 9.49023C8.5999 9.49023 8.1499 9.04023 8.1499 8.49023C8.1499 7.94023 8.5899 7.49023 9.1499 7.49023H9.15991C9.70991 7.49023 10.1599 7.94023 10.1599 8.49023C10.1599 9.04023 9.6999 9.49023 9.1499 9.49023Z"
                  fill="#292D32"
                />
              </svg>
            </a>
          </div>
        </div>
      </div>
    </div>
  </ng-container>
</div>

<div *ngIf="hasUnscoredCenters">
  <h3 class="split-heading">
    <span>Emily is working on</span>
    scoring these Sites
    <span class="stat-bars" aria-hidden="true">
      <span></span><span></span><span></span><span></span><span></span
      ><span></span>
    </span>
  </h3>

  <table class=" ">
    <thead class=" ">
      <tr>
        <th>Name</th>
        <th>Brokerage Firm</th>
        <th>Date</th>
        <th>Score</th>
        <th>Type</th>
        <th>Category</th>

        <th>Size Range</th>
        <!-- <th *ngIf="hasAnyStages">Stage Name</th> -->
        <!-- *ngIf="placesRepresentative" -->
        <!-- <th > -->
        <!-- <ng-container >
          <th
            *ngFor="
              let item of shoppingCenters[0].ShoppingCenter.BuyBoxPlaces;
             "
          >
           </th>
        </ng-container> -->
        <!-- </th> -->
        <!-- <th>Actions</th> -->
      </tr>
    </thead>
    <tbody class=" ">
      <ng-container *ngFor="let shopping of cardsSideList; trackBy: trackById">
        <tr *ngIf="!shopping.MainImage">
          <td>
            <div
              [ngClass]="{
                green: shopping.Score > 50,
                yellow: shopping.Score < 50,
                red: !shopping.Score
              }"
              class="d-flex flex-column"
            >
              <!-- <div
            (click)="deleteCenter(shopping.Id); $event.stopPropagation()"
            class="card-badge delete-badge"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
            >
              <path
                d="M21 5.98001C17.67 5.65001 14.32 5.48001 10.98 5.48001C9 5.48001 7.02 5.58001 5.04 5.78001L3 5.98001"
                stroke="#292D32"
                stroke-width="1.5"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
              <path
                d="M8.5 4.97L8.72 3.66C8.88 2.71 9 2 10.69 2H13.31C15 2 15.13 2.75 15.28 3.67L15.5 4.97"
                stroke="#292D32"
                stroke-width="1.5"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
              <path
                d="M18.85 9.14001L18.2 19.21C18.09 20.78 18 22 15.21 22H8.78999C5.99999 22 5.90999 20.78 5.79999 19.21L5.14999 9.14001"
                stroke="#292D32"
                stroke-width="1.5"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
              <path
                d="M10.33 16.5H13.66"
                stroke="#292D32"
                stroke-width="1.5"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
              <path
                d="M9.5 12.5H14.5"
                stroke="#292D32"
                stroke-width="1.5"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
          </div>    -->
              <div class="d-flex flex-row justify-content-between">
                <span
                  class="table-text"
                  [innerHTML]="shopping.CenterName | titlecase"
                ></span>

                <div
                  class="relativee d-flex justify-content-between flex-row gap-3"
                  style="position: relative"
                >
                  <button
                    class="plus-icon"
                    (click)="
                      InsertAutomation(shopping.Id); $event.stopPropagation()
                    "
                  >
                    <i class="fa-solid fa-plus"></i>
                  </button>
                  <div>
                    <div
                      class="menu-wrapper"
                      (click)="$event.stopPropagation()"
                      [ngClass]="{ 'opened-menu': openMenuId === shopping.Id }"
                    >
                      <button
                        class="menu-btn"
                        (click)="toggleMenu(shopping.Id, $event)"
                      >
                        <svg
                          xmlns="http://www.w3.org/2000/svg"
                          width="20"
                          height="20"
                          viewBox="0 0 20 20"
                          fill="none"
                        >
                          <path
                            d="M4.16699 8.20801C5.15737 8.20818 5.95801 9.00958 5.95801 10C5.95783 10.9903 5.15726 11.7908 4.16699 11.791C3.17658 11.791 2.37518 10.9904 2.375 10C2.375 9.00948 3.17647 8.20801 4.16699 8.20801ZM4.16699 8.45801C3.31585 8.45801 2.625 9.14886 2.625 10C2.62518 10.851 3.31596 11.541 4.16699 11.541C5.01788 11.5408 5.70783 10.8509 5.70801 10C5.70801 9.14897 5.01799 8.45818 4.16699 8.45801Z"
                            fill="#18171F"
                            stroke="#18171F"
                          />
                          <path
                            d="M15.8334 12.2913C14.5667 12.2913 13.5417 11.2663 13.5417 9.99967C13.5417 8.73301 14.5667 7.70801 15.8334 7.70801C17.1001 7.70801 18.1251 8.73301 18.1251 9.99967C18.1251 11.2663 17.1001 12.2913 15.8334 12.2913ZM15.8334 8.95801C15.2584 8.95801 14.7917 9.42467 14.7917 9.99967C14.7917 10.5747 15.2584 11.0413 15.8334 11.0413C16.4084 11.0413 16.8751 10.5747 16.8751 9.99967C16.8751 9.42467 16.4084 8.95801 15.8334 8.95801Z"
                            fill="#18171F"
                          />
                          <path
                            d="M9.99992 12.2913C8.73325 12.2913 7.70825 11.2663 7.70825 9.99967C7.70825 8.73301 8.73325 7.70801 9.99992 7.70801C11.2666 7.70801 12.2916 8.73301 12.2916 9.99967C12.2916 11.2663 11.2666 12.2913 9.99992 12.2913ZM9.99992 8.95801C9.42492 8.95801 8.95825 9.42467 8.95825 9.99967C8.95825 10.5747 9.42492 11.0413 9.99992 11.0413C10.5749 11.0413 11.0416 10.5747 11.0416 9.99967C11.0416 9.42467 10.5749 8.95801 9.99992 8.95801Z"
                            fill="#18171F"
                          />
                        </svg>
                      </button>

                      <!-- DROPDOWN -->
                      <div
                        class="menu-dropdown"
                        *ngIf="openMenuId === shopping.Id"
                      >
                        <button
                          [routerLink]="['/landing',shopping?.ShoppingCenter?.Places?.[0]?.Id || 0,shopping?.Id,shopping.CampaignId]"
                          class="menu-item"
                          (click)="closeMenu()"
                        >
                          View Details
                        </button>

                        <button
                          class="menu-item"
                          (click)="openContactModal(shopping); closeMenu()"
                        >
                          Contact Broker
                        </button>
                        <button
                          class="menu-item"
                          (click)="
                            openMapViewPlace(MapViewPlace, shopping);
                            closeMenu()
                          "
                        >
                          View Location
                        </button>
                        <button
                          class="menu-item"
                          (click)="
                            openStreetViewPlace(StreetViewPlace, shopping);
                            closeMenu()
                          "
                        >
                          Street View
                        </button>
                        <button
                          *ngIf="
                            checkSubmission(
                              shopping?.ShoppingCenter?.UserSubmmision
                            )
                          "
                          class="menu-item"
                          (click)="
                            openModalSubmission(
                              shopping?.ShoppingCenter?.UserSubmmision || [],
                              submission
                            );
                            closeMenu()
                          "
                        >
                          View Submissions
                        </button>

                        <button
                          class="menu-item"
                          (click)="
                            openAddContactModal(shopping.Id); closeMenu()
                          "
                        >
                          Add Contact
                        </button>
                        <button
                          class="menu-item"
                          (click)="
                            deleteCenter(shopping.Id); $event.stopPropagation()
                          "
                        >
                          Delete Center
                        </button>
                      </div>
                    </div>
                    <div
                      class="click-shield"
                      *ngIf="
                        openStageId === shopping.Id ||
                        openMenuId === shopping.Id
                      "
                      (click)="closeMenu()"
                    ></div>
                  </div>
                </div>
              </div>

              <div
                *ngIf="
                  shopping.CenterAddress ||
                  shopping.CenterCity ||
                  shopping.CenterState
                "
              >
                <div
                  class="table-text cursor addresss"
                  (click)="openMapViewPlace(MapViewPlace, shopping)"
                >
                  {{ shopping.CenterAddress }}
                  <span *ngIf="shopping.CenterCity">,</span>

                  {{ shopping.CenterCity | titlecase }}
                  <span *ngIf="shopping.CenterState">,</span>

                  {{ shopping.CenterState }}
                </div>
              </div>
              <div
                *ngIf="KanbanStages.length > 0"
                #dropdownRef
                class="menu-wrapper"
                [ngClass]="{ 'opened-stage': openStageId === shopping.Id }"
                style="width: fit-content"
              >
                <div
                  class="selected-option"
                  (click)="toggleMenu(shopping.Id, $event, true)"
                >
                  {{ getSelectedStageName(shopping.kanbanStageId) }}
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="16"
                    height="16"
                    viewBox="0 0 16 16"
                    fill="none"
                  >
                    <path
                      d="M8.00001 11.2C7.53335 11.2 7.06668 11.0201 6.71335 10.6667L2.36668 6.32005C2.17335 6.12672 2.17335 5.80672 2.36668 5.61338C2.56001 5.42005 2.88001 5.42005 3.07335 5.61338L7.42001 9.96005C7.74001 10.2801 8.26001 10.2801 8.58001 9.96005L12.9267 5.61338C13.12 5.42005 13.44 5.42005 13.6333 5.61338C13.8267 5.80672 13.8267 6.12672 13.6333 6.32005L9.28668 10.6667C8.93335 11.0201 8.46668 11.2 8.00001 11.2Z"
                      fill="#161017"
                    />
                  </svg>
                </div>
                <div
                  (click)="$event.stopPropagation()"
                  class="dropdown-options"
                  [class.show]="openStageId === shopping.Id"
                >
                  <div
                    *ngFor="let stage of KanbanStages"
                    class="dropdown-item"
                    [class.active]="stage.id === shopping.kanbanStageId"
                    (click)="
                      selectStage(
                        shopping.MarketSurveyId,
                        stage.id,
                        shopping,
                        $event
                      )
                    "
                  >
                    {{ stage.stageName }}
                  </div>
                </div>
              </div>
              <div>
                <span
                  class="badge badge-danger mx-2 h-auto"
                  *ngIf="shopping.Deleted == true"
                  >Deleted</span
                >
              </div>
            </div>
          </td>

          <td class="ManagerOrg">{{ shopping.ManagerORG }}</td>
          <td class="last-update">{{ shopping.LastUpdateDate | date }}</td>
          <td class="score" *ngIf="shopping.Score !== null">
            <span class="d-flex align-items-center"
              >{{ shopping.Score + "%" }}
              <button
                class="icon-btn"
                (click)="openInfoPopup(shopping, infoModal)"
              >
                <i class="fa-solid fa-circle-info"></i></button
            ></span>
          </td>
          <td class="type">{{ shopping.CenterType }}</td>
          <td class="category">{{ shopping.Category }}</td>
          <td *ngIf="shopping.sizeRange as sr">
            <div>
              <ng-container *ngIf="sr; instanceof: Array; else: single">
                {{ sr[0] | number }} - {{ sr[1] | number }} SF
              </ng-container>
              <ng-template #single> {{ sr | number }} SF </ng-template>
            </div>
          </td>
          <!-- <td *ngIf="shoppingCenter.stageName">
          <div #dropdownRef class="custom-dropdown">
            <div
              class="selected-option"
              (click)="toggleDropdown(shoppingCenter, $event)"
            >
              {{ getSelectedStageName(shoppingCenter.kanbanStageId) }}
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="16"
                height="16"
                viewBox="0 0 16 16"
                fill="none"
              >
                <path
                  d="M8.00001 11.2C7.53335 11.2 7.06668 11.0201 6.71335 10.6667L2.36668 6.32005C2.17335 6.12672 2.17335 5.80672 2.36668 5.61338C2.56001 5.42005 2.88001 5.42005 3.07335 5.61338L7.42001 9.96005C7.74001 10.2801 8.26001 10.2801 8.58001 9.96005L12.9267 5.61338C13.12 5.42005 13.44 5.42005 13.6333 5.61338C13.8267 5.80672 13.8267 6.12672 13.6333 6.32005L9.28668 10.6667C8.93335 11.0201 8.46668 11.2 8.00001 11.2Z"
                  fill="#161017"
                />
              </svg>
            </div>
            <div
              class="dropdown-options"
              [class.show]="shoppingCenter.isDropdownOpen"
            >
              <div
                *ngFor="let stage of KanbanStages"
                class="dropdown-item"
                [class.active]="stage.id === shoppingCenter.kanbanStageId"
                (click)="
                  selectStage(
                    shoppingCenter.MarketSurveyId,
                    stage.id,
                    shoppingCenter,
                    $event
                  )
                "
              >
                {{ stage.stageName }}
              </div>
            </div>
          </div>
          <p class="table-text ShoppingCenterStage mb-1">
            {{ shoppingCenter.stageName }}
          </p>
        </td> -->
          <!-- *ngIf="placesRepresentative" -->
          <!-- <td>
            <ng-container *ngIf="shopping.ShoppingCenter?.ManagerOrganization">
              <div>
                <div
                  class="d-flex align-items-center justify-content-between table-div"
                >
                  <img loading="lazy" 
                  class="logo"
                  src="https://api.cherrypick.com/api/Organization/GetOrgImag?orgId={{
                    shoppingCenter.ShoppingCenter.ManagerOrganization[0].ID
                  }}"
                  [title]="
                    shoppingCenter.ShoppingCenter.ManagerOrganization[0]
                      .Name
                  "
                  alt=""
                />
                  <div class="table-text">
                    {{ shopping.ShoppingCenter.ManagerOrganization[0].Name }}
                  </div>

                  trigger
                  <div
                  class="org-info-trigger"
                  (click)="toggleOrgMenu($event, shoppingCenter.Id)"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="none"
                  >
                    <path
                      d="M11.9999 16.3299C9.60992 16.3299 7.66992 14.3899 7.66992 11.9999C7.66992 9.60992 9.60992 7.66992 11.9999 7.66992C14.3899 7.66992 16.3299 9.60992 16.3299 11.9999C16.3299 14.3899 14.3899 16.3299 11.9999 16.3299ZM11.9999 9.16992C10.4399 9.16992 9.16992 10.4399 9.16992 11.9999C9.16992 13.5599 10.4399 14.8299 11.9999 14.8299C13.5599 14.8299 14.8299 13.5599 14.8299 11.9999C14.8299 10.4399 13.5599 9.16992 11.9999 9.16992Z"
                      fill="#292D32"
                    />
                    <path
                      d="M12.0001 21.02C8.24008 21.02 4.69008 18.82 2.25008 15C1.19008 13.35 1.19008 10.66 2.25008 8.99998C4.70008 5.17998 8.25008 2.97998 12.0001 2.97998C15.7501 2.97998 19.3001 5.17998 21.7401 8.99998C22.8001 10.65 22.8001 13.34 21.7401 15C19.3001 18.82 15.7501 21.02 12.0001 21.02ZM12.0001 4.47998C8.77008 4.47998 5.68008 6.41998 3.52008 9.80998C2.77008 10.98 2.77008 13.02 3.52008 14.19C5.68008 17.58 8.77008 19.52 12.0001 19.52C15.2301 19.52 18.3201 17.58 20.4801 14.19C21.2301 13.02 21.2301 10.98 20.4801 9.80998C18.3201 6.41998 15.2301 4.47998 12.0001 4.47998Z"
                      fill="#292D32"
                    />
                  </svg>
                </div>
                </div>

               org-mini-item <div
                  class="org-mini-menu"
                  *ngIf="openOrgMenuId === shoppingCenter.Id"
                  [ngStyle]="orgMenuPos"
                  (click)="$event.stopPropagation()"
                >
                  <div
                    *ngFor="
                      let org of shopping.ShoppingCenter.ManagerOrganization;
                      let i = index
                    "
                    class="org-mini-item"
                  >
                    <p class="name">
                      {{ org.Firstname | titlecase }}
                      {{ org.LastName | titlecase }}
                    </p>
                    <p class="small">{{ org.CellPhone }}</p>
                    <p class="small">{{ org.Email }}</p>
                    <div
                      class="divider"
                      *ngIf="
                        i <
                        shopping.ShoppingCenter.ManagerOrganization.length - 1
                      "
                    ></div>
                  </div>
                </div>
              </div>
            </ng-container>
          </td> -->

          <!-- <td *ngIf="shoppingCenters[0].ShoppingCenter">
          <ng-container
            *ngIf="
              shoppingCenter?.ShoppingCenter?.BuyBoxPlaces;
              else emptyTd
            "
          >
            <ng-container
              *ngFor="
                let item of shoppingCenter?.ShoppingCenter?.BuyBoxPlaces;
                let i = index;
                trackBy: trackByIndex
              "
            >
              <div class="d-flex align-items-center justify-content-center">
                <img loading="lazy" 
                  class="logo"
                  src="https://api.cherrypick.com/api/Organization/GetOrgImag?orgId={{
                    item.RelationOrganizationId
                  }}"
                  [title]="item.RelationOrganizationName"
                  alt=""
                />
                <span>{{ item.RelationOrganizationName }}</span>
                <div
                  class="d-flex align-items-center justify-content-center"
                >
                  <span class="ms-2 table-text"> </span>
                </div>
              </div>
            </ng-container>
          </ng-container>
        </td> -->
          <ng-template #emptyTd> </ng-template>
        </tr>
      </ng-container>
    </tbody>
  </table>
</div>

<ng-template #MapViewPlace let-modal>
  <div id="mappopup" class="h700"></div>
</ng-template>

<ng-template #ShareLink let-modal>
  <div class="d-flex p-3 m-3 align-items-center shareelink">
    <p>{{ shareLink }}</p>
    <i class="fa-solid fa-copy ms-3 cursor" (click)="copyLink(shareLink)"></i>
  </div>
</ng-template>

<!-- <ng-template #StreetViewPlace let-modal>
  <div *ngIf="General.modalObject.StreetViewURL">
    <iframe
      [src]="sanitizedUrl"
      height="700"
      width="798px"
      class="sanitizedUrl"
      allowfullscreen=""
    >
    </iframe>
  </div>
  <div
    id="street-view"
    class="h700"
    *ngIf="!General.modalObject.StreetViewURL"
  ></div>
</ng-template> -->
<ng-template #StreetViewPlace let-modal>
  <div id="street-view" class="h700"></div>
</ng-template>

<ng-template #deleteSingleShoppingCenterModal let-modal>
  <div class="modal-body-general p-4 rounded deleteShopping">
    <h2 class="text-center mb-4 RemoveShopping">Remove Shopping Center</h2>
    <p class="text-center Areyou">
      Are you sure you want to remove this Shopping Center?
    </p>

    <div class="d-flex justify-content-end mt-4">
      <button
        type="button"
        class="btn btn-secondary me-2 px-4 py-2 btnborder"
        (click)="modal.dismiss('Cancel click')"
      >
        Cancel
      </button>
    </div>
  </div>
</ng-template>

<ng-template #statusModal let-modal>
  <div class="modal-header">
    <h5 class="modal-title">Center Status</h5>
    <button
      type="button"
      class="btn-close"
      aria-label="Close"
      (click)="modal.dismiss()"
    ></button>
  </div>
  <div class="modal-body">
    <div *ngIf="isLoadingstatus; else contentTemplate">
      <div class="skeleton-loader">
        <div
          class="skeleton-head"
          style="
            height: 24px;
            width: 40%;
            margin-bottom: 16px;
            border-radius: 4px;
            background-color: #e0e0e0;
          "
        ></div>
        <div class="skeleton-paragraph">
          <div
            class="skeleton-line"
            style="
              height: 16px;
              width: 100%;
              margin-bottom: 8px;
              border-radius: 4px;
              background-color: #e0e0e0;
            "
          ></div>
          <div
            class="skeleton-line"
            style="
              height: 16px;
              width: 95%;
              margin-bottom: 8px;
              border-radius: 4px;
              background-color: #e0e0e0;
            "
          ></div>
          <div
            class="skeleton-line"
            style="
              height: 16px;
              width: 90%;
              border-radius: 4px;
              background-color: #e0e0e0;
            "
          ></div>
        </div>
      </div>
    </div>
    <ng-template #contentTemplate>
      <div [innerHTML]="htmlContent"></div>
    </ng-template>
  </div>
</ng-template>

<ng-template #submission let-modal>
  <div class="modal-header d-flex justify-content-between">
    <h4 class="modal-title">Submissions</h4>
    <button
      type="button"
      class="close"
      style="background: none; border: none"
      aria-label="Close"
      (click)="modal.dismiss()"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
      >
        <path
          d="M12 22.75C6.07 22.75 1.25 17.93 1.25 12C1.25 6.07 6.07 1.25 12 1.25C17.93 1.25 22.75 6.07 22.75 12C22.75 17.93 17.93 22.75 12 22.75ZM12 2.75C6.9 2.75 2.75 6.9 2.75 12C2.75 17.1 6.9 21.25 12 21.25C17.1 21.25 21.25 17.1 21.25 12C21.25 6.9 17.1 2.75 12 2.75Z"
          fill="#7A8591"
        />
        <path
          d="M9.16986 15.5799C8.97986 15.5799 8.78986 15.5099 8.63986 15.3599C8.34986 15.0699 8.34986 14.5899 8.63986 14.2999L14.2999 8.63986C14.5899 8.34986 15.0699 8.34986 15.3599 8.63986C15.6499 8.92986 15.6499 9.40986 15.3599 9.69986L9.69986 15.3599C9.55986 15.5099 9.35986 15.5799 9.16986 15.5799Z"
          fill="#7A8591"
        />
        <path
          d="M14.8299 15.5799C14.6399 15.5799 14.4499 15.5099 14.2999 15.3599L8.63986 9.69986C8.34986 9.40986 8.34986 8.92986 8.63986 8.63986C8.92986 8.34986 9.40986 8.34986 9.69986 8.63986L15.3599 14.2999C15.6499 14.5899 15.6499 15.0699 15.3599 15.3599C15.2099 15.5099 15.0199 15.5799 14.8299 15.5799Z"
          fill="#7A8591"
        />
      </svg>
    </button>
  </div>
  <div class="modal-body">
    <div *ngFor="let submission of submissions">
      <div class="submission-details" *ngIf="submission?.SubmmisionLink">
        <div class="detailsInfo d-flex flex-column">
          <a
            [href]="
              'https://files.cherrypick.com/submissions/' +
              submission?.SubmmisionLink
            "
            target="_blank"
            class="submission-link"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="8"
              height="8"
              viewBox="0 0 8 8"
              fill="none"
            >
              <circle cx="4" cy="4" r="4" fill="#16181D" />
            </svg>

            https://files.cherrypick.com/submissions/' +
            submission?.SubmmisionLink
          </a>

          <div class="user-info d-flex flex-row">
            <p *ngIf="submission?.FirstName">
              {{ submission?.FirstName + " " + submission?.LastName }}
            </p>
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="8"
              height="8"
              viewBox="0 0 8 8"
              fill="none"
            >
              <circle cx="4" cy="4" r="4" fill="#E2E4E9" />
            </svg>
            <p *ngIf="submission?.CreatedDate">
              {{ submission?.CreatedDate | date : "MMM dd, yyyy" }}
            </p>
          </div>
          <p class="available-space" *ngIf="submission?.AvailableSpace">
            Available Space:{{ submission?.AvailableSpace }} SF
          </p>
        </div>
        <div class="progress-bar-container">
          <div class="match-percentage">
            <div class="circle-progress">
              <svg viewBox="0 0 36 36" class="circle-svg">
                <path
                  class="circle-bg"
                  d="M18 2.0845
                    a 15.9155 15.9155 0 0 1 0 31.831
                    a 15.9155 15.9155 0 0 1 0 -31.831"
                  [style.stroke-dasharray]="
                    getCircleProgressBackground(submission?.Percentage)
                  "
                />
                <path
                  class="circle-fg"
                  d="M18 2.0845
                    a 15.9155 15.9155 0 0 1 0 31.831
                    a 15.9155 15.9155 0 0 1 0 -31.831"
                  [style.stroke-dasharray]="
                    getCircleProgress(submission?.Percentage)
                  "
                />
              </svg>
              <div class="circle-label">
                <span class="match">Match</span>
                <span class="match-percentage"
                  >{{ submission?.Percentage }}%</span
                >
              </div>
            </div>
          </div>
        </div>
      </div>
      <br />
    </div>
  </div>
</ng-template>

<ng-template #mailModal let-modal>
  <div class="modal-body" style="height: 90vh; overflow-y: auto">
    <div>
      <label for="">Email Subject</label>
      <div class="mail-body" [innerHTML]="openedEmail.Subject"></div>
    </div>
    <div class="date">
      {{ openedEmail.Date | date : "EEEE, MMMM d, y" }} at
      {{ openedEmail.Date | date : "h:mm a" }}
    </div>

    <div>
      <label for="">Email Body</label>
      <div class="mail-body" [innerHTML]="openedEmail.Body"></div>
    </div>
  </div>
</ng-template>
<ng-template #infoModal let-modal>
  <div class="modal-header score-header">
    <h5 class="modal-title score-pill">{{ score || 0 }}%</h5>
    <button
      type="button"
      class="btn-close"
      aria-label="Close"
      (click)="modal.dismiss()"
    ></button>
  </div>

  <div class="modal-body score-body">
    <div *ngIf="isLoadingInfo" class="loading">Loading...</div>

    <p class="conclusion-text">{{ conclusion }}</p>

    <div *ngIf="!isLoadingInfo">
      <div
        *ngIf="infoData; else noData"
        class="rationale-text"
        [innerHTML]="infoData"
      ></div>

      <ng-template #noData>
        <!-- <p>No rationale found.</p> -->
      </ng-template>
    </div>
  </div>
</ng-template>
