<div >
  <!-- Skeleton loading for table -->
  <!-- <div *ngIf="isLoading">
    <table class="procpect-table">
      <thead class="procpect-table-head">
        <tr>
          <th><div class="skeleton-header"></div></th>
          <th><div class="skeleton-header"></div></th>
          <th><div class="skeleton-header"></div></th>
          <th><div class="skeleton-header"></div></th>
          <th><div class="skeleton-header"></div></th>
          <th><div class="skeleton-header"></div></th>
          <th><div class="skeleton-header"></div></th>
        </tr>
      </thead>
      <tbody class="procpect-table-body">
        <ng-container
          *ngFor="let i of [1, 2, 3, 4, 5, 6, 7, 8]; trackBy: trackByIndex"
        >
          <tr>
            <td><div class="skeleton-cell"></div></td>
            <td><div class="skeleton-cell"></div></td>
            <td><div class="skeleton-cell"></div></td>
            <td><div class="skeleton-cell"></div></td>
            <td><div class="skeleton-cell"></div></td>
            <td><div class="skeleton-cell"></div></td>
            <td><div class="skeleton-cell-small"></div></td>
          </tr>
        </ng-container>
      </tbody>
    </table>
  </div> -->
  <div id="customToastsuccess" class="custom-toast">
    <div class="toast-content">
      <p id="toastMessagesuccess"></p>
    </div>
  </div>
  <!-- Main content -->
  <div
    *ngIf="
       showShoppingCenters &&
      shoppingCenters &&
      shoppingCenters.length > 0
    "
   >
    <table   class=" ">
      <thead class=" ">
        <tr>
          <th>Name</th>
          <th>Brokerage Firm</th>
          <th>Date</th>
          <th>Score</th>
          <th>Type</th>
          <th>Category</th>

          <th *ngIf="hasAnySizeRange">Size Range</th>
          <!-- <th *ngIf="hasAnyStages">Stage Name</th> -->
          <!-- *ngIf="placesRepresentative" -->
         
          <!-- <th>Actions</th> -->
        </tr>
      </thead>
      <tbody class=" ">
        <ng-container
          *ngFor="
            let shoppingCenter of filteredCenters;
            trackBy: trackByShoppingCenterId
          "
        >
          <tr  *ngIf="shoppingCenter.CenterName">
            <td>
              <div
              [ngClass]="{
                green: shoppingCenter.Score > 50,
                yellow: shoppingCenter.Score < 50,
                red: !shoppingCenter.Score
              }"
              class="d-flex flex-column"
            >
              <!-- <div
            (click)="deleteCenter(shoppingCenter.Id); $event.stopPropagation()"
            class="card-badge delete-badge"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
            >
              <path
                d="M21 5.98001C17.67 5.65001 14.32 5.48001 10.98 5.48001C9 5.48001 7.02 5.58001 5.04 5.78001L3 5.98001"
                stroke="#292D32"
                stroke-width="1.5"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
              <path
                d="M8.5 4.97L8.72 3.66C8.88 2.71 9 2 10.69 2H13.31C15 2 15.13 2.75 15.28 3.67L15.5 4.97"
                stroke="#292D32"
                stroke-width="1.5"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
              <path
                d="M18.85 9.14001L18.2 19.21C18.09 20.78 18 22 15.21 22H8.78999C5.99999 22 5.90999 20.78 5.79999 19.21L5.14999 9.14001"
                stroke="#292D32"
                stroke-width="1.5"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
              <path
                d="M10.33 16.5H13.66"
                stroke="#292D32"
                stroke-width="1.5"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
              <path
                d="M9.5 12.5H14.5"
                stroke="#292D32"
                stroke-width="1.5"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
          </div>    -->
              <div class="d-flex flex-row justify-content-between">
                <span
                  class="table-text"
                  [innerHTML]="shoppingCenter.CenterName | titlecase"
                ></span>

                <div
                  class="relativee d-flex justify-content-between flex-row gap-3"
                  style="position: relative"
                >
                  <button
                    class="plus-icon"
                    (click)="
                      InsertAutomation(shoppingCenter.Id); $event.stopPropagation()
                    "
                  >
                    <i class="fa-solid fa-plus"></i>
                  </button>
                  <div>
                    <div
                      class="menu-wrapper"
                      (click)="$event.stopPropagation()"
                    >
                      <button
                        class="menu-btn"
                        (click)="toggleMenu(shoppingCenter.Id, $event)"
                      >
                        <svg
                           xmlns="http://www.w3.org/2000/svg"
                          width="20"
                          height="20"
                          viewBox="0 0 20 20"
                          fill="none"
                        >
                          <path
                            d="M4.16699 8.20801C5.15737 8.20818 5.95801 9.00958 5.95801 10C5.95783 10.9903 5.15726 11.7908 4.16699 11.791C3.17658 11.791 2.37518 10.9904 2.375 10C2.375 9.00948 3.17647 8.20801 4.16699 8.20801ZM4.16699 8.45801C3.31585 8.45801 2.625 9.14886 2.625 10C2.62518 10.851 3.31596 11.541 4.16699 11.541C5.01788 11.5408 5.70783 10.8509 5.70801 10C5.70801 9.14897 5.01799 8.45818 4.16699 8.45801Z"
                            fill="#18171F"
                            stroke="#18171F"
                          />
                          <path
                            d="M15.8334 12.2913C14.5667 12.2913 13.5417 11.2663 13.5417 9.99967C13.5417 8.73301 14.5667 7.70801 15.8334 7.70801C17.1001 7.70801 18.1251 8.73301 18.1251 9.99967C18.1251 11.2663 17.1001 12.2913 15.8334 12.2913ZM15.8334 8.95801C15.2584 8.95801 14.7917 9.42467 14.7917 9.99967C14.7917 10.5747 15.2584 11.0413 15.8334 11.0413C16.4084 11.0413 16.8751 10.5747 16.8751 9.99967C16.8751 9.42467 16.4084 8.95801 15.8334 8.95801Z"
                            fill="#18171F"
                          />
                          <path
                            d="M9.99992 12.2913C8.73325 12.2913 7.70825 11.2663 7.70825 9.99967C7.70825 8.73301 8.73325 7.70801 9.99992 7.70801C11.2666 7.70801 12.2916 8.73301 12.2916 9.99967C12.2916 11.2663 11.2666 12.2913 9.99992 12.2913ZM9.99992 8.95801C9.42492 8.95801 8.95825 9.42467 8.95825 9.99967C8.95825 10.5747 9.42492 11.0413 9.99992 11.0413C10.5749 11.0413 11.0416 10.5747 11.0416 9.99967C11.0416 9.42467 10.5749 8.95801 9.99992 8.95801Z"
                            fill="#18171F"
                          />
                        </svg>
                      </button>

                      <!-- DROPDOWN -->
                      <div
                        class="menu-dropdown"
                        *ngIf="openMenuId === shoppingCenter.Id"
                      >
                        <button
                          [routerLink]="['/landing',shoppingCenter?.ShoppingCenter?.Places?.[0]?.Id || 0,shoppingCenter?.Id,shoppingCenter.CampaignId]"
                          class="menu-item"
                          (click)="closeMenu()"
                        >
                          View Details
                        </button>

                        <button
                          class="menu-item"
                          (click)="openContactModal(shoppingCenter); closeMenu()"
                        >
                          Contact Broker
                        </button>
                        <button
                          class="menu-item"
                          (click)="
                            openMapViewPlace(MapViewPlace, shoppingCenter);
                            closeMenu()
                          "
                        >
                          View Location
                        </button>
                        <button
                          class="menu-item"
                          (click)="
                            openStreetViewPlace(StreetViewPlace, shoppingCenter);
                            closeMenu()
                          "
                        >
                          Street View
                        </button>
                        <button
                          *ngIf="
                            checkSubmission(
                              shoppingCenter?.ShoppingCenter?.UserSubmmision
                            )
                          "
                          class="menu-item"
                          (click)="
                            openModalSubmission(
                              shoppingCenter?.ShoppingCenter?.UserSubmmision || [],
                              submission
                            );
                            closeMenu()
                          "
                        >
                          View Submissions
                        </button>

                        <button
                          class="menu-item"
                          (click)="
                            openAddContactModal(shoppingCenter.Id); closeMenu()
                          "
                        >
                          Add Contact
                        </button>
                        <button
                          class="menu-item"
                          (click)="
                            deleteCenter(shoppingCenter.Id); $event.stopPropagation()
                          "
                        >
                          Delete Center
                        </button>
                      </div>
                    </div>
                    <div
                      class="click-shield"
                      *ngIf="
                        openStageId === shoppingCenter.Id ||
                        openMenuId === shoppingCenter.Id
                      "
                      (click)="closeMenu()"
                    ></div>
                  </div>
                </div>
              </div>

              <div
                *ngIf="
                  shoppingCenter.CenterAddress ||
                  shoppingCenter.CenterCity ||
                  shoppingCenter.CenterState
                "
              >
                <div
                  class="table-text cursor addresss"
                  (click)="openMapViewPlace(MapViewPlace, shoppingCenter)"
                >
                  {{ shoppingCenter.CenterAddress }}
                  <span *ngIf="shoppingCenter.CenterCity">,</span>

                  {{ shoppingCenter.CenterCity | titlecase }}
                  <span *ngIf="shoppingCenter.CenterState">,</span>

                  {{ shoppingCenter.CenterState }}
                </div>
              </div>
              <div
                *ngIf="KanbanStages.length > 0"
                #dropdownRef
                class="menu-wrapper"
                style="width: fit-content; z-index: 1"
              >
                <div
                  class="selected-option"
                  *ngIf="!openStageId || openStageId == shoppingCenter.Id"

                  (click)="toggleMenu(shoppingCenter.Id, $event, true)"
                >
                  {{ getSelectedStageName(shoppingCenter.kanbanStageId) }}
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="16"
                    height="16"
                    viewBox="0 0 16 16"
                    fill="none"
                  >
                    <path
                      d="M8.00001 11.2C7.53335 11.2 7.06668 11.0201 6.71335 10.6667L2.36668 6.32005C2.17335 6.12672 2.17335 5.80672 2.36668 5.61338C2.56001 5.42005 2.88001 5.42005 3.07335 5.61338L7.42001 9.96005C7.74001 10.2801 8.26001 10.2801 8.58001 9.96005L12.9267 5.61338C13.12 5.42005 13.44 5.42005 13.6333 5.61338C13.8267 5.80672 13.8267 6.12672 13.6333 6.32005L9.28668 10.6667C8.93335 11.0201 8.46668 11.2 8.00001 11.2Z"
                      fill="#161017"
                    />
                  </svg>
                </div>
                <div
                  (click)="$event.stopPropagation()"
                  class="dropdown-options"
                  [class.show]="openStageId === shoppingCenter.Id"
                >
                  <div
                    *ngFor="let stage of KanbanStages"
                    class="dropdown-item"
                    [class.active]="stage.id === shoppingCenter.kanbanStageId"
                    (click)="
                      selectStage(
                        shoppingCenter.MarketSurveyId,
                        stage.id,
                        shoppingCenter,
                        $event
                      )
                    "
                  >
                    {{ stage.stageName }}
                  </div>
                </div>
              </div>
              <div>
                <span
                  class="badge badge-danger mx-2 h-auto"
                  *ngIf="shoppingCenter.Deleted == true"
                  >Deleted</span
                >
              </div>
            </div>
            </td>

            <td class="ManagerOrg">{{ shoppingCenter.ManagerORG }}</td>
            <td class="last-update">{{ shoppingCenter.LastUpdateDate |date}}</td>
            <td class="score"  ><span class="d-flex align-items-center" *ngIf="shoppingCenter.Score">{{ shoppingCenter.Score +'%'}} <button 
              class="icon-btn" 
              (click)="openInfoPopup(shoppingCenter, infoModal)">
              <i class="fa-solid fa-circle-info"></i>
            </button></span> 
           
             </td>
            <td class="type">{{ shoppingCenter.CenterType }}</td>
            <td class="category">{{ shoppingCenter.Category }}</td>
            <td *ngIf="shoppingCenter.sizeRange as sr">
              <div>
                <ng-container *ngIf="sr; instanceof: Array; else: single">
                  {{ sr[0] | number }} - {{ sr[1] | number }} SF
                </ng-container>
                <ng-template #single> {{ sr | number }} SF </ng-template>
              </div>
            </td>
            <!-- <td *ngIf="shoppingCenter.stageName">
              <div #dropdownRef class="custom-dropdown">
                <div
                  class="selected-option"
                  (click)="toggleDropdown(shoppingCenter, $event)"
                >
                  {{ getSelectedStageName(shoppingCenter.kanbanStageId) }}
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="16"
                    height="16"
                    viewBox="0 0 16 16"
                    fill="none"
                  >
                    <path
                      d="M8.00001 11.2C7.53335 11.2 7.06668 11.0201 6.71335 10.6667L2.36668 6.32005C2.17335 6.12672 2.17335 5.80672 2.36668 5.61338C2.56001 5.42005 2.88001 5.42005 3.07335 5.61338L7.42001 9.96005C7.74001 10.2801 8.26001 10.2801 8.58001 9.96005L12.9267 5.61338C13.12 5.42005 13.44 5.42005 13.6333 5.61338C13.8267 5.80672 13.8267 6.12672 13.6333 6.32005L9.28668 10.6667C8.93335 11.0201 8.46668 11.2 8.00001 11.2Z"
                      fill="#161017"
                    />
                  </svg>
                </div>
                <div
                  class="dropdown-options"
                  [class.show]="shoppingCenter.isDropdownOpen"
                >
                  <div
                    *ngFor="let stage of KanbanStages"
                    class="dropdown-item"
                    [class.active]="stage.id === shoppingCenter.kanbanStageId"
                    (click)="
                      selectStage(
                        shoppingCenter.MarketSurveyId,
                        stage.id,
                        shoppingCenter,
                        $event
                      )
                    "
                  >
                    {{ stage.stageName }}
                  </div>
                </div>
              </div>
              <p class="table-text ShoppingCenterStage mb-1">
                {{ shoppingCenter.stageName }}
              </p>
            </td> -->
            <!-- *ngIf="placesRepresentative" -->
            <!-- <td>
              <ng-container
                *ngIf="shoppingCenter.ShoppingCenter?.ManagerOrganization"
              >
                <div>
                  <div
                    class="d-flex align-items-center justify-content-between table-div"
                  >
                    <img loading="lazy" 
                      class="logo"
                      src="https://api.cherrypick.com/api/Organization/GetOrgImag?orgId={{
                        shoppingCenter.ShoppingCenter.ManagerOrganization[0].ID
                      }}"
                      [title]="
                        shoppingCenter.ShoppingCenter.ManagerOrganization[0]
                          .Name
                      "
                      alt=""
                    />
                    <div class="table-text">
                      {{
                        shoppingCenter.ShoppingCenter.ManagerOrganization[0]
                          .Name
                      }}
                    </div>

                    trigger
                    <div
                      class="org-info-trigger"
                      (click)="toggleOrgMenu($event, shoppingCenter.Id)"
                    >
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        fill="none"
                      >
                        <path
                          d="M11.9999 16.3299C9.60992 16.3299 7.66992 14.3899 7.66992 11.9999C7.66992 9.60992 9.60992 7.66992 11.9999 7.66992C14.3899 7.66992 16.3299 9.60992 16.3299 11.9999C16.3299 14.3899 14.3899 16.3299 11.9999 16.3299ZM11.9999 9.16992C10.4399 9.16992 9.16992 10.4399 9.16992 11.9999C9.16992 13.5599 10.4399 14.8299 11.9999 14.8299C13.5599 14.8299 14.8299 13.5599 14.8299 11.9999C14.8299 10.4399 13.5599 9.16992 11.9999 9.16992Z"
                          fill="#292D32"
                        />
                        <path
                          d="M12.0001 21.02C8.24008 21.02 4.69008 18.82 2.25008 15C1.19008 13.35 1.19008 10.66 2.25008 8.99998C4.70008 5.17998 8.25008 2.97998 12.0001 2.97998C15.7501 2.97998 19.3001 5.17998 21.7401 8.99998C22.8001 10.65 22.8001 13.34 21.7401 15C19.3001 18.82 15.7501 21.02 12.0001 21.02ZM12.0001 4.47998C8.77008 4.47998 5.68008 6.41998 3.52008 9.80998C2.77008 10.98 2.77008 13.02 3.52008 14.19C5.68008 17.58 8.77008 19.52 12.0001 19.52C15.2301 19.52 18.3201 17.58 20.4801 14.19C21.2301 13.02 21.2301 10.98 20.4801 9.80998C18.3201 6.41998 15.2301 4.47998 12.0001 4.47998Z"
                          fill="#292D32"
                        />
                      </svg>
                    </div>
                  </div>

                  <div
                    class="org-mini-menu"
                    *ngIf="openOrgMenuId === shoppingCenter.Id"
                    [ngStyle]="orgMenuPos"
                    (click)="$event.stopPropagation()"
                  >
                    <div
                      *ngFor="
                        let org of shoppingCenter.ShoppingCenter
                          .ManagerOrganization;
                        let i = index
                      "
                      class="org-mini-item"
                    >
                      <p class="name">
                        {{ org.Firstname | titlecase }}
                        {{ org.LastName | titlecase }}
                      </p>
                      <p class="small">{{ org.CellPhone }}</p>
                      <p class="small">{{ org.Email }}</p>
                      <div
                        class="divider"
                        *ngIf="
                          i <
                          shoppingCenter.ShoppingCenter.ManagerOrganization
                            .length -
                            1
                        "
                      ></div>
                    </div>
                  </div>
                </div>
              </ng-container>
            </td> -->
            <td
              class="table-text"
              *ngIf="shoppingCenter.ShoppingCenter?.Places?.length"
            >
              <!-- <P class="mb-0" [innerHTML]="getShoppingCenterUnitSize(shoppingCenter)"></P> -->
              <div
                *ngIf="shoppingCenter.ShoppingCenter?.Places?.length"
                class="table-responsive mt-2"
                style="max-height: 150px; overflow-y: auto"
              >
                </div>

              <!-- <div
                *ngIf="shoppingCenter.ShoppingCenter?.Places?.length"
                class="table-responsive mt-2"
                style="max-height: 150px; overflow-y: auto"
              >
                <p class="mb-0 pt-1"><b>Notes</b></p>
                <table
                  class="table table-sm table-striped mb-0 small-table"
                  style="font-size: 0.75rem"
                >
                  <tbody>
                    <tr
                      *ngFor="let place of shoppingCenter.ShoppingCenter.Places; trackBy: trackByPlaceId"
                    >
                      <td>{{ place.Notes || "—" }}</td>
                    </tr>
                  </tbody>
                </table>
              </div> -->
            </td>

            <!-- <td *ngIf="shoppingCenters[0].ShoppingCenter">
              <ng-container
                *ngIf="
                  shoppingCenter?.ShoppingCenter?.BuyBoxPlaces;
                  else emptyTd
                "
              >
                <ng-container
                  *ngFor="
                    let item of shoppingCenter?.ShoppingCenter?.BuyBoxPlaces;
                    let i = index;
                    trackBy: trackByIndex
                  "
                >
                  <div class="d-flex align-items-center justify-content-center">
                    <img loading="lazy" 
                      class="logo"
                      src="https://api.cherrypick.com/api/Organization/GetOrgImag?orgId={{
                        item.RelationOrganizationId
                      }}"
                      [title]="item.RelationOrganizationName"
                      alt=""
                    />
                    <span>{{ item.RelationOrganizationName }}</span>
                    <div
                      class="d-flex align-items-center justify-content-center"
                    >
                      <span class="ms-2 table-text"> </span>
                    </div>
                  </div>
                </ng-container>
              </ng-container>
            </td> -->
            <ng-template #emptyTd> </ng-template>
          </tr>
        </ng-container>
      </tbody>
    </table>
  </div>
</div>

<!-- No data message -->
<div
  class="pt-2 d-flex justify-content-center align-items-center heightt"
  *ngIf="!isLoading && shoppingCenters?.length == 0"
>
  <p class="fontweight">No data Shopping Center</p>
</div>

<!-- Skeleton loading for no data message -->
<div
  class="pt-2 d-flex justify-content-center align-items-center heightt"
  *ngIf="isLoading"
>
  <div class="skeleton-no-data"></div>
</div>

<ng-template #StreetViewPlace let-modal>
  <div *ngIf="General.modalObject.StreetViewURL">
    <iframe
      [src]="sanitizedUrl"
      height="700"
      width="798"
      class="sanitizedUrl"
      allowfullscreen=""
    >
    </iframe>
  </div>
  <div
    id="street-view"
    class="h700"
    *ngIf="!General.modalObject.StreetViewURL"
  ></div>
</ng-template>

<ng-template #deleteSingleShoppingCenterModal let-modal>
  <div class="modal-body-general p-4 rounded deleteShopping">
    <h2 class="text-center mb-4 RemoveShopping">Remove Shopping Center</h2>
    <p class="text-center Areyou">
      Are you sure you want to remove this Shopping Center?
    </p>

    <div class="d-flex justify-content-end mt-4">
      <button
        type="button"
        class="btn btn-secondary me-2 px-4 py-2 btnborder"
        (click)="modal.dismiss('Cancel click')"
      >
        Cancel
      </button>
     
    </div>
  </div>
</ng-template>

<ng-template #MapViewPlace let-modal>
  <div id="mappopup" class="h700" *ngIf="mapViewOnePlacex"></div>
</ng-template>

<ng-template #statusModal let-modal>
  <div class="modal-header">
    <h5 class="modal-title">Center Status</h5>
    <button
      type="button"
      class="btn-close"
      aria-label="Close"
      (click)="modal.dismiss()"
    ></button>
  </div>
  <div class="modal-body">
    <!-- Render the skeleton loader or fetched content -->
    <div *ngIf="isLoadingstatus; else contentTemplate">
      <div class="skeleton-loader">
        <div
          class="skeleton-head"
          style="
            height: 24px;
            width: 40%;
            margin-bottom: var(--Space-S-16);
            border-radius: 4px;
            background-color: #e0e0e0;
          "
        ></div>
        <div class="skeleton-paragraph">
          <div
            class="skeleton-line"
            style="
              height: 16px;
              width: 100%;
              margin-bottom: 8px;
              border-radius: 4px;
              background-color: #e0e0e0;
            "
          ></div>
          <div
            class="skeleton-line"
            style="
              height: 16px;
              width: 95%;
              margin-bottom: 8px;
              border-radius: 4px;
              background-color: #e0e0e0;
            "
          ></div>
          <div
            class="skeleton-line"
            style="
              height: 16px;
              width: 90%;
              border-radius: 4px;
              background-color: #e0e0e0;
            "
          ></div>
        </div>
      </div>
    </div>
    <ng-template #contentTemplate>
      <div [innerHTML]="htmlContent"></div>
    </ng-template>
  </div>
</ng-template>

<ng-template #submission let-modal>
  <div class="modal-header d-flex justify-content-between">
    <h4 class="modal-title">Submissions</h4>
    <button
      type="button"
      class="close"
      style="background: none; border: none"
      aria-label="Close"
      (click)="modal.dismiss()"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
      >
        <path
          d="M12 22.75C6.07 22.75 1.25 17.93 1.25 12C1.25 6.07 6.07 1.25 12 1.25C17.93 1.25 22.75 6.07 22.75 12C22.75 17.93 17.93 22.75 12 22.75ZM12 2.75C6.9 2.75 2.75 6.9 2.75 12C2.75 17.1 6.9 21.25 12 21.25C17.1 21.25 21.25 17.1 21.25 12C21.25 6.9 17.1 2.75 12 2.75Z"
          fill="#7A8591"
        />
        <path
          d="M9.16986 15.5799C8.97986 15.5799 8.78986 15.5099 8.63986 15.3599C8.34986 15.0699 8.34986 14.5899 8.63986 14.2999L14.2999 8.63986C14.5899 8.34986 15.0699 8.34986 15.3599 8.63986C15.6499 8.92986 15.6499 9.40986 15.3599 9.69986L9.69986 15.3599C9.55986 15.5099 9.35986 15.5799 9.16986 15.5799Z"
          fill="#7A8591"
        />
        <path
          d="M14.8299 15.5799C14.6399 15.5799 14.4499 15.5099 14.2999 15.3599L8.63986 9.69986C8.34986 9.40986 8.34986 8.92986 8.63986 8.63986C8.92986 8.34986 9.40986 8.34986 9.69986 8.63986L15.3599 14.2999C15.6499 14.5899 15.6499 15.0699 15.3599 15.3599C15.2099 15.5099 15.0199 15.5799 14.8299 15.5799Z"
          fill="#7A8591"
        />
      </svg>
    </button>
  </div>
  <div class="modal-body">
    <div *ngFor="let submission of submissions; trackBy: trackBySubmissionId">
      <div class="submission-details" *ngIf="submission?.SubmmisionLink">
        <div class="detailsInfo d-flex flex-column">
          <a
            [href]="
              'https://files.cherrypick.com/submissions/' +
              submission?.SubmmisionLink
            "
            target="_blank"
            class="submission-link"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="8"
              height="8"
              viewBox="0 0 8 8"
              fill="none"
            >
              <circle cx="4" cy="4" r="4" fill="#16181D" />
            </svg>

            https://files.cherrypick.com/submissions/' +
            submission?.SubmmisionLink
          </a>

          <div class="user-info d-flex flex-row">
            <p *ngIf="submission?.FirstName">
              {{ submission?.FirstName + " " + submission?.LastName }}
            </p>
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="8"
              height="8"
              viewBox="0 0 8 8"
              fill="none"
            >
              <circle cx="4" cy="4" r="4" fill="#E2E4E9" />
            </svg>
            <p *ngIf="submission?.CreatedDate">
              {{ submission?.CreatedDate | date : "MMM dd, yyyy" }}
            </p>
          </div>
          <p class="available-space" *ngIf="submission?.AvailableSpace">
            Available Space:{{ submission?.AvailableSpace }} SF
          </p>
        </div>
        <div class="progress-bar-container">
          <div class="match-percentage">
            <div class="circle-progress">
              <svg viewBox="0 0 36 36" class="circle-svg">
                <!-- Background path (gray) -->
                <path
                  class="circle-bg"
                  d="M18 2.0845
                    a 15.9155 15.9155 0 0 1 0 31.831
                    a 15.9155 15.9155 0 0 1 0 -31.831"
                  [style.stroke-dasharray]="
                    getCircleProgressBackground(submission?.Percentage)
                  "
                />

                <!-- Foreground path (green) -->
                <path
                  class="circle-fg"
                  d="M18 2.0845
                    a 15.9155 15.9155 0 0 1 0 31.831
                    a 15.9155 15.9155 0 0 1 0 -31.831"
                  [style.stroke-dasharray]="
                    getCircleProgress(submission?.Percentage)
                  "
                />
              </svg>
              <div class="circle-label">
                <span class="match">Match</span>
                <span class="match-percentage"
                  >{{ submission?.Percentage }}%</span
                >
              </div>
            </div>
          </div>
        </div>
      </div>
      <br />
    </div>
  </div>
</ng-template>
<!-- Modal Template -->
<ng-template #infoModal let-modal>
  <div class="modal-header">
    <h5 class="modal-title">Score Info</h5>
    <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss()"></button>
  </div>

  <div class="modal-body">
    <div *ngIf="isLoadingInfo">Loading...</div>

    <div *ngIf="!isLoadingInfo">
      <div *ngIf="infoData; else noData" 
           class="rationale-text" 
           [innerHTML]="infoData">
      </div>

      <ng-template #noData>
        <p>No rationale found.</p>
      </ng-template>
    </div>
  </div>
</ng-template>

