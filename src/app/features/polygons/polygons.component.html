<div class="h-100 d-flex flex-column container-fluid">
  <div class="row">
    <div class="col-3">
      <div class="unified-search-container">
        <input
          id="unifiedSearch"
          class="form-control"
          type="text"
          [(ngModel)]="searchTerm"
          placeholder="State, City, or Neighborhood"
          (input)="onSearchInput($event)"
          (focus)="
            showSuggestions = searchResults.length > 0 || isLoadingSuggestions
          "
          autocomplete="off"
          aria-label="Location search input"
        />

        <!-- Custom Dropdown Container -->
        <div
          class="dropdown-container mt-1"
          *ngIf="showSuggestions"
          style="height: 300px; overflow-y: scroll"
        >
          <div class="p-2 text-center" *ngIf="isLoadingSuggestions">
            Loadingâ€¦
          </div>

          <div *ngIf="stateCityResults.length">
            <div class="px-2 py-1 fw-bold">
              State, City
            </div>
            <ul class="custom-dropdown-list">
              <li
                *ngFor="let item of stateCityResults"
                class="custom-dropdown-item d-flex align-items-center"
              >
                <div class="dropdown-item-box">
                  <input
                    #chk
                    type="checkbox"
                    [checked]="isSelected(item)"
                    (change)="toggleSelection(item)"
                    (click)="$event.stopPropagation()"
                    [id]="getItemId(item)"
                    class="custom-checkbox"
                  />
                  <label
                    class="mb-0 ms-2 flex-grow-1 custom-label"
                    [for]="getItemId(item)"
                    (click)="$event.preventDefault(); toggleSelection(item)"
                  >
                    {{ getItemLabel(item) }}
                  </label>
                </div>
              </li>
            </ul>
          </div>

          <div *ngIf="neighborhoodResults.length" class="mt-2">
            <div class="px-2 py-1 fw-bold">
              Neighborhood
            </div>
            <ul class="custom-dropdown-list">
              <li
                *ngFor="let item of neighborhoodResults"
                class="custom-dropdown-item d-flex align-items-center"
              >
                <div class="dropdown-item-box">
                  <input
                    #chk2
                    type="checkbox"
                    [checked]="isSelected(item)"
                    (change)="toggleSelection(item)"
                    (click)="$event.stopPropagation()"
                    [id]="getItemId(item)"
                    class="custom-checkbox"
                  />
                  <label
                    class="mb-0 ms-2 flex-grow-1 custom-label"
                    [for]="getItemId(item)"
                    (click)="$event.preventDefault(); toggleSelection(item)"
                  >
                    {{ getItemLabel(item) }}
                  </label>
                </div>
              </li>
            </ul>
          </div>

          <div
            class="p-2 small text-muted"
            *ngIf="!isLoadingSuggestions && !searchResults.length"
          >
            No results
          </div>
        </div>
<div class="selected-container">

  <div
    class="selected-item gap-2 d-flex align-items-center mt-2"
    *ngFor="let selectedItem of selectedItems"
  >
    <span class="me-2 flex-grow-1">{{ getItemLabel(selectedItem) }}</span>

    <button
      class="view-btn"
      type="button"
      (click)="viewSelectedItem(selectedItem)"
      [attr.aria-label]="
        'View ' + getItemLabel(selectedItem) + ' on the map'
      "
      *ngIf="selectedItem.id"
    >
      View
    </button>

    <button
      class="x-bt btn btn-sm btn-outline-secondary border-0 rounded-circle"
      type="button"
      (click)="removeSelectedItem(selectedItem)"
      [attr.aria-label]="'Remove ' + getItemLabel(selectedItem)"
    >
      <span style="font-size: 1.2em; line-height: 1"> x </span>
    </button>
  </div>
</div>

        <!-- <div
          class="d-flex align-items-center justify-content-center mt-2"
          *ngIf="selectedItems.length"
        >
          <button
            class="save-btn"
            type="button"
            (click)="onSaveLocationCriteria()"
            aria-label="Save all selected location criteria"
          >
            Done
          </button>
        </div> -->
      </div>
    </div>

    <!-- Map Container -->
    <div class="col-9">
      <div class="pb-3 flex-grow-1 d-flex">
        <div class="map-wrapper flex-grow-1 position-relative">
          <div #mapContainer class="map-container w-100 h-100"></div>
        </div>
      </div>
    </div>
  </div>
</div>
