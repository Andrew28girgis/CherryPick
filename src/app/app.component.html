<div
  class="app-shell"
  [ngClass]="{
    'with-sidebar': isAuthenticated && !hideSidebar && !isChatbotRoute,
    'with-copilot': isCopilotOpen,
    'copilot-expanded': isCopilotFullyOpen,
    'emily-chatbot': isChatbotRoute,
    'chatbot-route': isChatbotRoute,
    authenticated: isAuthenticated,
    'overlay-active': overlayActive
  }"
>

  <app-sidebar
    *ngIf="isAuthenticated && !hideSidebar && !isChatbotRoute"
  ></app-sidebar>

  <div class="app-container">
    <ng-container *ngIf="!isChatbotRoute; else fullWidthContent">
      <div class="main-content-area">
        <div class="content-container" [ngClass]="{ authenticated: isAuthenticated }">
          <router-outlet></router-outlet>
        </div>
      </div>
    </ng-container>

    <ng-template #fullWidthContent>
      <div class="container-fluid full-width-content">
        <router-outlet></router-outlet>
      </div>
    </ng-template>
  </div>

  <app-notifications
    *ngIf="isAuthenticated && !hideSidebar && !isChatbotRoute"
    [isChatbotRoute]="isChatbotRoute"
    (overlayStateChange)="overlayActive = $event"
    (sidebarStateChange)="onCopilotStateChange($event)"
  >
  </app-notifications>
</div>
